2024-09-03 08:12:11,363 - INFO - Starting data transformation!!


2024-09-03 08:12:11,364 - ERROR - Error during data transformation: An error occurred while calling the read_csv method registered to the pandas backend.
Original Message: An error occurred while calling the read_csv method registered to the pandas backend.
Original Message: [WinError 3] The system cannot find the path specified: 'C:/Users/oluwa/OneDrive/Documents/Data Engineering Training - 10Alytics/Project - Capstone/NYCPayroll_ETL/Dataset/Raw_payroll_Data/nycpayroll_2020.csv'


2024-09-03 08:18:37,719 - INFO - Starting data transformation!!


2024-09-03 08:18:37,722 - ERROR - Error during data transformation: An error occurred while calling the read_csv method registered to the pandas backend.
Original Message: An error occurred while calling the read_csv method registered to the pandas backend.
Original Message: [WinError 2] The system cannot find the file specified: 'C:/Users/oluwa/OneDrive/Documents/Data Engineering Training - 10Alytics/Project - Capstone/NYCPayroll_ETL/Dataset/Raw_payroll_Data/nycpayroll_2020.csv'


2024-09-03 08:30:39,306 - INFO - Starting data transformation!!


2024-09-03 08:30:39,309 - ERROR - Error during data transformation: An error occurred while calling the read_csv method registered to the pandas backend.
Original Message: An error occurred while calling the read_csv method registered to the pandas backend.
Original Message: [WinError 2] The system cannot find the file specified: 'C:/Users/oluwa/OneDrive/Documents/Data Engineering Training - 10Alytics/Project - Capstone/NYCPayroll_ETL/Dataset/Raw_payroll_Data/nycpayroll_2020.csv'


2024-09-03 08:35:11,043 - INFO - Starting data transformation!!


2024-09-03 08:35:11,044 - ERROR - Error during data transformation: An error occurred while calling the read_csv method registered to the pandas backend.
Original Message: An error occurred while calling the read_csv method registered to the pandas backend.
Original Message: [WinError 2] The system cannot find the file specified: 'C:/Users/oluwa/OneDrive/Documents/Data Engineering Training - 10Alytics/Project - Capstone/NYCPayroll_ETL/Dataset/Raw_payroll_Data/nycpayroll_2020.csv'


2024-09-03 08:59:14,833 - INFO - Starting data transformation!!


2024-09-03 08:59:14,835 - ERROR - Error during data transformation: An error occurred while calling the read_csv method registered to the pandas backend.
Original Message: An error occurred while calling the read_csv method registered to the pandas backend.
Original Message: [WinError 2] The system cannot find the file specified: 'C:/Users/oluwa/OneDrive/Documents/Data Engineering Training - 10Alytics/Project - Capstone/NYCPayroll_ETL/Dataset/Raw_payroll_Data/nycpayroll_2020.csv'


2024-09-03 09:13:47,689 - INFO - Starting extract_files_from_adls function


2024-09-03 09:13:47,694 - INFO - Request URL: 'https://nycpayrollstorageaccount.blob.core.windows.net/nycpayrollcontainer?restype=REDACTED&comp=REDACTED&prefix=REDACTED'
Request method: 'GET'
Request headers:
    'x-ms-version': 'REDACTED'
    'Accept': 'application/xml'
    'User-Agent': 'azsdk-python-storage-blob/12.22.0 Python/3.12.4 (Windows-11-10.0.22631-SP0)'
    'x-ms-date': 'REDACTED'
    'x-ms-client-request-id': '71e634d1-69cc-11ef-9596-f4a4751e46e5'
    'Authorization': 'REDACTED'
No body was attached to the request


2024-09-03 09:13:49,319 - INFO - Response status: 200
Response headers:
    'Transfer-Encoding': 'chunked'
    'Content-Type': 'application/xml'
    'Server': 'Windows-Azure-Blob/1.0 Microsoft-HTTPAPI/2.0'
    'x-ms-request-id': '374d2db6-901e-0039-19d9-fd3383000000'
    'x-ms-client-request-id': '71e634d1-69cc-11ef-9596-f4a4751e46e5'
    'x-ms-version': 'REDACTED'
    'Date': 'Tue, 03 Sep 2024 08:13:53 GMT'


2024-09-03 09:13:49,327 - INFO - Downloading payroll-sourcedata/nycpayroll_2020.csv from ADLS to Dataset/Raw_payroll_Data\nycpayroll_2020.csv.


2024-09-03 09:13:49,337 - INFO - Request URL: 'https://nycpayrollstorageaccount.blob.core.windows.net/nycpayrollcontainer/payroll-sourcedata/nycpayroll_2020.csv'
Request method: 'GET'
Request headers:
    'x-ms-range': 'REDACTED'
    'x-ms-version': 'REDACTED'
    'Accept': 'application/xml'
    'User-Agent': 'azsdk-python-storage-blob/12.22.0 Python/3.12.4 (Windows-11-10.0.22631-SP0)'
    'x-ms-date': 'REDACTED'
    'x-ms-client-request-id': '72e0db66-69cc-11ef-9a84-f4a4751e46e5'
    'Authorization': 'REDACTED'
No body was attached to the request


2024-09-03 09:13:49,627 - INFO - Response status: 206
Response headers:
    'Content-Length': '17478'
    'Content-Type': 'text/csv'
    'Content-Range': 'REDACTED'
    'Last-Modified': 'Tue, 03 Sep 2024 07:58:09 GMT'
    'Accept-Ranges': 'REDACTED'
    'ETag': '"0x8DCCBEE2731B108"'
    'Server': 'Windows-Azure-Blob/1.0 Microsoft-HTTPAPI/2.0'
    'x-ms-request-id': '374d2f9c-901e-0039-50d9-fd3383000000'
    'x-ms-client-request-id': '72e0db66-69cc-11ef-9a84-f4a4751e46e5'
    'x-ms-version': 'REDACTED'
    'x-ms-resource-type': 'REDACTED'
    'x-ms-creation-time': 'REDACTED'
    'x-ms-blob-content-md5': 'REDACTED'
    'x-ms-lease-status': 'REDACTED'
    'x-ms-lease-state': 'REDACTED'
    'x-ms-blob-type': 'REDACTED'
    'x-ms-server-encrypted': 'REDACTED'
    'x-ms-owner': 'REDACTED'
    'x-ms-group': 'REDACTED'
    'x-ms-permissions': 'REDACTED'
    'x-ms-acl': 'REDACTED'
    'Date': 'Tue, 03 Sep 2024 08:13:53 GMT'


2024-09-03 09:13:49,645 - INFO - Downloaded payroll-sourcedata/nycpayroll_2020.csv successfully.


2024-09-03 09:13:49,647 - INFO - Moving payroll-sourcedata/nycpayroll_2020.csv to payroll-extracteddata.


2024-09-03 09:13:49,656 - INFO - Request URL: 'https://nycpayrollstorageaccount.blob.core.windows.net/nycpayrollcontainer/payroll-extracteddata/nycpayroll_2020.csv'
Request method: 'PUT'
Request headers:
    'x-ms-copy-source': 'REDACTED'
    'x-ms-version': 'REDACTED'
    'Accept': 'application/xml'
    'User-Agent': 'azsdk-python-storage-blob/12.22.0 Python/3.12.4 (Windows-11-10.0.22631-SP0)'
    'x-ms-date': 'REDACTED'
    'x-ms-client-request-id': '7311b14c-69cc-11ef-8283-f4a4751e46e5'
    'Authorization': 'REDACTED'
No body was attached to the request


2024-09-03 09:13:50,030 - INFO - Response status: 202
Response headers:
    'Content-Length': '0'
    'Last-Modified': 'Tue, 03 Sep 2024 08:13:54 GMT'
    'ETag': '"0x8DCCBF05A092A8C"'
    'Server': 'Windows-Azure-Blob/1.0 Microsoft-HTTPAPI/2.0'
    'x-ms-request-id': '374d318f-901e-0039-08d9-fd3383000000'
    'x-ms-client-request-id': '7311b14c-69cc-11ef-8283-f4a4751e46e5'
    'x-ms-version': 'REDACTED'
    'x-ms-copy-id': 'REDACTED'
    'x-ms-copy-status': 'REDACTED'
    'Date': 'Tue, 03 Sep 2024 08:13:53 GMT'


2024-09-03 09:13:50,042 - INFO - Request URL: 'https://nycpayrollstorageaccount.blob.core.windows.net/nycpayrollcontainer/payroll-sourcedata/nycpayroll_2020.csv'
Request method: 'DELETE'
Request headers:
    'x-ms-version': 'REDACTED'
    'Accept': 'application/xml'
    'User-Agent': 'azsdk-python-storage-blob/12.22.0 Python/3.12.4 (Windows-11-10.0.22631-SP0)'
    'x-ms-date': 'REDACTED'
    'x-ms-client-request-id': '734c74d4-69cc-11ef-99bb-f4a4751e46e5'
    'Authorization': 'REDACTED'
No body was attached to the request


2024-09-03 09:13:50,405 - INFO - Response status: 202
Response headers:
    'Content-Length': '0'
    'Server': 'Windows-Azure-Blob/1.0 Microsoft-HTTPAPI/2.0'
    'x-ms-request-id': '374d346b-901e-0039-16d9-fd3383000000'
    'x-ms-client-request-id': '734c74d4-69cc-11ef-99bb-f4a4751e46e5'
    'x-ms-version': 'REDACTED'
    'x-ms-delete-type-permanent': 'REDACTED'
    'x-ms-deletion-id': 'REDACTED'
    'Date': 'Tue, 03 Sep 2024 08:13:54 GMT'


2024-09-03 09:13:50,412 - INFO - Moved payroll-sourcedata/nycpayroll_2020.csv to payroll-extracteddata.


2024-09-03 09:13:50,421 - INFO - Starting data transformation!!


2024-09-03 09:13:52,279 - INFO - dim_date data generated and saved!!


2024-09-03 09:13:52,348 - INFO - Transformed data saved to Dataset/Cleaned_payroll_Data/nycpayroll_2020.csv


2024-09-03 09:13:52,371 - INFO - Starting ETL pipeline.


2024-09-03 09:13:52,376 - INFO - ETL Pipeline started.


2024-09-03 09:13:52,376 - INFO - ETL Step 1: Extracting data from ADLS.


2024-09-03 09:13:52,377 - INFO - Starting extract_files_from_adls function


2024-09-03 09:13:52,379 - INFO - Request URL: 'https://nycpayrollstorageaccount.blob.core.windows.net/nycpayrollcontainer?restype=REDACTED&comp=REDACTED&prefix=REDACTED'
Request method: 'GET'
Request headers:
    'x-ms-version': 'REDACTED'
    'Accept': 'application/xml'
    'User-Agent': 'azsdk-python-storage-blob/12.22.0 Python/3.12.4 (Windows-11-10.0.22631-SP0)'
    'x-ms-date': 'REDACTED'
    'x-ms-client-request-id': '74b139a2-69cc-11ef-9d95-f4a4751e46e5'
    'Authorization': 'REDACTED'
No body was attached to the request


2024-09-03 09:13:52,697 - INFO - Response status: 200
Response headers:
    'Transfer-Encoding': 'chunked'
    'Content-Type': 'application/xml'
    'Server': 'Windows-Azure-Blob/1.0 Microsoft-HTTPAPI/2.0'
    'x-ms-request-id': '374d42b6-901e-0039-72d9-fd3383000000'
    'x-ms-client-request-id': '74b139a2-69cc-11ef-9d95-f4a4751e46e5'
    'x-ms-version': 'REDACTED'
    'Date': 'Tue, 03 Sep 2024 08:13:56 GMT'


2024-09-03 09:13:52,704 - INFO - Data extraction and movement completed.


2024-09-03 09:13:52,706 - INFO - ETL Step 1: Data extraction completed.


2024-09-03 09:13:52,708 - INFO - ETL Step 2: Transforming data.


2024-09-03 09:13:52,711 - INFO - Starting data transformation!!


2024-09-03 09:13:53,678 - INFO - dim_date data generated and saved!!


2024-09-03 09:13:53,795 - INFO - Transformed data saved to Dataset/Cleaned_payroll_Data/nycpayroll_2020.csv


2024-09-03 09:13:53,796 - INFO - ETL Step 2: Data transformation completed.


2024-09-03 09:13:53,798 - INFO - ETL Step 3: Loading data into Snowflake.


2024-09-03 09:13:56,927 - INFO - To route to workers diagnostics web server please install jupyter-server-proxy: python -m pip install jupyter-server-proxy


2024-09-03 09:13:57,004 - INFO - State start


2024-09-03 09:13:57,011 - INFO - Found stale lock file and directory 'C:\\Users\\oluwa\\AppData\\Local\\Temp\\dask-scratch-space\\scheduler-g0qbm6uz', purging


2024-09-03 09:13:57,016 - INFO - Found stale lock file and directory 'C:\\Users\\oluwa\\AppData\\Local\\Temp\\dask-scratch-space\\scheduler-pom2iyce', purging


2024-09-03 09:13:57,069 - INFO -   Scheduler at:     tcp://127.0.0.1:52220


2024-09-03 09:13:57,070 - INFO -   dashboard at:  http://127.0.0.1:8787/status


2024-09-03 09:13:57,071 - INFO - Registering Worker plugin shuffle


2024-09-03 09:13:57,127 - INFO -         Start Nanny at: 'tcp://127.0.0.1:52223'


2024-09-03 09:14:01,602 - INFO - Starting extract_files_from_adls function


2024-09-03 09:14:01,604 - INFO - Request URL: 'https://nycpayrollstorageaccount.blob.core.windows.net/nycpayrollcontainer?restype=REDACTED&comp=REDACTED&prefix=REDACTED'
Request method: 'GET'
Request headers:
    'x-ms-version': 'REDACTED'
    'Accept': 'application/xml'
    'User-Agent': 'azsdk-python-storage-blob/12.22.0 Python/3.12.4 (Windows-11-10.0.22631-SP0)'
    'x-ms-date': 'REDACTED'
    'x-ms-client-request-id': '7a30c6c7-69cc-11ef-b911-f4a4751e46e5'
    'Authorization': 'REDACTED'
No body was attached to the request


2024-09-03 09:14:02,923 - INFO - Response status: 200
Response headers:
    'Transfer-Encoding': 'chunked'
    'Content-Type': 'application/xml'
    'Server': 'Windows-Azure-Blob/1.0 Microsoft-HTTPAPI/2.0'
    'x-ms-request-id': '54461741-301e-000f-21d9-fdbef3000000'
    'x-ms-client-request-id': '7a30c6c7-69cc-11ef-b911-f4a4751e46e5'
    'x-ms-version': 'REDACTED'
    'Date': 'Tue, 03 Sep 2024 08:14:06 GMT'


2024-09-03 09:14:02,934 - INFO - Starting data transformation!!


2024-09-03 09:14:05,068 - INFO - dim_date data generated and saved!!


2024-09-03 09:14:05,140 - INFO - Transformed data saved to Dataset/Cleaned_payroll_Data/nycpayroll_2020.csv


2024-09-03 09:14:05,314 - INFO -       Start worker at:      tcp://127.0.0.1:52230


2024-09-03 09:14:05,316 - INFO -          Listening to:      tcp://127.0.0.1:52230


2024-09-03 09:14:05,317 - INFO -           Worker name:                          0


2024-09-03 09:14:05,318 - INFO -          dashboard at:            127.0.0.1:52231


2024-09-03 09:14:05,320 - INFO - Waiting to connect to:      tcp://127.0.0.1:52220


2024-09-03 09:14:05,321 - INFO - -------------------------------------------------


2024-09-03 09:14:05,322 - INFO -               Threads:                          4


2024-09-03 09:14:05,324 - INFO -                Memory:                  19.84 GiB


2024-09-03 09:14:05,325 - INFO -       Local Directory: C:\Users\oluwa\AppData\Local\Temp\dask-scratch-space\worker-a8tl7fx9


2024-09-03 09:14:05,328 - INFO - -------------------------------------------------


2024-09-03 09:14:05,345 - INFO - Register worker <WorkerState 'tcp://127.0.0.1:52230', name: 0, status: init, memory: 0, processing: 0>


2024-09-03 09:14:05,353 - INFO - Starting worker compute stream, tcp://127.0.0.1:52230


2024-09-03 09:14:05,354 - INFO - Starting Worker plugin shuffle


2024-09-03 09:14:05,354 - INFO - Starting established connection to tcp://127.0.0.1:52232


2024-09-03 09:14:05,358 - INFO -         Registered to:      tcp://127.0.0.1:52220


2024-09-03 09:14:05,359 - INFO - -------------------------------------------------


2024-09-03 09:14:05,362 - INFO - Starting established connection to tcp://127.0.0.1:52220


2024-09-03 09:14:05,408 - INFO - Receive client connection: Client-758a111f-69cc-11ef-99f4-f4a4751e46e5


2024-09-03 09:14:05,409 - INFO - Starting established connection to tcp://127.0.0.1:52233


2024-09-03 09:14:05,411 - INFO - Dask client initialized with 1 worker.


2024-09-03 09:14:05,460 - INFO - Connected to Snowflake successfully.


2024-09-03 09:14:05,472 - INFO - Transformed NycPayroll CSV file loaded successfully.


2024-09-03 09:14:05,473 - INFO - Snowflake Connector for Python Version: 3.12.1, Python Version: 3.12.4, Platform: Windows-11-10.0.22631-SP0


2024-09-03 09:14:05,475 - INFO - Connecting to GLOBAL Snowflake domain


2024-09-03 09:14:05,476 - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.


2024-09-03 09:14:09,705 - INFO - Number of results in first chunk: 1


2024-09-03 09:14:10,207 - INFO - Number of results in first chunk: 1


2024-09-03 09:14:10,659 - INFO - Number of results in first chunk: 1


2024-09-03 09:14:10,661 - ERROR - Error loading data into Snowflake: name 'text' is not defined


2024-09-03 09:14:10,663 - ERROR - ETL pipeline failed: name 'text' is not defined


2024-09-03 09:14:10,680 - INFO - closed


2024-09-03 09:14:10,688 - INFO - No async queries seem to be running, deleting session


2024-09-03 09:14:11,241 - INFO - Retire worker addresses (0,)


2024-09-03 09:14:11,246 - INFO - Closing Nanny at 'tcp://127.0.0.1:52223'. Reason: nanny-close


2024-09-03 09:14:11,249 - INFO - Nanny asking worker to close. Reason: nanny-close


2024-09-03 09:14:11,255 - INFO - Stopping worker at tcp://127.0.0.1:52230. Reason: nanny-close


2024-09-03 09:14:11,259 - INFO - Removing Worker plugin shuffle


2024-09-03 09:14:11,271 - INFO - Connection to tcp://127.0.0.1:52220 has been closed.


2024-09-03 09:14:11,272 - INFO - Received 'close-stream' from tcp://127.0.0.1:52232; closing.


2024-09-03 09:14:11,278 - INFO - Remove worker <WorkerState 'tcp://127.0.0.1:52230', name: 0, status: closing, memory: 0, processing: 0> (stimulus_id='handle-worker-cleanup-1725351251.2778487')


2024-09-03 09:14:11,284 - INFO - Lost all workers


2024-09-03 09:14:11,901 - INFO - Closing scheduler. Reason: unknown


2024-09-03 09:14:11,903 - INFO - Scheduler closing all comms


2024-09-03 09:24:15,740 - INFO - Starting extract_files_from_adls function


2024-09-03 09:24:15,742 - INFO - Request URL: 'https://nycpayrollstorageaccount.blob.core.windows.net/nycpayrollcontainer?restype=REDACTED&comp=REDACTED&prefix=REDACTED'
Request method: 'GET'
Request headers:
    'x-ms-version': 'REDACTED'
    'Accept': 'application/xml'
    'User-Agent': 'azsdk-python-storage-blob/12.22.0 Python/3.12.4 (Windows-11-10.0.22631-SP0)'
    'x-ms-date': 'REDACTED'
    'x-ms-client-request-id': 'e83ec5bc-69cd-11ef-bf2d-f4a4751e46e5'
    'Authorization': 'REDACTED'
No body was attached to the request


2024-09-03 09:24:17,334 - INFO - Response status: 200
Response headers:
    'Transfer-Encoding': 'chunked'
    'Content-Type': 'application/xml'
    'Server': 'Windows-Azure-Blob/1.0 Microsoft-HTTPAPI/2.0'
    'x-ms-request-id': '1cdba87a-401e-0083-1ada-fdd6fd000000'
    'x-ms-client-request-id': 'e83ec5bc-69cd-11ef-bf2d-f4a4751e46e5'
    'x-ms-version': 'REDACTED'
    'Date': 'Tue, 03 Sep 2024 08:24:21 GMT'


2024-09-03 09:24:17,342 - INFO - Starting data transformation!!


2024-09-03 09:24:19,021 - INFO - dim_date data generated and saved!!


2024-09-03 09:24:19,132 - INFO - Transformed data saved to Dataset/Cleaned_payroll_Data/nycpayroll_2020.csv


2024-09-03 09:24:19,148 - INFO - Starting ETL pipeline.


2024-09-03 09:24:19,154 - INFO - ETL Pipeline started.


2024-09-03 09:24:19,155 - INFO - ETL Step 1: Extracting data from ADLS.


2024-09-03 09:24:19,156 - INFO - Starting extract_files_from_adls function


2024-09-03 09:24:19,157 - INFO - Request URL: 'https://nycpayrollstorageaccount.blob.core.windows.net/nycpayrollcontainer?restype=REDACTED&comp=REDACTED&prefix=REDACTED'
Request method: 'GET'
Request headers:
    'x-ms-version': 'REDACTED'
    'Accept': 'application/xml'
    'User-Agent': 'azsdk-python-storage-blob/12.22.0 Python/3.12.4 (Windows-11-10.0.22631-SP0)'
    'x-ms-date': 'REDACTED'
    'x-ms-client-request-id': 'ea480edd-69cd-11ef-bddc-f4a4751e46e5'
    'Authorization': 'REDACTED'
No body was attached to the request


2024-09-03 09:24:19,481 - INFO - Response status: 200
Response headers:
    'Transfer-Encoding': 'chunked'
    'Content-Type': 'application/xml'
    'Server': 'Windows-Azure-Blob/1.0 Microsoft-HTTPAPI/2.0'
    'x-ms-request-id': '1cdbb686-401e-0083-1cda-fdd6fd000000'
    'x-ms-client-request-id': 'ea480edd-69cd-11ef-bddc-f4a4751e46e5'
    'x-ms-version': 'REDACTED'
    'Date': 'Tue, 03 Sep 2024 08:24:23 GMT'


2024-09-03 09:24:19,486 - INFO - Data extraction and movement completed.


2024-09-03 09:24:19,489 - INFO - ETL Step 1: Data extraction completed.


2024-09-03 09:24:19,491 - INFO - ETL Step 2: Transforming data.


2024-09-03 09:24:19,493 - INFO - Starting data transformation!!


2024-09-03 09:24:20,666 - INFO - dim_date data generated and saved!!


2024-09-03 09:24:20,760 - INFO - Transformed data saved to Dataset/Cleaned_payroll_Data/nycpayroll_2020.csv


2024-09-03 09:24:20,761 - INFO - ETL Step 2: Data transformation completed.


2024-09-03 09:24:20,762 - INFO - ETL Step 3: Loading data into Snowflake.


2024-09-03 09:24:21,818 - INFO - To route to workers diagnostics web server please install jupyter-server-proxy: python -m pip install jupyter-server-proxy


2024-09-03 09:24:21,916 - INFO - State start


2024-09-03 09:24:22,009 - INFO -   Scheduler at:     tcp://127.0.0.1:54216


2024-09-03 09:24:22,011 - INFO -   dashboard at:  http://127.0.0.1:8787/status


2024-09-03 09:24:22,013 - INFO - Registering Worker plugin shuffle


2024-09-03 09:24:22,082 - INFO -         Start Nanny at: 'tcp://127.0.0.1:54219'


2024-09-03 09:24:26,453 - INFO - Starting extract_files_from_adls function


2024-09-03 09:24:26,458 - INFO - Request URL: 'https://nycpayrollstorageaccount.blob.core.windows.net/nycpayrollcontainer?restype=REDACTED&comp=REDACTED&prefix=REDACTED'
Request method: 'GET'
Request headers:
    'x-ms-version': 'REDACTED'
    'Accept': 'application/xml'
    'User-Agent': 'azsdk-python-storage-blob/12.22.0 Python/3.12.4 (Windows-11-10.0.22631-SP0)'
    'x-ms-date': 'REDACTED'
    'x-ms-client-request-id': 'eea1cd68-69cd-11ef-95e1-f4a4751e46e5'
    'Authorization': 'REDACTED'
No body was attached to the request


2024-09-03 09:24:28,087 - INFO - Response status: 200
Response headers:
    'Transfer-Encoding': 'chunked'
    'Content-Type': 'application/xml'
    'Server': 'Windows-Azure-Blob/1.0 Microsoft-HTTPAPI/2.0'
    'x-ms-request-id': 'aa77a9c3-a01e-000d-62da-fd004b000000'
    'x-ms-client-request-id': 'eea1cd68-69cd-11ef-95e1-f4a4751e46e5'
    'x-ms-version': 'REDACTED'
    'Date': 'Tue, 03 Sep 2024 08:24:31 GMT'


2024-09-03 09:24:28,096 - INFO - Starting data transformation!!


2024-09-03 09:24:30,049 - INFO - dim_date data generated and saved!!


2024-09-03 09:24:30,178 - INFO - Transformed data saved to Dataset/Cleaned_payroll_Data/nycpayroll_2020.csv


2024-09-03 09:24:30,344 - INFO -       Start worker at:      tcp://127.0.0.1:54226


2024-09-03 09:24:30,345 - INFO -          Listening to:      tcp://127.0.0.1:54226


2024-09-03 09:24:30,346 - INFO -           Worker name:                          0


2024-09-03 09:24:30,348 - INFO -          dashboard at:            127.0.0.1:54227


2024-09-03 09:24:30,350 - INFO - Waiting to connect to:      tcp://127.0.0.1:54216


2024-09-03 09:24:30,350 - INFO - -------------------------------------------------


2024-09-03 09:24:30,352 - INFO -               Threads:                          4


2024-09-03 09:24:30,354 - INFO -                Memory:                  19.84 GiB


2024-09-03 09:24:30,355 - INFO -       Local Directory: C:\Users\oluwa\AppData\Local\Temp\dask-scratch-space\worker-uu6_uku2


2024-09-03 09:24:30,356 - INFO - -------------------------------------------------


2024-09-03 09:24:30,372 - INFO - Register worker <WorkerState 'tcp://127.0.0.1:54226', name: 0, status: init, memory: 0, processing: 0>


2024-09-03 09:24:30,378 - INFO - Starting worker compute stream, tcp://127.0.0.1:54226


2024-09-03 09:24:30,379 - INFO - Starting established connection to tcp://127.0.0.1:54228


2024-09-03 09:24:30,384 - INFO -         Registered to:      tcp://127.0.0.1:54216


2024-09-03 09:24:30,388 - INFO - -------------------------------------------------


2024-09-03 09:24:30,391 - INFO - Starting established connection to tcp://127.0.0.1:54216


2024-09-03 09:24:30,428 - INFO - Receive client connection: Client-eb3d2185-69cd-11ef-8cac-f4a4751e46e5


2024-09-03 09:24:30,430 - INFO - Starting established connection to tcp://127.0.0.1:54229


2024-09-03 09:24:30,435 - INFO - Dask client initialized with 1 worker.


2024-09-03 09:24:30,478 - INFO - Connected to Snowflake successfully.


2024-09-03 09:24:30,487 - INFO - Transformed NycPayroll CSV file loaded successfully.


2024-09-03 09:24:30,489 - INFO - Snowflake Connector for Python Version: 3.12.1, Python Version: 3.12.4, Platform: Windows-11-10.0.22631-SP0


2024-09-03 09:24:30,493 - INFO - Connecting to GLOBAL Snowflake domain


2024-09-03 09:24:30,575 - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.


2024-09-03 09:24:33,614 - INFO - Number of results in first chunk: 1


2024-09-03 09:24:34,026 - INFO - Number of results in first chunk: 1


2024-09-03 09:24:34,637 - INFO - Number of results in first chunk: 1


2024-09-03 09:24:34,774 - ERROR - Error loading data into Snowflake: Not an executable object: 'TRUNCATE TABLE Dim_Employee;'


2024-09-03 09:24:34,776 - ERROR - ETL pipeline failed: Not an executable object: 'TRUNCATE TABLE Dim_Employee;'


2024-09-03 09:24:34,813 - INFO - closed


2024-09-03 09:24:34,817 - INFO - No async queries seem to be running, deleting session


2024-09-03 09:24:35,361 - INFO - Retire worker addresses (0,)


2024-09-03 09:24:35,365 - INFO - Closing Nanny at 'tcp://127.0.0.1:54219'. Reason: nanny-close


2024-09-03 09:24:35,368 - INFO - Nanny asking worker to close. Reason: nanny-close


2024-09-03 09:24:35,375 - INFO - Stopping worker at tcp://127.0.0.1:54226. Reason: nanny-close


2024-09-03 09:24:35,377 - INFO - Removing Worker plugin shuffle


2024-09-03 09:24:35,392 - INFO - Received 'close-stream' from tcp://127.0.0.1:54228; closing.


2024-09-03 09:24:35,393 - INFO - Connection to tcp://127.0.0.1:54216 has been closed.


2024-09-03 09:24:35,395 - INFO - Remove worker <WorkerState 'tcp://127.0.0.1:54226', name: 0, status: closing, memory: 0, processing: 0> (stimulus_id='handle-worker-cleanup-1725351875.3954606')


2024-09-03 09:24:35,400 - INFO - Lost all workers


2024-09-03 09:24:35,958 - INFO - Closing scheduler. Reason: unknown


2024-09-03 09:24:35,985 - INFO - Scheduler closing all comms


2024-09-03 09:33:12,519 - INFO - Starting extract_files_from_adls function


2024-09-03 09:33:12,523 - INFO - Request URL: 'https://nycpayrollstorageaccount.blob.core.windows.net/nycpayrollcontainer?restype=REDACTED&comp=REDACTED&prefix=REDACTED'
Request method: 'GET'
Request headers:
    'x-ms-version': 'REDACTED'
    'Accept': 'application/xml'
    'User-Agent': 'azsdk-python-storage-blob/12.22.0 Python/3.12.4 (Windows-11-10.0.22631-SP0)'
    'x-ms-date': 'REDACTED'
    'x-ms-client-request-id': '283101b3-69cf-11ef-85ce-f4a4751e46e5'
    'Authorization': 'REDACTED'
No body was attached to the request


2024-09-03 09:33:14,109 - INFO - Response status: 200
Response headers:
    'Transfer-Encoding': 'chunked'
    'Content-Type': 'application/xml'
    'Server': 'Windows-Azure-Blob/1.0 Microsoft-HTTPAPI/2.0'
    'x-ms-request-id': 'fcd065e2-001e-003b-23db-fd8d3b000000'
    'x-ms-client-request-id': '283101b3-69cf-11ef-85ce-f4a4751e46e5'
    'x-ms-version': 'REDACTED'
    'Date': 'Tue, 03 Sep 2024 08:33:17 GMT'


2024-09-03 09:33:14,116 - INFO - Starting data transformation!!


2024-09-03 09:33:15,812 - INFO - dim_date data generated and saved!!


2024-09-03 09:33:15,887 - INFO - Transformed data saved to Dataset/Cleaned_payroll_Data/nycpayroll_2020.csv


2024-09-03 09:33:15,898 - INFO - Starting ETL pipeline.


2024-09-03 09:33:15,903 - INFO - ETL Pipeline started.


2024-09-03 09:33:15,904 - INFO - ETL Step 1: Extracting data from ADLS.


2024-09-03 09:33:15,905 - INFO - Starting extract_files_from_adls function


2024-09-03 09:33:15,908 - INFO - Request URL: 'https://nycpayrollstorageaccount.blob.core.windows.net/nycpayrollcontainer?restype=REDACTED&comp=REDACTED&prefix=REDACTED'
Request method: 'GET'
Request headers:
    'x-ms-version': 'REDACTED'
    'Accept': 'application/xml'
    'User-Agent': 'azsdk-python-storage-blob/12.22.0 Python/3.12.4 (Windows-11-10.0.22631-SP0)'
    'x-ms-date': 'REDACTED'
    'x-ms-client-request-id': '2a357d14-69cf-11ef-9ff5-f4a4751e46e5'
    'Authorization': 'REDACTED'
No body was attached to the request


2024-09-03 09:33:16,462 - INFO - Response status: 200
Response headers:
    'Transfer-Encoding': 'chunked'
    'Content-Type': 'application/xml'
    'Server': 'Windows-Azure-Blob/1.0 Microsoft-HTTPAPI/2.0'
    'x-ms-request-id': 'fcd074f0-001e-003b-74db-fd8d3b000000'
    'x-ms-client-request-id': '2a357d14-69cf-11ef-9ff5-f4a4751e46e5'
    'x-ms-version': 'REDACTED'
    'Date': 'Tue, 03 Sep 2024 08:33:19 GMT'


2024-09-03 09:33:16,468 - INFO - Data extraction and movement completed.


2024-09-03 09:33:16,470 - INFO - ETL Step 1: Data extraction completed.


2024-09-03 09:33:16,472 - INFO - ETL Step 2: Transforming data.


2024-09-03 09:33:16,474 - INFO - Starting data transformation!!


2024-09-03 09:33:17,651 - INFO - dim_date data generated and saved!!


2024-09-03 09:33:17,770 - INFO - Transformed data saved to Dataset/Cleaned_payroll_Data/nycpayroll_2020.csv


2024-09-03 09:33:17,771 - INFO - ETL Step 2: Data transformation completed.


2024-09-03 09:33:17,772 - INFO - ETL Step 3: Loading data into Snowflake.


2024-09-03 09:33:18,660 - INFO - To route to workers diagnostics web server please install jupyter-server-proxy: python -m pip install jupyter-server-proxy


2024-09-03 09:33:18,752 - INFO - State start


2024-09-03 09:33:18,854 - INFO -   Scheduler at:     tcp://127.0.0.1:54281


2024-09-03 09:33:18,855 - INFO -   dashboard at:  http://127.0.0.1:8787/status


2024-09-03 09:33:18,857 - INFO - Registering Worker plugin shuffle


2024-09-03 09:33:18,947 - INFO -         Start Nanny at: 'tcp://127.0.0.1:54284'


2024-09-03 09:33:23,848 - INFO - Starting extract_files_from_adls function


2024-09-03 09:33:23,851 - INFO - Request URL: 'https://nycpayrollstorageaccount.blob.core.windows.net/nycpayrollcontainer?restype=REDACTED&comp=REDACTED&prefix=REDACTED'
Request method: 'GET'
Request headers:
    'x-ms-version': 'REDACTED'
    'Accept': 'application/xml'
    'User-Agent': 'azsdk-python-storage-blob/12.22.0 Python/3.12.4 (Windows-11-10.0.22631-SP0)'
    'x-ms-date': 'REDACTED'
    'x-ms-client-request-id': '2ef18ce4-69cf-11ef-829e-f4a4751e46e5'
    'Authorization': 'REDACTED'
No body was attached to the request


2024-09-03 09:33:25,167 - INFO - Response status: 200
Response headers:
    'Transfer-Encoding': 'chunked'
    'Content-Type': 'application/xml'
    'Server': 'Windows-Azure-Blob/1.0 Microsoft-HTTPAPI/2.0'
    'x-ms-request-id': '2bfd5415-701e-0031-1adb-fd298c000000'
    'x-ms-client-request-id': '2ef18ce4-69cf-11ef-829e-f4a4751e46e5'
    'x-ms-version': 'REDACTED'
    'Date': 'Tue, 03 Sep 2024 08:33:29 GMT'


2024-09-03 09:33:25,176 - INFO - Starting data transformation!!


2024-09-03 09:33:26,907 - INFO - dim_date data generated and saved!!


2024-09-03 09:33:27,011 - INFO - Transformed data saved to Dataset/Cleaned_payroll_Data/nycpayroll_2020.csv


2024-09-03 09:33:27,161 - INFO -       Start worker at:      tcp://127.0.0.1:54291


2024-09-03 09:33:27,162 - INFO -          Listening to:      tcp://127.0.0.1:54291


2024-09-03 09:33:27,163 - INFO -           Worker name:                          0


2024-09-03 09:33:27,164 - INFO -          dashboard at:            127.0.0.1:54292


2024-09-03 09:33:27,165 - INFO - Waiting to connect to:      tcp://127.0.0.1:54281


2024-09-03 09:33:27,165 - INFO - -------------------------------------------------


2024-09-03 09:33:27,166 - INFO -               Threads:                          4


2024-09-03 09:33:27,170 - INFO -                Memory:                  19.84 GiB


2024-09-03 09:33:27,171 - INFO -       Local Directory: C:\Users\oluwa\AppData\Local\Temp\dask-scratch-space\worker-6k2ib2df


2024-09-03 09:33:27,210 - INFO - -------------------------------------------------


2024-09-03 09:33:27,233 - INFO - Register worker <WorkerState 'tcp://127.0.0.1:54291', name: 0, status: init, memory: 0, processing: 0>


2024-09-03 09:33:27,242 - INFO - Starting worker compute stream, tcp://127.0.0.1:54291


2024-09-03 09:33:27,243 - INFO - Starting Worker plugin shuffle


2024-09-03 09:33:27,243 - INFO - Starting established connection to tcp://127.0.0.1:54293


2024-09-03 09:33:27,277 - INFO -         Registered to:      tcp://127.0.0.1:54281


2024-09-03 09:33:27,288 - INFO - -------------------------------------------------


2024-09-03 09:33:27,293 - INFO - Starting established connection to tcp://127.0.0.1:54281


2024-09-03 09:33:27,310 - INFO - Receive client connection: Client-2b52547a-69cf-11ef-bf58-f4a4751e46e5


2024-09-03 09:33:27,339 - INFO - Starting established connection to tcp://127.0.0.1:54294


2024-09-03 09:33:27,401 - INFO - Dask client initialized with 1 worker.


2024-09-03 09:33:27,424 - INFO - Connected to Snowflake successfully.


2024-09-03 09:33:27,429 - INFO - Transformed NycPayroll CSV file loaded successfully.


2024-09-03 09:33:27,430 - INFO - Snowflake Connector for Python Version: 3.12.1, Python Version: 3.12.4, Platform: Windows-11-10.0.22631-SP0


2024-09-03 09:33:27,431 - INFO - Connecting to GLOBAL Snowflake domain


2024-09-03 09:33:27,432 - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.


2024-09-03 09:33:31,211 - INFO - Number of results in first chunk: 1


2024-09-03 09:33:32,011 - INFO - Number of results in first chunk: 1


2024-09-03 09:33:33,054 - INFO - Number of results in first chunk: 1


2024-09-03 09:33:33,056 - ERROR - Error loading data into Snowflake: (snowflake.connector.errors.ProgrammingError) 002003 (42S02): 01b6c7a1-0000-6668-0022-af030002002e: SQL compilation error:
Table 'NYCPAYROLL_DWH.STG.DIM_EMPLOYEE' does not exist or not authorized.
[SQL: TRUNCATE TABLE Dim_Employee;]
(Background on this error at: https://sqlalche.me/e/20/f405)


2024-09-03 09:33:33,059 - ERROR - ETL pipeline failed: (snowflake.connector.errors.ProgrammingError) 002003 (42S02): 01b6c7a1-0000-6668-0022-af030002002e: SQL compilation error:
Table 'NYCPAYROLL_DWH.STG.DIM_EMPLOYEE' does not exist or not authorized.
[SQL: TRUNCATE TABLE Dim_Employee;]
(Background on this error at: https://sqlalche.me/e/20/f405)


2024-09-03 09:33:33,228 - INFO - closed


2024-09-03 09:33:33,231 - INFO - No async queries seem to be running, deleting session


2024-09-03 09:33:33,924 - INFO - Retire worker addresses (0,)


2024-09-03 09:33:33,930 - INFO - Closing Nanny at 'tcp://127.0.0.1:54284'. Reason: nanny-close


2024-09-03 09:33:33,933 - INFO - Nanny asking worker to close. Reason: nanny-close


2024-09-03 09:33:33,943 - INFO - Stopping worker at tcp://127.0.0.1:54291. Reason: nanny-close


2024-09-03 09:33:33,947 - INFO - Removing Worker plugin shuffle


2024-09-03 09:33:33,961 - INFO - Connection to tcp://127.0.0.1:54281 has been closed.


2024-09-03 09:33:33,962 - INFO - Received 'close-stream' from tcp://127.0.0.1:54293; closing.


2024-09-03 09:33:33,965 - INFO - Remove worker <WorkerState 'tcp://127.0.0.1:54291', name: 0, status: closing, memory: 0, processing: 0> (stimulus_id='handle-worker-cleanup-1725352413.9658308')


2024-09-03 09:33:33,978 - INFO - Lost all workers


2024-09-03 09:33:34,480 - INFO - Closing scheduler. Reason: unknown


2024-09-03 09:33:34,483 - INFO - Scheduler closing all comms


2024-09-03 11:44:41,477 - INFO - Starting extract_files_from_adls function


2024-09-03 11:44:41,484 - INFO - Request URL: 'https://nycpayrollstorageaccount.blob.core.windows.net/nycpayrollcontainer?restype=REDACTED&comp=REDACTED&prefix=REDACTED'
Request method: 'GET'
Request headers:
    'x-ms-version': 'REDACTED'
    'Accept': 'application/xml'
    'User-Agent': 'azsdk-python-storage-blob/12.22.0 Python/3.12.4 (Windows-11-10.0.22631-SP0)'
    'x-ms-date': 'REDACTED'
    'x-ms-client-request-id': '8660d2cf-69e1-11ef-84f9-f4a4751e46e5'
    'Authorization': 'REDACTED'
No body was attached to the request


2024-09-03 11:44:43,002 - INFO - Response status: 200
Response headers:
    'Transfer-Encoding': 'chunked'
    'Content-Type': 'application/xml'
    'Server': 'Windows-Azure-Blob/1.0 Microsoft-HTTPAPI/2.0'
    'x-ms-request-id': 'c65c5735-401e-0015-42ee-fddf2c000000'
    'x-ms-client-request-id': '8660d2cf-69e1-11ef-84f9-f4a4751e46e5'
    'x-ms-version': 'REDACTED'
    'Date': 'Tue, 03 Sep 2024 10:44:47 GMT'


2024-09-03 11:44:43,044 - INFO - Starting data transformation!!


2024-09-03 11:44:44,823 - INFO - dim_date data generated and saved!!


2024-09-03 11:44:44,942 - INFO - Transformed data saved to Dataset/Cleaned_payroll_Data/nycpayroll_2020.csv


2024-09-03 11:44:44,987 - INFO - Starting ETL pipeline.


2024-09-03 11:44:45,007 - INFO - ETL Pipeline started.


2024-09-03 11:44:45,018 - INFO - ETL Step 1: Extracting data from ADLS.


2024-09-03 11:44:45,025 - INFO - Starting extract_files_from_adls function


2024-09-03 11:44:45,039 - INFO - Request URL: 'https://nycpayrollstorageaccount.blob.core.windows.net/nycpayrollcontainer?restype=REDACTED&comp=REDACTED&prefix=REDACTED'
Request method: 'GET'
Request headers:
    'x-ms-version': 'REDACTED'
    'Accept': 'application/xml'
    'User-Agent': 'azsdk-python-storage-blob/12.22.0 Python/3.12.4 (Windows-11-10.0.22631-SP0)'
    'x-ms-date': 'REDACTED'
    'x-ms-client-request-id': '887eac4b-69e1-11ef-840c-f4a4751e46e5'
    'Authorization': 'REDACTED'
No body was attached to the request


2024-09-03 11:44:45,337 - INFO - Response status: 200
Response headers:
    'Transfer-Encoding': 'chunked'
    'Content-Type': 'application/xml'
    'Server': 'Windows-Azure-Blob/1.0 Microsoft-HTTPAPI/2.0'
    'x-ms-request-id': 'c65c679d-401e-0015-45ee-fddf2c000000'
    'x-ms-client-request-id': '887eac4b-69e1-11ef-840c-f4a4751e46e5'
    'x-ms-version': 'REDACTED'
    'Date': 'Tue, 03 Sep 2024 10:44:49 GMT'


2024-09-03 11:44:45,344 - INFO - Data extraction and movement completed.


2024-09-03 11:44:45,347 - INFO - ETL Step 1: Data extraction completed.


2024-09-03 11:44:45,350 - INFO - ETL Step 2: Transforming data.


2024-09-03 11:44:45,352 - INFO - Starting data transformation!!


2024-09-03 11:44:46,488 - INFO - dim_date data generated and saved!!


2024-09-03 11:44:46,619 - INFO - Transformed data saved to Dataset/Cleaned_payroll_Data/nycpayroll_2020.csv


2024-09-03 11:44:46,621 - INFO - ETL Step 2: Data transformation completed.


2024-09-03 11:44:46,622 - INFO - ETL Step 3: Loading data into Snowflake.


2024-09-03 11:44:47,561 - INFO - To route to workers diagnostics web server please install jupyter-server-proxy: python -m pip install jupyter-server-proxy


2024-09-03 11:44:47,611 - INFO - State start


2024-09-03 11:44:47,681 - INFO -   Scheduler at:     tcp://127.0.0.1:50503


2024-09-03 11:44:47,682 - INFO -   dashboard at:  http://127.0.0.1:8787/status


2024-09-03 11:44:47,683 - INFO - Registering Worker plugin shuffle


2024-09-03 11:44:47,750 - INFO -         Start Nanny at: 'tcp://127.0.0.1:50506'


2024-09-03 11:44:52,884 - INFO - Starting extract_files_from_adls function


2024-09-03 11:44:52,886 - INFO - Request URL: 'https://nycpayrollstorageaccount.blob.core.windows.net/nycpayrollcontainer?restype=REDACTED&comp=REDACTED&prefix=REDACTED'
Request method: 'GET'
Request headers:
    'x-ms-version': 'REDACTED'
    'Accept': 'application/xml'
    'User-Agent': 'azsdk-python-storage-blob/12.22.0 Python/3.12.4 (Windows-11-10.0.22631-SP0)'
    'x-ms-date': 'REDACTED'
    'x-ms-client-request-id': '8d2ce9a2-69e1-11ef-8d5b-f4a4751e46e5'
    'Authorization': 'REDACTED'
No body was attached to the request


2024-09-03 11:44:54,046 - INFO - Response status: 200
Response headers:
    'Transfer-Encoding': 'chunked'
    'Content-Type': 'application/xml'
    'Server': 'Windows-Azure-Blob/1.0 Microsoft-HTTPAPI/2.0'
    'x-ms-request-id': '7a4628eb-901e-0006-03ee-fdfb20000000'
    'x-ms-client-request-id': '8d2ce9a2-69e1-11ef-8d5b-f4a4751e46e5'
    'x-ms-version': 'REDACTED'
    'Date': 'Tue, 03 Sep 2024 10:44:57 GMT'


2024-09-03 11:44:54,055 - INFO - Starting data transformation!!


2024-09-03 11:44:55,586 - INFO - dim_date data generated and saved!!


2024-09-03 11:44:55,715 - INFO - Transformed data saved to Dataset/Cleaned_payroll_Data/nycpayroll_2020.csv


2024-09-03 11:44:55,868 - INFO -       Start worker at:      tcp://127.0.0.1:50513


2024-09-03 11:44:55,869 - INFO -          Listening to:      tcp://127.0.0.1:50513


2024-09-03 11:44:55,870 - INFO -           Worker name:                          0


2024-09-03 11:44:55,871 - INFO -          dashboard at:            127.0.0.1:50514


2024-09-03 11:44:55,872 - INFO - Waiting to connect to:      tcp://127.0.0.1:50503


2024-09-03 11:44:55,873 - INFO - -------------------------------------------------


2024-09-03 11:44:55,874 - INFO -               Threads:                          4


2024-09-03 11:44:55,875 - INFO -                Memory:                  19.84 GiB


2024-09-03 11:44:55,877 - INFO -       Local Directory: C:\Users\oluwa\AppData\Local\Temp\dask-scratch-space\worker-gjvfgjvk


2024-09-03 11:44:55,879 - INFO - -------------------------------------------------


2024-09-03 11:44:55,891 - INFO - Register worker <WorkerState 'tcp://127.0.0.1:50513', name: 0, status: init, memory: 0, processing: 0>


2024-09-03 11:44:55,900 - INFO - Starting worker compute stream, tcp://127.0.0.1:50513


2024-09-03 11:44:55,901 - INFO - Starting Worker plugin shuffle


2024-09-03 11:44:55,901 - INFO - Starting established connection to tcp://127.0.0.1:50515


2024-09-03 11:44:55,904 - INFO -         Registered to:      tcp://127.0.0.1:50503


2024-09-03 11:44:55,905 - INFO - -------------------------------------------------


2024-09-03 11:44:55,907 - INFO - Starting established connection to tcp://127.0.0.1:50503


2024-09-03 11:44:55,952 - INFO - Receive client connection: Client-8971533e-69e1-11ef-887c-f4a4751e46e5


2024-09-03 11:44:55,953 - INFO - Starting established connection to tcp://127.0.0.1:50516


2024-09-03 11:44:55,957 - INFO - Dask client initialized with 1 worker.


2024-09-03 11:44:56,003 - INFO - Connected to Snowflake successfully.


2024-09-03 11:44:56,019 - INFO - Transformed NycPayroll CSV file loaded successfully.


2024-09-03 11:44:56,035 - INFO - Snowflake Connector for Python Version: 3.12.1, Python Version: 3.12.4, Platform: Windows-11-10.0.22631-SP0


2024-09-03 11:44:56,037 - INFO - Connecting to GLOBAL Snowflake domain


2024-09-03 11:44:56,039 - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.


2024-09-03 11:44:59,836 - INFO - Number of results in first chunk: 1


2024-09-03 11:45:00,348 - INFO - Number of results in first chunk: 1


2024-09-03 11:45:00,989 - INFO - Number of results in first chunk: 1


2024-09-03 11:45:00,992 - INFO - Truncated Dim_Employee successfully.


2024-09-03 11:45:01,373 - INFO - Number of results in first chunk: 1


2024-09-03 11:45:01,376 - INFO - Truncated Dim_Agency successfully.


2024-09-03 11:45:01,781 - INFO - Number of results in first chunk: 1


2024-09-03 11:45:01,783 - INFO - Truncated Dim_PayBasis successfully.


2024-09-03 11:45:02,395 - INFO - Number of results in first chunk: 1


2024-09-03 11:45:02,396 - INFO - Truncated Dim_Date successfully.


2024-09-03 11:45:03,459 - INFO - Number of results in first chunk: 1


2024-09-03 11:45:03,460 - ERROR - Error loading data into Snowflake: (snowflake.connector.errors.ProgrammingError) 002003 (42S02): 01b6c825-0000-68ec-0022-af0300022176: SQL compilation error:
Table 'NYCPAYROLL_DWH.STG.DIM_FACTPAYROLL' does not exist or not authorized.
[SQL: TRUNCATE TABLE Dim_FactPayroll;]
(Background on this error at: https://sqlalche.me/e/20/f405)


2024-09-03 11:45:03,462 - ERROR - ETL pipeline failed: (snowflake.connector.errors.ProgrammingError) 002003 (42S02): 01b6c825-0000-68ec-0022-af0300022176: SQL compilation error:
Table 'NYCPAYROLL_DWH.STG.DIM_FACTPAYROLL' does not exist or not authorized.
[SQL: TRUNCATE TABLE Dim_FactPayroll;]
(Background on this error at: https://sqlalche.me/e/20/f405)


2024-09-03 11:45:03,526 - INFO - closed


2024-09-03 11:45:03,530 - INFO - No async queries seem to be running, deleting session


2024-09-03 11:45:03,995 - INFO - Retire worker addresses (0,)


2024-09-03 11:45:03,998 - INFO - Closing Nanny at 'tcp://127.0.0.1:50506'. Reason: nanny-close


2024-09-03 11:45:04,000 - INFO - Nanny asking worker to close. Reason: nanny-close


2024-09-03 11:45:04,005 - INFO - Stopping worker at tcp://127.0.0.1:50513. Reason: nanny-close


2024-09-03 11:45:04,008 - INFO - Removing Worker plugin shuffle


2024-09-03 11:45:04,019 - INFO - Received 'close-stream' from tcp://127.0.0.1:50515; closing.


2024-09-03 11:45:04,019 - INFO - Connection to tcp://127.0.0.1:50503 has been closed.


2024-09-03 11:45:04,022 - INFO - Remove worker <WorkerState 'tcp://127.0.0.1:50513', name: 0, status: closing, memory: 0, processing: 0> (stimulus_id='handle-worker-cleanup-1725360304.0230923')


2024-09-03 11:45:04,033 - INFO - Lost all workers


2024-09-03 11:45:04,653 - INFO - Closing scheduler. Reason: unknown


2024-09-03 11:45:04,655 - INFO - Scheduler closing all comms


2024-09-03 19:45:23,865 - INFO - Starting extract_files_from_adls function


2024-09-03 19:45:23,869 - INFO - Request URL: 'https://nycpayrollstorageaccount.blob.core.windows.net/nycpayrollcontainer?restype=REDACTED&comp=REDACTED&prefix=REDACTED'
Request method: 'GET'
Request headers:
    'x-ms-version': 'REDACTED'
    'Accept': 'application/xml'
    'User-Agent': 'azsdk-python-storage-blob/12.22.0 Python/3.12.4 (Windows-11-10.0.22631-SP0)'
    'x-ms-date': 'REDACTED'
    'x-ms-client-request-id': 'adc78de2-6a24-11ef-9fb7-f4a4751e46e5'
    'Authorization': 'REDACTED'
No body was attached to the request


2024-09-03 19:45:25,236 - INFO - Response status: 200
Response headers:
    'Transfer-Encoding': 'chunked'
    'Content-Type': 'application/xml'
    'Server': 'Windows-Azure-Blob/1.0 Microsoft-HTTPAPI/2.0'
    'x-ms-request-id': '875737e2-201e-004e-7931-fee617000000'
    'x-ms-client-request-id': 'adc78de2-6a24-11ef-9fb7-f4a4751e46e5'
    'x-ms-version': 'REDACTED'
    'Date': 'Tue, 03 Sep 2024 18:45:29 GMT'


2024-09-03 19:45:25,252 - INFO - Starting data transformation!!


2024-09-03 19:45:26,834 - INFO - dim_date data generated and saved!!


2024-09-03 19:45:26,893 - INFO - Transformed data saved to Dataset/Cleaned_payroll_Data/nycpayroll_2020.csv


2024-09-03 19:45:26,914 - INFO - Starting ETL pipeline.


2024-09-03 19:45:26,919 - INFO - ETL Pipeline started.


2024-09-03 19:45:26,919 - INFO - ETL Step 1: Extracting data from ADLS.


2024-09-03 19:45:26,920 - INFO - Starting extract_files_from_adls function


2024-09-03 19:45:26,921 - INFO - Request URL: 'https://nycpayrollstorageaccount.blob.core.windows.net/nycpayrollcontainer?restype=REDACTED&comp=REDACTED&prefix=REDACTED'
Request method: 'GET'
Request headers:
    'x-ms-version': 'REDACTED'
    'Accept': 'application/xml'
    'User-Agent': 'azsdk-python-storage-blob/12.22.0 Python/3.12.4 (Windows-11-10.0.22631-SP0)'
    'x-ms-date': 'REDACTED'
    'x-ms-client-request-id': 'af998f11-6a24-11ef-a353-f4a4751e46e5'
    'Authorization': 'REDACTED'
No body was attached to the request


2024-09-03 19:45:27,169 - INFO - Response status: 200
Response headers:
    'Transfer-Encoding': 'chunked'
    'Content-Type': 'application/xml'
    'Server': 'Windows-Azure-Blob/1.0 Microsoft-HTTPAPI/2.0'
    'x-ms-request-id': '87574420-201e-004e-3031-fee617000000'
    'x-ms-client-request-id': 'af998f11-6a24-11ef-a353-f4a4751e46e5'
    'x-ms-version': 'REDACTED'
    'Date': 'Tue, 03 Sep 2024 18:45:31 GMT'


2024-09-03 19:45:27,174 - INFO - Data extraction and movement completed.


2024-09-03 19:45:27,175 - INFO - ETL Step 1: Data extraction completed.


2024-09-03 19:45:27,177 - INFO - ETL Step 2: Transforming data.


2024-09-03 19:45:27,178 - INFO - Starting data transformation!!


2024-09-03 19:45:27,588 - INFO - dim_date data generated and saved!!


2024-09-03 19:45:27,670 - INFO - Transformed data saved to Dataset/Cleaned_payroll_Data/nycpayroll_2020.csv


2024-09-03 19:45:27,671 - INFO - ETL Step 2: Data transformation completed.


2024-09-03 19:45:27,672 - INFO - ETL Step 3: Loading data into Snowflake.


2024-09-03 19:45:29,116 - INFO - To route to workers diagnostics web server please install jupyter-server-proxy: python -m pip install jupyter-server-proxy


2024-09-03 19:45:29,191 - INFO - State start


2024-09-03 19:45:29,251 - INFO -   Scheduler at:     tcp://127.0.0.1:56368


2024-09-03 19:45:29,251 - INFO -   dashboard at:  http://127.0.0.1:8787/status


2024-09-03 19:45:29,252 - INFO - Registering Worker plugin shuffle


2024-09-03 19:45:29,317 - INFO -         Start Nanny at: 'tcp://127.0.0.1:56371'


2024-09-03 19:45:31,698 - INFO - Starting extract_files_from_adls function


2024-09-03 19:45:31,700 - INFO - Request URL: 'https://nycpayrollstorageaccount.blob.core.windows.net/nycpayrollcontainer?restype=REDACTED&comp=REDACTED&prefix=REDACTED'
Request method: 'GET'
Request headers:
    'x-ms-version': 'REDACTED'
    'Accept': 'application/xml'
    'User-Agent': 'azsdk-python-storage-blob/12.22.0 Python/3.12.4 (Windows-11-10.0.22631-SP0)'
    'x-ms-date': 'REDACTED'
    'x-ms-client-request-id': 'b27291dc-6a24-11ef-8f0c-f4a4751e46e5'
    'Authorization': 'REDACTED'
No body was attached to the request


2024-09-03 19:45:32,722 - INFO - Response status: 200
Response headers:
    'Transfer-Encoding': 'chunked'
    'Content-Type': 'application/xml'
    'Server': 'Windows-Azure-Blob/1.0 Microsoft-HTTPAPI/2.0'
    'x-ms-request-id': 'bc804f78-701e-007c-0a31-fee660000000'
    'x-ms-client-request-id': 'b27291dc-6a24-11ef-8f0c-f4a4751e46e5'
    'x-ms-version': 'REDACTED'
    'Date': 'Tue, 03 Sep 2024 18:45:37 GMT'


2024-09-03 19:45:32,730 - INFO - Starting data transformation!!


2024-09-03 19:45:33,511 - INFO - dim_date data generated and saved!!


2024-09-03 19:45:33,563 - INFO - Transformed data saved to Dataset/Cleaned_payroll_Data/nycpayroll_2020.csv


2024-09-03 19:45:33,675 - INFO -       Start worker at:      tcp://127.0.0.1:56378


2024-09-03 19:45:33,676 - INFO -          Listening to:      tcp://127.0.0.1:56378


2024-09-03 19:45:33,676 - INFO -           Worker name:                          0


2024-09-03 19:45:33,677 - INFO -          dashboard at:            127.0.0.1:56379


2024-09-03 19:45:33,677 - INFO - Waiting to connect to:      tcp://127.0.0.1:56368


2024-09-03 19:45:33,678 - INFO - -------------------------------------------------


2024-09-03 19:45:33,679 - INFO -               Threads:                          4


2024-09-03 19:45:33,679 - INFO -                Memory:                  19.84 GiB


2024-09-03 19:45:33,680 - INFO -       Local Directory: C:\Users\oluwa\AppData\Local\Temp\dask-scratch-space\worker-pqssda6t


2024-09-03 19:45:33,680 - INFO - -------------------------------------------------


2024-09-03 19:45:33,686 - INFO - Register worker <WorkerState 'tcp://127.0.0.1:56378', name: 0, status: init, memory: 0, processing: 0>


2024-09-03 19:45:33,690 - INFO - Starting worker compute stream, tcp://127.0.0.1:56378


2024-09-03 19:45:33,690 - INFO - Starting Worker plugin shuffle


2024-09-03 19:45:33,690 - INFO - Starting established connection to tcp://127.0.0.1:56380


2024-09-03 19:45:33,691 - INFO -         Registered to:      tcp://127.0.0.1:56368


2024-09-03 19:45:33,692 - INFO - -------------------------------------------------


2024-09-03 19:45:33,694 - INFO - Starting established connection to tcp://127.0.0.1:56368


2024-09-03 19:45:33,730 - INFO - Receive client connection: Client-b00c24f4-6a24-11ef-be10-f4a4751e46e5


2024-09-03 19:45:33,730 - INFO - Starting established connection to tcp://127.0.0.1:56381


2024-09-03 19:45:33,732 - INFO - Dask client initialized with 1 worker.


2024-09-03 19:45:33,747 - INFO - Connected to Snowflake successfully.


2024-09-03 19:45:33,752 - INFO - Transformed NycPayroll CSV file loaded successfully.


2024-09-03 19:45:33,754 - INFO - Snowflake Connector for Python Version: 3.12.1, Python Version: 3.12.4, Platform: Windows-11-10.0.22631-SP0


2024-09-03 19:45:33,755 - INFO - Connecting to GLOBAL Snowflake domain


2024-09-03 19:45:33,769 - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.


2024-09-03 19:45:36,127 - INFO - Number of results in first chunk: 1


2024-09-03 19:45:36,429 - INFO - Number of results in first chunk: 1


2024-09-03 19:45:36,860 - INFO - Number of results in first chunk: 1


2024-09-03 19:45:36,861 - INFO - Truncated Dim_Employee successfully.


2024-09-03 19:45:37,205 - INFO - Number of results in first chunk: 1


2024-09-03 19:45:37,208 - INFO - Truncated Dim_Agency successfully.


2024-09-03 19:45:37,634 - INFO - Number of results in first chunk: 1


2024-09-03 19:45:37,637 - INFO - Truncated Dim_PayBasis successfully.


2024-09-03 19:45:38,011 - INFO - Number of results in first chunk: 1


2024-09-03 19:45:38,013 - INFO - Truncated Dim_Date successfully.


2024-09-03 19:45:38,854 - INFO - Number of results in first chunk: 1


2024-09-03 19:45:38,855 - ERROR - Error loading data into Snowflake: (snowflake.connector.errors.ProgrammingError) 002003 (42S02): 01b6ca05-0000-68ec-0022-af0300022222: SQL compilation error:
Table 'NYCPAYROLL_DWH.STG.FACTPAYROLL' does not exist or not authorized.
[SQL: TRUNCATE TABLE FactPayroll;]
(Background on this error at: https://sqlalche.me/e/20/f405)


2024-09-03 19:45:38,856 - ERROR - ETL pipeline failed: (snowflake.connector.errors.ProgrammingError) 002003 (42S02): 01b6ca05-0000-68ec-0022-af0300022222: SQL compilation error:
Table 'NYCPAYROLL_DWH.STG.FACTPAYROLL' does not exist or not authorized.
[SQL: TRUNCATE TABLE FactPayroll;]
(Background on this error at: https://sqlalche.me/e/20/f405)


2024-09-03 19:45:38,885 - INFO - closed


2024-09-03 19:45:38,885 - INFO - No async queries seem to be running, deleting session


2024-09-03 19:45:39,192 - INFO - Retire worker addresses (0,)


2024-09-03 19:45:39,196 - INFO - Closing Nanny at 'tcp://127.0.0.1:56371'. Reason: nanny-close


2024-09-03 19:45:39,200 - INFO - Nanny asking worker to close. Reason: nanny-close


2024-09-03 19:45:39,253 - INFO - Stopping worker at tcp://127.0.0.1:56378. Reason: nanny-close


2024-09-03 19:45:39,254 - INFO - Removing Worker plugin shuffle


2024-09-03 19:45:39,256 - ERROR - Failed to communicate with scheduler during heartbeat.

Traceback (most recent call last):
  File "C:\Users\oluwa\AppData\Roaming\Python\Python312\site-packages\distributed\comm\tcp.py", line 225, in read
    frames_nosplit_nbytes_bin = await stream.read_bytes(fmt_size)
                                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
tornado.iostream.StreamClosedError: Stream is closed

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "C:\Users\oluwa\AppData\Roaming\Python\Python312\site-packages\distributed\worker.py", line 1250, in heartbeat
    response = await retry_operation(
               ^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\oluwa\AppData\Roaming\Python\Python312\site-packages\distributed\utils_comm.py", line 459, in retry_operation
    return await retry(
           ^^^^^^^^^^^^
  File "C:\Users\oluwa\AppData\Roaming\Python\Python312\site-packages\distributed\utils_comm.py", line 438, in retry
    return await coro()
           ^^^^^^^^^^^^
  File "C:\Users\oluwa\AppData\Roaming\Python\Python312\site-packages\distributed\core.py", line 1256, in send_recv_from_rpc
    return await send_recv(comm=comm, op=key, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\oluwa\AppData\Roaming\Python\Python312\site-packages\distributed\core.py", line 1015, in send_recv
    response = await comm.read(deserializers=deserializers)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\oluwa\AppData\Roaming\Python\Python312\site-packages\distributed\comm\tcp.py", line 236, in read
    convert_stream_closed_error(self, e)
  File "C:\Users\oluwa\AppData\Roaming\Python\Python312\site-packages\distributed\comm\tcp.py", line 142, in convert_stream_closed_error
    raise CommClosedError(f"in {obj}: {exc}") from exc
distributed.comm.core.CommClosedError: in <TCP (closed) ConnectionPool.heartbeat_worker local=tcp://127.0.0.1:56384 remote=tcp://127.0.0.1:56368>: Stream is closed
2024-09-03 19:45:39,294 - INFO - Received 'close-stream' from tcp://127.0.0.1:56380; closing.


2024-09-03 19:45:39,295 - INFO - Connection to tcp://127.0.0.1:56368 has been closed.


2024-09-03 19:45:39,295 - INFO - Remove worker <WorkerState 'tcp://127.0.0.1:56378', name: 0, status: closing, memory: 0, processing: 0> (stimulus_id='handle-worker-cleanup-1725389139.2958648')


2024-09-03 19:45:39,296 - INFO - Lost all workers


2024-09-03 19:45:39,611 - INFO - Closing scheduler. Reason: unknown


2024-09-03 19:45:39,611 - INFO - Scheduler closing all comms


2024-09-03 19:45:57,577 - INFO - Starting extract_files_from_adls function


2024-09-03 19:45:57,579 - INFO - Request URL: 'https://nycpayrollstorageaccount.blob.core.windows.net/nycpayrollcontainer?restype=REDACTED&comp=REDACTED&prefix=REDACTED'
Request method: 'GET'
Request headers:
    'x-ms-version': 'REDACTED'
    'Accept': 'application/xml'
    'User-Agent': 'azsdk-python-storage-blob/12.22.0 Python/3.12.4 (Windows-11-10.0.22631-SP0)'
    'x-ms-date': 'REDACTED'
    'x-ms-client-request-id': 'c1df7b98-6a24-11ef-b302-f4a4751e46e5'
    'Authorization': 'REDACTED'
No body was attached to the request


2024-09-03 19:45:58,608 - INFO - Response status: 200
Response headers:
    'Transfer-Encoding': 'chunked'
    'Content-Type': 'application/xml'
    'Server': 'Windows-Azure-Blob/1.0 Microsoft-HTTPAPI/2.0'
    'x-ms-request-id': 'bfd9b96a-b01e-0073-4f31-fe900c000000'
    'x-ms-client-request-id': 'c1df7b98-6a24-11ef-b302-f4a4751e46e5'
    'x-ms-version': 'REDACTED'
    'Date': 'Tue, 03 Sep 2024 18:46:02 GMT'


2024-09-03 19:45:58,613 - INFO - Starting data transformation!!


2024-09-03 19:45:59,496 - INFO - dim_date data generated and saved!!


2024-09-03 19:45:59,549 - INFO - Transformed data saved to Dataset/Cleaned_payroll_Data/nycpayroll_2020.csv


2024-09-03 19:45:59,554 - INFO - Starting ETL pipeline.


2024-09-03 19:45:59,557 - INFO - ETL Pipeline started.


2024-09-03 19:45:59,557 - INFO - ETL Step 1: Extracting data from ADLS.


2024-09-03 19:45:59,558 - INFO - Starting extract_files_from_adls function


2024-09-03 19:45:59,558 - INFO - Request URL: 'https://nycpayrollstorageaccount.blob.core.windows.net/nycpayrollcontainer?restype=REDACTED&comp=REDACTED&prefix=REDACTED'
Request method: 'GET'
Request headers:
    'x-ms-version': 'REDACTED'
    'Accept': 'application/xml'
    'User-Agent': 'azsdk-python-storage-blob/12.22.0 Python/3.12.4 (Windows-11-10.0.22631-SP0)'
    'x-ms-date': 'REDACTED'
    'x-ms-client-request-id': 'c30d9277-6a24-11ef-846e-f4a4751e46e5'
    'Authorization': 'REDACTED'
No body was attached to the request


2024-09-03 19:45:59,806 - INFO - Response status: 200
Response headers:
    'Transfer-Encoding': 'chunked'
    'Content-Type': 'application/xml'
    'Server': 'Windows-Azure-Blob/1.0 Microsoft-HTTPAPI/2.0'
    'x-ms-request-id': 'bfd9baf7-b01e-0073-6331-fe900c000000'
    'x-ms-client-request-id': 'c30d9277-6a24-11ef-846e-f4a4751e46e5'
    'x-ms-version': 'REDACTED'
    'Date': 'Tue, 03 Sep 2024 18:46:04 GMT'


2024-09-03 19:45:59,811 - INFO - Data extraction and movement completed.


2024-09-03 19:45:59,812 - INFO - ETL Step 1: Data extraction completed.


2024-09-03 19:45:59,816 - INFO - ETL Step 2: Transforming data.


2024-09-03 19:45:59,818 - INFO - Starting data transformation!!


2024-09-03 19:46:00,225 - INFO - dim_date data generated and saved!!


2024-09-03 19:46:00,276 - INFO - Transformed data saved to Dataset/Cleaned_payroll_Data/nycpayroll_2020.csv


2024-09-03 19:46:00,276 - INFO - ETL Step 2: Data transformation completed.


2024-09-03 19:46:00,277 - INFO - ETL Step 3: Loading data into Snowflake.


2024-09-03 19:46:00,765 - INFO - To route to workers diagnostics web server please install jupyter-server-proxy: python -m pip install jupyter-server-proxy


2024-09-03 19:46:00,798 - INFO - State start


2024-09-03 19:46:00,838 - INFO -   Scheduler at:     tcp://127.0.0.1:56391


2024-09-03 19:46:00,839 - INFO -   dashboard at:  http://127.0.0.1:8787/status


2024-09-03 19:46:00,840 - INFO - Registering Worker plugin shuffle


2024-09-03 19:46:00,884 - INFO -         Start Nanny at: 'tcp://127.0.0.1:56394'


2024-09-03 19:46:03,538 - INFO - Starting extract_files_from_adls function


2024-09-03 19:46:03,540 - INFO - Request URL: 'https://nycpayrollstorageaccount.blob.core.windows.net/nycpayrollcontainer?restype=REDACTED&comp=REDACTED&prefix=REDACTED'
Request method: 'GET'
Request headers:
    'x-ms-version': 'REDACTED'
    'Accept': 'application/xml'
    'User-Agent': 'azsdk-python-storage-blob/12.22.0 Python/3.12.4 (Windows-11-10.0.22631-SP0)'
    'x-ms-date': 'REDACTED'
    'x-ms-client-request-id': 'c56cf621-6a24-11ef-88ef-f4a4751e46e5'
    'Authorization': 'REDACTED'
No body was attached to the request


2024-09-03 19:46:04,578 - INFO - Response status: 200
Response headers:
    'Transfer-Encoding': 'chunked'
    'Content-Type': 'application/xml'
    'Server': 'Windows-Azure-Blob/1.0 Microsoft-HTTPAPI/2.0'
    'x-ms-request-id': '7ab896af-d01e-004a-2c31-fe6b10000000'
    'x-ms-client-request-id': 'c56cf621-6a24-11ef-88ef-f4a4751e46e5'
    'x-ms-version': 'REDACTED'
    'Date': 'Tue, 03 Sep 2024 18:46:08 GMT'


2024-09-03 19:46:04,587 - INFO - Starting data transformation!!


2024-09-03 19:46:05,377 - INFO - dim_date data generated and saved!!


2024-09-03 19:46:05,436 - INFO - Transformed data saved to Dataset/Cleaned_payroll_Data/nycpayroll_2020.csv


2024-09-03 19:46:05,535 - INFO -       Start worker at:      tcp://127.0.0.1:56401


2024-09-03 19:46:05,536 - INFO -          Listening to:      tcp://127.0.0.1:56401


2024-09-03 19:46:05,536 - INFO -           Worker name:                          0


2024-09-03 19:46:05,537 - INFO -          dashboard at:            127.0.0.1:56402


2024-09-03 19:46:05,537 - INFO - Waiting to connect to:      tcp://127.0.0.1:56391


2024-09-03 19:46:05,537 - INFO - -------------------------------------------------


2024-09-03 19:46:05,537 - INFO -               Threads:                          4


2024-09-03 19:46:05,539 - INFO -                Memory:                  19.84 GiB


2024-09-03 19:46:05,539 - INFO -       Local Directory: C:\Users\oluwa\AppData\Local\Temp\dask-scratch-space\worker-ntuygfop


2024-09-03 19:46:05,540 - INFO - -------------------------------------------------


2024-09-03 19:46:05,545 - INFO - Register worker <WorkerState 'tcp://127.0.0.1:56401', name: 0, status: init, memory: 0, processing: 0>


2024-09-03 19:46:05,548 - INFO - Starting worker compute stream, tcp://127.0.0.1:56401


2024-09-03 19:46:05,549 - INFO - Starting Worker plugin shuffle


cp://127.0.0.1:56403


2024-09-03 19:46:05,551 - INFO -         Registered to:      tcp://127.0.0.1:56391


2024-09-03 19:46:05,552 - INFO - -------------------------------------------------


2024-09-03 19:46:05,554 - INFO - Starting established connection to tcp://127.0.0.1:56391


2024-09-03 19:46:05,598 - INFO - Receive client connection: Client-c37b545d-6a24-11ef-b880-f4a4751e46e5


2024-09-03 19:46:05,599 - INFO - Starting established connection to tcp://127.0.0.1:56404


2024-09-03 19:46:05,602 - INFO - Dask client initialized with 1 worker.


2024-09-03 19:46:05,617 - INFO - Connected to Snowflake successfully.


2024-09-03 19:46:05,620 - INFO - Transformed NycPayroll CSV file loaded successfully.


2024-09-03 19:46:05,621 - INFO - Snowflake Connector for Python Version: 3.12.1, Python Version: 3.12.4, Platform: Windows-11-10.0.22631-SP0


2024-09-03 19:46:05,623 - INFO - Connecting to GLOBAL Snowflake domain


2024-09-03 19:46:05,623 - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.


2024-09-03 19:46:07,985 - INFO - Number of results in first chunk: 1


2024-09-03 19:46:08,259 - INFO - Number of results in first chunk: 1


2024-09-03 19:46:08,645 - INFO - Number of results in first chunk: 1


2024-09-03 19:46:08,646 - INFO - Truncated Dim_Employee successfully.


2024-09-03 19:46:09,016 - INFO - Number of results in first chunk: 1


2024-09-03 19:46:09,017 - INFO - Truncated Dim_Agency successfully.


2024-09-03 19:46:09,367 - INFO - Number of results in first chunk: 1


2024-09-03 19:46:09,367 - INFO - Truncated Dim_PayBasis successfully.


2024-09-03 19:46:09,702 - INFO - Number of results in first chunk: 1


2024-09-03 19:46:09,703 - INFO - Truncated Dim_Date successfully.


2024-09-03 19:46:10,802 - INFO - Number of results in first chunk: 1


2024-09-03 19:46:10,805 - ERROR - Error loading data into Snowflake: (snowflake.connector.errors.ProgrammingError) 002003 (42S02): 01b6ca06-0000-68c9-0022-af030002310e: SQL compilation error:
Table 'NYCPAYROLL_DWH.STG.FACTPAYROLL' does not exist or not authorized.
[SQL: TRUNCATE TABLE FactPayroll;]
(Background on this error at: https://sqlalche.me/e/20/f405)


2024-09-03 19:46:10,807 - ERROR - ETL pipeline failed: (snowflake.connector.errors.ProgrammingError) 002003 (42S02): 01b6ca06-0000-68c9-0022-af030002310e: SQL compilation error:
Table 'NYCPAYROLL_DWH.STG.FACTPAYROLL' does not exist or not authorized.
[SQL: TRUNCATE TABLE FactPayroll;]
(Background on this error at: https://sqlalche.me/e/20/f405)


2024-09-03 19:46:10,860 - INFO - closed


2024-09-03 19:46:10,861 - INFO - No async queries seem to be running, deleting session


2024-09-03 19:46:11,216 - INFO - Retire worker addresses (0,)


2024-09-03 19:46:11,219 - INFO - Closing Nanny at 'tcp://127.0.0.1:56394'. Reason: nanny-close


2024-09-03 19:46:11,220 - INFO - Nanny asking worker to close. Reason: nanny-close


2024-09-03 19:46:11,224 - INFO - Stopping worker at tcp://127.0.0.1:56401. Reason: nanny-close


2024-09-03 19:46:11,226 - INFO - Removing Worker plugin shuffle


2024-09-03 19:46:11,232 - INFO - Received 'close-stream' from tcp://127.0.0.1:56403; closing.


2024-09-03 19:46:11,232 - INFO - Connection to tcp://127.0.0.1:56391 has been closed.


2024-09-03 19:46:11,234 - INFO - Remove worker <WorkerState 'tcp://127.0.0.1:56401', name: 0, status: closing, memory: 0, processing: 0> (stimulus_id='handle-worker-cleanup-1725389171.2346392')


2024-09-03 19:46:11,235 - INFO - Lost all workers


2024-09-03 19:46:11,534 - INFO - Closing scheduler. Reason: unknown


2024-09-03 19:46:11,534 - INFO - Scheduler closing all comms


2024-09-03 20:27:56,386 - INFO - Starting extract_files_from_adls function


2024-09-03 20:27:56,387 - INFO - Request URL: 'https://nycpayrollstorageaccount.blob.core.windows.net/nycpayrollcontainer?restype=REDACTED&comp=REDACTED&prefix=REDACTED'
Request method: 'GET'
Request headers:
    'x-ms-version': 'REDACTED'
    'Accept': 'application/xml'
    'User-Agent': 'azsdk-python-storage-blob/12.22.0 Python/3.12.4 (Windows-11-10.0.22631-SP0)'
    'x-ms-date': 'REDACTED'
    'x-ms-client-request-id': '9f331d0b-6a2a-11ef-beab-f4a4751e46e5'
    'Authorization': 'REDACTED'
No body was attached to the request


2024-09-03 20:27:59,272 - INFO - Response status: 200
Response headers:
    'Transfer-Encoding': 'chunked'
    'Content-Type': 'application/xml'
    'Server': 'Windows-Azure-Blob/1.0 Microsoft-HTTPAPI/2.0'
    'x-ms-request-id': 'a37c62cc-001e-003b-5637-fe8d3b000000'
    'x-ms-client-request-id': '9f331d0b-6a2a-11ef-beab-f4a4751e46e5'
    'x-ms-version': 'REDACTED'
    'Date': 'Tue, 03 Sep 2024 19:28:03 GMT'


2024-09-03 20:27:59,282 - INFO - Starting data transformation!!


2024-09-03 20:28:00,182 - INFO - dim_date data generated and saved!!


2024-09-03 20:28:00,239 - INFO - Transformed data saved to Dataset/Cleaned_payroll_Data/nycpayroll_2020.csv


2024-09-03 20:28:00,252 - INFO - Starting ETL pipeline.


2024-09-03 20:28:00,255 - INFO - ETL Pipeline started.


2024-09-03 20:28:00,255 - INFO - ETL Step 1: Extracting data from ADLS.


2024-09-03 20:28:00,256 - INFO - Starting extract_files_from_adls function


2024-09-03 20:28:00,256 - INFO - Request URL: 'https://nycpayrollstorageaccount.blob.core.windows.net/nycpayrollcontainer?restype=REDACTED&comp=REDACTED&prefix=REDACTED'
Request method: 'GET'
Request headers:
    'x-ms-version': 'REDACTED'
    'Accept': 'application/xml'
    'User-Agent': 'azsdk-python-storage-blob/12.22.0 Python/3.12.4 (Windows-11-10.0.22631-SP0)'
    'x-ms-date': 'REDACTED'
    'x-ms-client-request-id': 'a1818e76-6a2a-11ef-8872-f4a4751e46e5'
    'Authorization': 'REDACTED'
No body was attached to the request


2024-09-03 20:28:00,524 - INFO - Response status: 200
Response headers:
    'Transfer-Encoding': 'chunked'
    'Content-Type': 'application/xml'
    'Server': 'Windows-Azure-Blob/1.0 Microsoft-HTTPAPI/2.0'
    'x-ms-request-id': 'a37c6cac-001e-003b-4337-fe8d3b000000'
    'x-ms-client-request-id': 'a1818e76-6a2a-11ef-8872-f4a4751e46e5'
    'x-ms-version': 'REDACTED'
    'Date': 'Tue, 03 Sep 2024 19:28:04 GMT'


2024-09-03 20:28:00,528 - INFO - Data extraction and movement completed.


2024-09-03 20:28:00,530 - INFO - ETL Step 1: Data extraction completed.


2024-09-03 20:28:00,531 - INFO - ETL Step 2: Transforming data.


2024-09-03 20:28:00,532 - INFO - Starting data transformation!!


2024-09-03 20:28:00,939 - INFO - dim_date data generated and saved!!


2024-09-03 20:28:00,998 - INFO - Transformed data saved to Dataset/Cleaned_payroll_Data/nycpayroll_2020.csv


2024-09-03 20:28:00,998 - INFO - ETL Step 2: Data transformation completed.


2024-09-03 20:28:01,000 - INFO - ETL Step 3: Loading data into Snowflake.


2024-09-03 20:28:01,494 - INFO - To route to workers diagnostics web server please install jupyter-server-proxy: python -m pip install jupyter-server-proxy


2024-09-03 20:28:01,527 - INFO - State start


2024-09-03 20:28:01,566 - INFO -   Scheduler at:     tcp://127.0.0.1:56757


2024-09-03 20:28:01,567 - INFO -   dashboard at:  http://127.0.0.1:8787/status


2024-09-03 20:28:01,568 - INFO - Registering Worker plugin shuffle


2024-09-03 20:28:01,608 - INFO -         Start Nanny at: 'tcp://127.0.0.1:56760'


2024-09-03 20:28:04,337 - INFO - Starting extract_files_from_adls function


2024-09-03 20:28:04,338 - INFO - Request URL: 'https://nycpayrollstorageaccount.blob.core.windows.net/nycpayrollcontainer?restype=REDACTED&comp=REDACTED&prefix=REDACTED'
Request method: 'GET'
Request headers:
    'x-ms-version': 'REDACTED'
    'Accept': 'application/xml'
    'User-Agent': 'azsdk-python-storage-blob/12.22.0 Python/3.12.4 (Windows-11-10.0.22631-SP0)'
    'x-ms-date': 'REDACTED'
    'x-ms-client-request-id': 'a3f03139-6a2a-11ef-8b42-f4a4751e46e5'
    'Authorization': 'REDACTED'
No body was attached to the request


2024-09-03 20:28:06,264 - INFO - Response status: 200
Response headers:
    'Transfer-Encoding': 'chunked'
    'Content-Type': 'application/xml'
    'Server': 'Windows-Azure-Blob/1.0 Microsoft-HTTPAPI/2.0'
    'x-ms-request-id': '53bcb54a-101e-0055-1237-fed814000000'
    'x-ms-client-request-id': 'a3f03139-6a2a-11ef-8b42-f4a4751e46e5'
    'x-ms-version': 'REDACTED'
    'Date': 'Tue, 03 Sep 2024 19:28:10 GMT'


2024-09-03 20:28:06,272 - INFO - Starting data transformation!!


2024-09-03 20:28:07,117 - INFO - dim_date data generated and saved!!


2024-09-03 20:28:07,171 - INFO - Transformed data saved to Dataset/Cleaned_payroll_Data/nycpayroll_2020.csv


2024-09-03 20:28:07,280 - INFO -       Start worker at:      tcp://127.0.0.1:56767


2024-09-03 20:28:07,281 - INFO -          Listening to:      tcp://127.0.0.1:56767


2024-09-03 20:28:07,281 - INFO -           Worker name:                          0


2024-09-03 20:28:07,281 - INFO -          dashboard at:            127.0.0.1:56768


2024-09-03 20:28:07,282 - INFO - Waiting to connect to:      tcp://127.0.0.1:56757


2024-09-03 20:28:07,282 - INFO - -------------------------------------------------


2024-09-03 20:28:07,282 - INFO -               Threads:                          4


2024-09-03 20:28:07,284 - INFO -                Memory:                  19.84 GiB


2024-09-03 20:28:07,284 - INFO -       Local Directory: C:\Users\oluwa\AppData\Local\Temp\dask-scratch-space\worker-f0xjwlev


2024-09-03 20:28:07,285 - INFO - -------------------------------------------------


2024-09-03 20:28:07,289 - INFO - Register worker <WorkerState 'tcp://127.0.0.1:56767', name: 0, status: init, memory: 0, processing: 0>


2024-09-03 20:28:07,292 - INFO - Starting worker compute stream, tcp://127.0.0.1:56767


2024-09-03 20:28:07,293 - INFO - Starting Worker plugin shuffle


cp://127.0.0.1:56769


2024-09-03 20:28:07,295 - INFO -         Registered to:      tcp://127.0.0.1:56757


2024-09-03 20:28:07,295 - INFO - -------------------------------------------------


2024-09-03 20:28:07,297 - INFO - Starting established connection to tcp://127.0.0.1:56757


2024-09-03 20:28:07,334 - INFO - Receive client connection: Client-a1f30edf-6a2a-11ef-a3c0-f4a4751e46e5


2024-09-03 20:28:07,337 - INFO - Starting established connection to tcp://127.0.0.1:56770


2024-09-03 20:28:07,338 - INFO - Dask client initialized with 1 worker.


2024-09-03 20:28:07,360 - INFO - Connected to Snowflake successfully.


2024-09-03 20:28:07,363 - INFO - Transformed NycPayroll CSV file loaded successfully.


2024-09-03 20:28:07,365 - INFO - Snowflake Connector for Python Version: 3.12.1, Python Version: 3.12.4, Platform: Windows-11-10.0.22631-SP0


2024-09-03 20:28:07,366 - INFO - Connecting to GLOBAL Snowflake domain


2024-09-03 20:28:07,366 - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.


2024-09-03 20:28:10,125 - INFO - Number of results in first chunk: 1


2024-09-03 20:28:10,629 - INFO - Number of results in first chunk: 1


2024-09-03 20:28:11,844 - INFO - Number of results in first chunk: 1


2024-09-03 20:28:11,845 - ERROR - Error loading data into Snowflake: (snowflake.connector.errors.ProgrammingError) 001003 (42000): 01b6ca30-0000-6762-0022-af0300019e4e: SQL compilation error:
syntax error line 1 at position 20 unexpected 'EXISTSDim_Employee'.
syntax error line 1 at position 39 unexpected ')'.
[SQL: CREATE TABLE IF NOT EXISTSDim_Employee();]
(Background on this error at: https://sqlalche.me/e/20/f405)


2024-09-03 20:28:11,846 - ERROR - ETL pipeline failed: (snowflake.connector.errors.ProgrammingError) 001003 (42000): 01b6ca30-0000-6762-0022-af0300019e4e: SQL compilation error:
syntax error line 1 at position 20 unexpected 'EXISTSDim_Employee'.
syntax error line 1 at position 39 unexpected ')'.
[SQL: CREATE TABLE IF NOT EXISTSDim_Employee();]
(Background on this error at: https://sqlalche.me/e/20/f405)


2024-09-03 20:28:11,871 - INFO - closed


2024-09-03 20:28:11,872 - INFO - No async queries seem to be running, deleting session


2024-09-03 20:28:12,345 - INFO - Retire worker addresses (0,)


2024-09-03 20:28:12,347 - INFO - Closing Nanny at 'tcp://127.0.0.1:56760'. Reason: nanny-close


2024-09-03 20:28:12,347 - INFO - Nanny asking worker to close. Reason: nanny-close


2024-09-03 20:28:12,349 - INFO - Stopping worker at tcp://127.0.0.1:56767. Reason: nanny-close


2024-09-03 20:28:12,349 - INFO - Removing Worker plugin shuffle


2024-09-03 20:28:12,352 - INFO - Connection to tcp://127.0.0.1:56757 has been closed.


g.


2024-09-03 20:28:12,353 - INFO - Remove worker <WorkerState 'tcp://127.0.0.1:56767', name: 0, status: closing, memory: 0, processing: 0> (stimulus_id='handle-worker-cleanup-1725391692.35388')


2024-09-03 20:28:12,355 - INFO - Lost all workers


2024-09-03 20:28:12,647 - INFO - Closing scheduler. Reason: unknown


2024-09-03 20:28:12,647 - INFO - Scheduler closing all comms


2024-09-03 20:31:22,070 - INFO - Starting extract_files_from_adls function


2024-09-03 20:31:22,072 - INFO - Request URL: 'https://nycpayrollstorageaccount.blob.core.windows.net/nycpayrollcontainer?restype=REDACTED&comp=REDACTED&prefix=REDACTED'
Request method: 'GET'
Request headers:
    'x-ms-version': 'REDACTED'
    'Accept': 'application/xml'
    'User-Agent': 'azsdk-python-storage-blob/12.22.0 Python/3.12.4 (Windows-11-10.0.22631-SP0)'
    'x-ms-date': 'REDACTED'
    'x-ms-client-request-id': '19cc18a7-6a2b-11ef-9c6e-f4a4751e46e5'
    'Authorization': 'REDACTED'
No body was attached to the request


2024-09-03 20:31:23,396 - INFO - Response status: 200
Response headers:
    'Transfer-Encoding': 'chunked'
    'Content-Type': 'application/xml'
    'Server': 'Windows-Azure-Blob/1.0 Microsoft-HTTPAPI/2.0'
    'x-ms-request-id': '272c0755-c01e-0046-4037-fefc18000000'
    'x-ms-client-request-id': '19cc18a7-6a2b-11ef-9c6e-f4a4751e46e5'
    'x-ms-version': 'REDACTED'
    'Date': 'Tue, 03 Sep 2024 19:31:27 GMT'


2024-09-03 20:31:23,405 - INFO - Starting data transformation!!


2024-09-03 20:31:24,231 - INFO - dim_date data generated and saved!!


2024-09-03 20:31:24,287 - INFO - Transformed data saved to Dataset/Cleaned_payroll_Data/nycpayroll_2020.csv


2024-09-03 20:31:24,295 - INFO - Starting ETL pipeline.


2024-09-03 20:31:24,299 - INFO - ETL Pipeline started.


2024-09-03 20:31:24,299 - INFO - ETL Step 1: Extracting data from ADLS.


2024-09-03 20:31:24,299 - INFO - Starting extract_files_from_adls function


2024-09-03 20:31:24,302 - INFO - Request URL: 'https://nycpayrollstorageaccount.blob.core.windows.net/nycpayrollcontainer?restype=REDACTED&comp=REDACTED&prefix=REDACTED'
Request method: 'GET'
Request headers:
    'x-ms-version': 'REDACTED'
    'Accept': 'application/xml'
    'User-Agent': 'azsdk-python-storage-blob/12.22.0 Python/3.12.4 (Windows-11-10.0.22631-SP0)'
    'x-ms-date': 'REDACTED'
    'x-ms-client-request-id': '1b206526-6a2b-11ef-a9d3-f4a4751e46e5'
    'Authorization': 'REDACTED'
No body was attached to the request


2024-09-03 20:31:24,625 - INFO - Response status: 200
Response headers:
    'Transfer-Encoding': 'chunked'
    'Content-Type': 'application/xml'
    'Server': 'Windows-Azure-Blob/1.0 Microsoft-HTTPAPI/2.0'
    'x-ms-request-id': '272c124e-c01e-0046-7537-fefc18000000'
    'x-ms-client-request-id': '1b206526-6a2b-11ef-a9d3-f4a4751e46e5'
    'x-ms-version': 'REDACTED'
    'Date': 'Tue, 03 Sep 2024 19:31:28 GMT'


2024-09-03 20:31:24,631 - INFO - Data extraction and movement completed.


2024-09-03 20:31:24,633 - INFO - ETL Step 1: Data extraction completed.


2024-09-03 20:31:24,635 - INFO - ETL Step 2: Transforming data.


2024-09-03 20:31:24,636 - INFO - Starting data transformation!!


2024-09-03 20:31:25,036 - INFO - dim_date data generated and saved!!


2024-09-03 20:31:25,089 - INFO - Transformed data saved to Dataset/Cleaned_payroll_Data/nycpayroll_2020.csv


2024-09-03 20:31:25,089 - INFO - ETL Step 2: Data transformation completed.


2024-09-03 20:31:25,090 - INFO - ETL Step 3: Loading data into Snowflake.


2024-09-03 20:31:25,564 - INFO - To route to workers diagnostics web server please install jupyter-server-proxy: python -m pip install jupyter-server-proxy


2024-09-03 20:31:25,598 - INFO - State start


2024-09-03 20:31:25,640 - INFO -   Scheduler at:     tcp://127.0.0.1:56811


2024-09-03 20:31:25,640 - INFO -   dashboard at:  http://127.0.0.1:8787/status


2024-09-03 20:31:25,642 - INFO - Registering Worker plugin shuffle


2024-09-03 20:31:25,684 - INFO -         Start Nanny at: 'tcp://127.0.0.1:56814'


2024-09-03 20:31:28,353 - INFO - Starting extract_files_from_adls function


2024-09-03 20:31:28,355 - INFO - Request URL: 'https://nycpayrollstorageaccount.blob.core.windows.net/nycpayrollcontainer?restype=REDACTED&comp=REDACTED&prefix=REDACTED'
Request method: 'GET'
Request headers:
    'x-ms-version': 'REDACTED'
    'Accept': 'application/xml'
    'User-Agent': 'azsdk-python-storage-blob/12.22.0 Python/3.12.4 (Windows-11-10.0.22631-SP0)'
    'x-ms-date': 'REDACTED'
    'x-ms-client-request-id': '1d8ab4bd-6a2b-11ef-afbf-f4a4751e46e5'
    'Authorization': 'REDACTED'
No body was attached to the request


2024-09-03 20:31:29,476 - INFO - Response status: 200
Response headers:
    'Transfer-Encoding': 'chunked'
    'Content-Type': 'application/xml'
    'Server': 'Windows-Azure-Blob/1.0 Microsoft-HTTPAPI/2.0'
    'x-ms-request-id': 'bb81c8d7-f01e-0062-7537-fe0ab8000000'
    'x-ms-client-request-id': '1d8ab4bd-6a2b-11ef-afbf-f4a4751e46e5'
    'x-ms-version': 'REDACTED'
    'Date': 'Tue, 03 Sep 2024 19:31:33 GMT'


2024-09-03 20:31:29,487 - INFO - Starting data transformation!!


2024-09-03 20:31:30,274 - INFO - dim_date data generated and saved!!


2024-09-03 20:31:30,324 - INFO - Transformed data saved to Dataset/Cleaned_payroll_Data/nycpayroll_2020.csv


2024-09-03 20:31:30,425 - INFO -       Start worker at:      tcp://127.0.0.1:56821


2024-09-03 20:31:30,426 - INFO -          Listening to:      tcp://127.0.0.1:56821


2024-09-03 20:31:30,427 - INFO -           Worker name:                          0


2024-09-03 20:31:30,428 - INFO -          dashboard at:            127.0.0.1:56822


2024-09-03 20:31:30,428 - INFO - Waiting to connect to:      tcp://127.0.0.1:56811


2024-09-03 20:31:30,429 - INFO - -------------------------------------------------


2024-09-03 20:31:30,429 - INFO -               Threads:                          4


2024-09-03 20:31:30,430 - INFO -                Memory:                  19.84 GiB


2024-09-03 20:31:30,431 - INFO -       Local Directory: C:\Users\oluwa\AppData\Local\Temp\dask-scratch-space\worker-q4e0ji97


2024-09-03 20:31:30,432 - INFO - -------------------------------------------------


2024-09-03 20:31:30,436 - INFO - Register worker <WorkerState 'tcp://127.0.0.1:56821', name: 0, status: init, memory: 0, processing: 0>


2024-09-03 20:31:30,439 - INFO - Starting worker compute stream, tcp://127.0.0.1:56821


2024-09-03 20:31:30,440 - INFO - Starting established connection to tcp://127.0.0.1:56823


2024-09-03 20:31:30,441 - INFO -         Registered to:      tcp://127.0.0.1:56811


2024-09-03 20:31:30,442 - INFO - -------------------------------------------------


2024-09-03 20:31:30,443 - INFO - Starting established connection to tcp://127.0.0.1:56811


2024-09-03 20:31:30,523 - INFO - Receive client connection: Client-1b98c43e-6a2b-11ef-a850-f4a4751e46e5


2024-09-03 20:31:30,524 - INFO - Starting established connection to tcp://127.0.0.1:56824


2024-09-03 20:31:30,525 - INFO - Dask client initialized with 1 worker.


2024-09-03 20:31:30,542 - INFO - Connected to Snowflake successfully.


2024-09-03 20:31:30,545 - INFO - Transformed NycPayroll CSV file loaded successfully.


2024-09-03 20:31:30,546 - INFO - Snowflake Connector for Python Version: 3.12.1, Python Version: 3.12.4, Platform: Windows-11-10.0.22631-SP0


2024-09-03 20:31:30,547 - INFO - Connecting to GLOBAL Snowflake domain


2024-09-03 20:31:30,548 - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.


2024-09-03 20:31:33,176 - INFO - Number of results in first chunk: 1


2024-09-03 20:31:34,134 - INFO - Number of results in first chunk: 1


2024-09-03 20:31:35,760 - INFO - Number of results in first chunk: 1


2024-09-03 20:31:35,763 - ERROR - Error loading data into Snowflake: (snowflake.connector.errors.ProgrammingError) 001003 (42000): 01b6ca33-0000-6762-0022-af0300019e5a: SQL compilation error:
syntax error line 1 at position 40 unexpected ')'.
[SQL: CREATE TABLE IF NOT EXISTS Dim_Employee();]
(Background on this error at: https://sqlalche.me/e/20/f405)


2024-09-03 20:31:35,766 - ERROR - ETL pipeline failed: (snowflake.connector.errors.ProgrammingError) 001003 (42000): 01b6ca33-0000-6762-0022-af0300019e5a: SQL compilation error:
syntax error line 1 at position 40 unexpected ')'.
[SQL: CREATE TABLE IF NOT EXISTS Dim_Employee();]
(Background on this error at: https://sqlalche.me/e/20/f405)


2024-09-03 20:31:35,800 - INFO - closed


2024-09-03 20:31:35,801 - INFO - No async queries seem to be running, deleting session


2024-09-03 20:31:36,101 - INFO - Retire worker addresses (0,)


2024-09-03 20:31:36,103 - INFO - Closing Nanny at 'tcp://127.0.0.1:56814'. Reason: nanny-close


2024-09-03 20:31:36,103 - INFO - Nanny asking worker to close. Reason: nanny-close


2024-09-03 20:31:36,105 - INFO - Stopping worker at tcp://127.0.0.1:56821. Reason: nanny-close


2024-09-03 20:31:36,106 - INFO - Removing Worker plugin shuffle


2024-09-03 20:31:36,110 - INFO - Received 'close-stream' from tcp://127.0.0.1:56823; closing.


2024-09-03 20:31:36,110 - INFO - Connection to tcp://127.0.0.1:56811 has been closed.


2024-09-03 20:31:36,111 - INFO - Remove worker <WorkerState 'tcp://127.0.0.1:56821', name: 0, status: closing, memory: 0, processing: 0> (stimulus_id='handle-worker-cleanup-1725391896.11115')


2024-09-03 20:31:36,112 - INFO - Lost all workers


2024-09-03 20:31:36,416 - INFO - Closing scheduler. Reason: unknown


2024-09-03 20:31:36,416 - INFO - Scheduler closing all comms


2024-09-03 23:13:58,484 - INFO - Starting extract_files_from_adls function


2024-09-03 23:13:58,488 - INFO - Request URL: 'https://nycpayrollstorageaccount.blob.core.windows.net/nycpayrollcontainer?restype=REDACTED&comp=REDACTED&prefix=REDACTED'
Request method: 'GET'
Request headers:
    'x-ms-version': 'REDACTED'
    'Accept': 'application/xml'
    'User-Agent': 'azsdk-python-storage-blob/12.22.0 Python/3.12.4 (Windows-11-10.0.22631-SP0)'
    'x-ms-date': 'REDACTED'
    'x-ms-client-request-id': 'd112e84b-6a41-11ef-8234-f4a4751e46e5'
    'Authorization': 'REDACTED'
No body was attached to the request


2024-09-03 23:14:00,084 - INFO - Response status: 200
Response headers:
    'Transfer-Encoding': 'chunked'
    'Content-Type': 'application/xml'
    'Server': 'Windows-Azure-Blob/1.0 Microsoft-HTTPAPI/2.0'
    'x-ms-request-id': '2ca4d991-001e-0049-684e-fe8a74000000'
    'x-ms-client-request-id': 'd112e84b-6a41-11ef-8234-f4a4751e46e5'
    'x-ms-version': 'REDACTED'
    'Date': 'Tue, 03 Sep 2024 22:14:04 GMT'


2024-09-03 23:14:00,104 - INFO - Starting data transformation!!


2024-09-03 23:14:03,069 - INFO - dim_date data generated and saved!!


2024-09-03 23:14:03,161 - INFO - Transformed data saved to Dataset/Cleaned_payroll_Data/nycpayroll_2020.csv


2024-09-03 23:14:03,187 - INFO - Starting ETL pipeline.


2024-09-03 23:14:03,191 - INFO - ETL Pipeline started.


2024-09-03 23:14:03,192 - INFO - ETL Step 1: Extracting data from ADLS.


2024-09-03 23:14:03,192 - INFO - Starting extract_files_from_adls function


2024-09-03 23:14:03,193 - INFO - Request URL: 'https://nycpayrollstorageaccount.blob.core.windows.net/nycpayrollcontainer?restype=REDACTED&comp=REDACTED&prefix=REDACTED'
Request method: 'GET'
Request headers:
    'x-ms-version': 'REDACTED'
    'Accept': 'application/xml'
    'User-Agent': 'azsdk-python-storage-blob/12.22.0 Python/3.12.4 (Windows-11-10.0.22631-SP0)'
    'x-ms-date': 'REDACTED'
    'x-ms-client-request-id': 'd3e11527-6a41-11ef-b758-f4a4751e46e5'
    'Authorization': 'REDACTED'
No body was attached to the request


2024-09-03 23:14:03,467 - INFO - Response status: 200
Response headers:
    'Transfer-Encoding': 'chunked'
    'Content-Type': 'application/xml'
    'Server': 'Windows-Azure-Blob/1.0 Microsoft-HTTPAPI/2.0'
    'x-ms-request-id': '2ca4ec30-001e-0049-474e-fe8a74000000'
    'x-ms-client-request-id': 'd3e11527-6a41-11ef-b758-f4a4751e46e5'
    'x-ms-version': 'REDACTED'
    'Date': 'Tue, 03 Sep 2024 22:14:07 GMT'


2024-09-03 23:14:03,470 - INFO - Data extraction and movement completed.


2024-09-03 23:14:03,471 - INFO - ETL Step 1: Data extraction completed.


2024-09-03 23:14:03,472 - INFO - ETL Step 2: Transforming data.


2024-09-03 23:14:03,473 - INFO - Starting data transformation!!


2024-09-03 23:14:04,197 - INFO - dim_date data generated and saved!!


2024-09-03 23:14:04,313 - INFO - Transformed data saved to Dataset/Cleaned_payroll_Data/nycpayroll_2020.csv


2024-09-03 23:14:04,315 - INFO - ETL Step 2: Data transformation completed.


2024-09-03 23:14:04,316 - INFO - ETL Step 3: Loading data into Snowflake.


2024-09-03 23:14:06,494 - INFO - To route to workers diagnostics web server please install jupyter-server-proxy: python -m pip install jupyter-server-proxy


2024-09-03 23:14:06,554 - INFO - State start


2024-09-03 23:14:06,607 - INFO -   Scheduler at:     tcp://127.0.0.1:55421


2024-09-03 23:14:06,607 - INFO -   dashboard at:  http://127.0.0.1:8787/status


2024-09-03 23:14:06,608 - INFO - Registering Worker plugin shuffle


2024-09-03 23:14:06,668 - INFO -         Start Nanny at: 'tcp://127.0.0.1:55424'


2024-09-03 23:14:10,888 - INFO - Starting extract_files_from_adls function


2024-09-03 23:14:10,890 - INFO - Request URL: 'https://nycpayrollstorageaccount.blob.core.windows.net/nycpayrollcontainer?restype=REDACTED&comp=REDACTED&prefix=REDACTED'
Request method: 'GET'
Request headers:
    'x-ms-version': 'REDACTED'
    'Accept': 'application/xml'
    'User-Agent': 'azsdk-python-storage-blob/12.22.0 Python/3.12.4 (Windows-11-10.0.22631-SP0)'
    'x-ms-date': 'REDACTED'
    'x-ms-client-request-id': 'd87756ff-6a41-11ef-8f12-f4a4751e46e5'
    'Authorization': 'REDACTED'
No body was attached to the request


2024-09-03 23:14:12,164 - INFO - Response status: 200
Response headers:
    'Transfer-Encoding': 'chunked'
    'Content-Type': 'application/xml'
    'Server': 'Windows-Azure-Blob/1.0 Microsoft-HTTPAPI/2.0'
    'x-ms-request-id': 'a64454f2-101e-0027-394e-fedf5b000000'
    'x-ms-client-request-id': 'd87756ff-6a41-11ef-8f12-f4a4751e46e5'
    'x-ms-version': 'REDACTED'
    'Date': 'Tue, 03 Sep 2024 22:14:16 GMT'


2024-09-03 23:14:12,167 - INFO - Starting data transformation!!


2024-09-03 23:14:13,553 - INFO - dim_date data generated and saved!!


2024-09-03 23:14:13,623 - INFO - Transformed data saved to Dataset/Cleaned_payroll_Data/nycpayroll_2020.csv


2024-09-03 23:14:13,788 - INFO -       Start worker at:      tcp://127.0.0.1:55431


2024-09-03 23:14:13,789 - INFO -          Listening to:      tcp://127.0.0.1:55431


2024-09-03 23:14:13,790 - INFO -           Worker name:                          0


2024-09-03 23:14:13,791 - INFO -          dashboard at:            127.0.0.1:55432


2024-09-03 23:14:13,793 - INFO - Waiting to connect to:      tcp://127.0.0.1:55421


2024-09-03 23:14:13,794 - INFO - -------------------------------------------------


2024-09-03 23:14:13,794 - INFO -               Threads:                          4


2024-09-03 23:14:13,799 - INFO -                Memory:                  19.84 GiB


2024-09-03 23:14:13,800 - INFO -       Local Directory: C:\Users\oluwa\AppData\Local\Temp\dask-scratch-space\worker-v37p046i


2024-09-03 23:14:13,803 - INFO - -------------------------------------------------


2024-09-03 23:14:13,814 - INFO - Register worker <WorkerState 'tcp://127.0.0.1:55431', name: 0, status: init, memory: 0, processing: 0>


2024-09-03 23:14:13,822 - INFO - Starting worker compute stream, tcp://127.0.0.1:55431


2024-09-03 23:14:13,823 - INFO - Starting Worker plugin shuffle


2024-09-03 23:14:13,823 - INFO - Starting established connection to tcp://127.0.0.1:55433


2024-09-03 23:14:13,826 - INFO -         Registered to:      tcp://127.0.0.1:55421


2024-09-03 23:14:13,827 - INFO - -------------------------------------------------


2024-09-03 23:14:13,837 - INFO - Starting established connection to tcp://127.0.0.1:55421


2024-09-03 23:14:13,878 - INFO - Receive client connection: Client-d48c6575-6a41-11ef-885c-f4a4751e46e5


2024-09-03 23:14:13,881 - INFO - Starting established connection to tcp://127.0.0.1:55434


2024-09-03 23:14:13,886 - INFO - Dask client initialized with 1 worker.


2024-09-03 23:14:13,928 - INFO - Connected to Snowflake successfully.


2024-09-03 23:14:13,938 - INFO - Transformed NycPayroll CSV file loaded successfully.


2024-09-03 23:14:13,941 - INFO - Snowflake Connector for Python Version: 3.12.1, Python Version: 3.12.4, Platform: Windows-11-10.0.22631-SP0


2024-09-03 23:14:13,942 - INFO - Connecting to GLOBAL Snowflake domain


2024-09-03 23:14:13,943 - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.


2024-09-03 23:14:17,783 - INFO - Number of results in first chunk: 1


2024-09-03 23:14:18,311 - INFO - Number of results in first chunk: 1


2024-09-03 23:14:19,274 - INFO - Number of results in first chunk: 1


2024-09-03 23:14:19,276 - ERROR - Error loading data into Snowflake: (snowflake.connector.errors.ProgrammingError) 002003 (42S02): 01b6cad6-0000-68ec-0022-af030002233a: SQL compilation error:
Table 'NYCPAYROLL_DWH.STG.DIM_EMPLOYEE' does not exist or not authorized.
[SQL: TRUNCATE TABLE Dim_Employee;]
(Background on this error at: https://sqlalche.me/e/20/f405)


2024-09-03 23:14:19,280 - ERROR - ETL pipeline failed: (snowflake.connector.errors.ProgrammingError) 002003 (42S02): 01b6cad6-0000-68ec-0022-af030002233a: SQL compilation error:
Table 'NYCPAYROLL_DWH.STG.DIM_EMPLOYEE' does not exist or not authorized.
[SQL: TRUNCATE TABLE Dim_Employee;]
(Background on this error at: https://sqlalche.me/e/20/f405)


2024-09-03 23:14:19,456 - INFO - closed


2024-09-03 23:14:19,458 - INFO - No async queries seem to be running, deleting session


2024-09-03 23:14:19,924 - INFO - Retire worker addresses (0,)


2024-09-03 23:14:19,933 - INFO - Closing Nanny at 'tcp://127.0.0.1:55424'. Reason: nanny-close


2024-09-03 23:14:19,936 - INFO - Nanny asking worker to close. Reason: nanny-close


2024-09-03 23:14:19,941 - INFO - Stopping worker at tcp://127.0.0.1:55431. Reason: nanny-close


2024-09-03 23:14:19,943 - INFO - Removing Worker plugin shuffle


2024-09-03 23:14:19,955 - INFO - Received 'close-stream' from tcp://127.0.0.1:55433; closing.


2024-09-03 23:14:19,956 - INFO - Connection to tcp://127.0.0.1:55421 has been closed.


2024-09-03 23:14:19,969 - INFO - Remove worker <WorkerState 'tcp://127.0.0.1:55431', name: 0, status: closing, memory: 0, processing: 0> (stimulus_id='handle-worker-cleanup-1725401659.961958')


2024-09-03 23:14:19,975 - INFO - Lost all workers


2024-09-03 23:14:20,496 - INFO - Closing scheduler. Reason: unknown


2024-09-03 23:14:20,498 - INFO - Scheduler closing all comms


2024-09-03 23:24:57,520 - INFO - Starting extract_files_from_adls function


2024-09-03 23:24:57,521 - INFO - Request URL: 'https://nycpayrollstorageaccount.blob.core.windows.net/nycpayrollcontainer?restype=REDACTED&comp=REDACTED&prefix=REDACTED'
Request method: 'GET'
Request headers:
    'x-ms-version': 'REDACTED'
    'Accept': 'application/xml'
    'User-Agent': 'azsdk-python-storage-blob/12.22.0 Python/3.12.4 (Windows-11-10.0.22631-SP0)'
    'x-ms-date': 'REDACTED'
    'x-ms-client-request-id': '59e38d79-6a43-11ef-9d72-f4a4751e46e5'
    'Authorization': 'REDACTED'
No body was attached to the request


2024-09-03 23:24:59,023 - INFO - Response status: 200
Response headers:
    'Transfer-Encoding': 'chunked'
    'Content-Type': 'application/xml'
    'Server': 'Windows-Azure-Blob/1.0 Microsoft-HTTPAPI/2.0'
    'x-ms-request-id': 'e4954adf-f01e-0072-2d50-fecfd0000000'
    'x-ms-client-request-id': '59e38d79-6a43-11ef-9d72-f4a4751e46e5'
    'x-ms-version': 'REDACTED'
    'Date': 'Tue, 03 Sep 2024 22:25:03 GMT'


2024-09-03 23:24:59,030 - INFO - Starting data transformation!!


2024-09-03 23:25:00,971 - INFO - dim_date data generated and saved!!


2024-09-03 23:25:01,095 - INFO - Transformed data saved to Dataset/Cleaned_payroll_Data/nycpayroll_2020.csv


2024-09-03 23:25:01,122 - INFO - Starting ETL pipeline.


2024-09-03 23:25:01,128 - INFO - ETL Pipeline started.


2024-09-03 23:25:01,130 - INFO - ETL Step 1: Extracting data from ADLS.


2024-09-03 23:25:01,132 - INFO - Starting extract_files_from_adls function


2024-09-03 23:25:01,135 - INFO - Request URL: 'https://nycpayrollstorageaccount.blob.core.windows.net/nycpayrollcontainer?restype=REDACTED&comp=REDACTED&prefix=REDACTED'
Request method: 'GET'
Request headers:
    'x-ms-version': 'REDACTED'
    'Accept': 'application/xml'
    'User-Agent': 'azsdk-python-storage-blob/12.22.0 Python/3.12.4 (Windows-11-10.0.22631-SP0)'
    'x-ms-date': 'REDACTED'
    'x-ms-client-request-id': '5c0af05f-6a43-11ef-ad80-f4a4751e46e5'
    'Authorization': 'REDACTED'
No body was attached to the request


2024-09-03 23:25:01,480 - INFO - Response status: 200
Response headers:
    'Transfer-Encoding': 'chunked'
    'Content-Type': 'application/xml'
    'Server': 'Windows-Azure-Blob/1.0 Microsoft-HTTPAPI/2.0'
    'x-ms-request-id': 'e49554df-f01e-0072-2050-fecfd0000000'
    'x-ms-client-request-id': '5c0af05f-6a43-11ef-ad80-f4a4751e46e5'
    'x-ms-version': 'REDACTED'
    'Date': 'Tue, 03 Sep 2024 22:25:05 GMT'


2024-09-03 23:25:01,485 - INFO - Data extraction and movement completed.


2024-09-03 23:25:01,486 - INFO - ETL Step 1: Data extraction completed.


2024-09-03 23:25:01,488 - INFO - ETL Step 2: Transforming data.


2024-09-03 23:25:01,489 - INFO - Starting data transformation!!


2024-09-03 23:25:02,292 - INFO - dim_date data generated and saved!!


2024-09-03 23:25:02,422 - INFO - Transformed data saved to Dataset/Cleaned_payroll_Data/nycpayroll_2020.csv


2024-09-03 23:25:02,423 - INFO - ETL Step 2: Data transformation completed.


2024-09-03 23:25:02,424 - INFO - ETL Step 3: Loading data into Snowflake.


2024-09-03 23:25:03,706 - INFO - To route to workers diagnostics web server please install jupyter-server-proxy: python -m pip install jupyter-server-proxy


2024-09-03 23:25:03,804 - INFO - State start


2024-09-03 23:25:03,896 - INFO -   Scheduler at:     tcp://127.0.0.1:55485


2024-09-03 23:25:03,898 - INFO -   dashboard at:  http://127.0.0.1:8787/status


2024-09-03 23:25:03,899 - INFO - Registering Worker plugin shuffle


2024-09-03 23:25:03,953 - INFO -         Start Nanny at: 'tcp://127.0.0.1:55488'


2024-09-03 23:25:08,059 - INFO - Starting extract_files_from_adls function


2024-09-03 23:25:08,062 - INFO - Request URL: 'https://nycpayrollstorageaccount.blob.core.windows.net/nycpayrollcontainer?restype=REDACTED&comp=REDACTED&prefix=REDACTED'
Request method: 'GET'
Request headers:
    'x-ms-version': 'REDACTED'
    'Accept': 'application/xml'
    'User-Agent': 'azsdk-python-storage-blob/12.22.0 Python/3.12.4 (Windows-11-10.0.22631-SP0)'
    'x-ms-date': 'REDACTED'
    'x-ms-client-request-id': '602be478-6a43-11ef-83b0-f4a4751e46e5'
    'Authorization': 'REDACTED'
No body was attached to the request


2024-09-03 23:25:09,264 - INFO - Response status: 200
Response headers:
    'Transfer-Encoding': 'chunked'
    'Content-Type': 'application/xml'
    'Server': 'Windows-Azure-Blob/1.0 Microsoft-HTTPAPI/2.0'
    'x-ms-request-id': '494912f3-601e-0002-7f50-fe7627000000'
    'x-ms-client-request-id': '602be478-6a43-11ef-83b0-f4a4751e46e5'
    'x-ms-version': 'REDACTED'
    'Date': 'Tue, 03 Sep 2024 22:25:13 GMT'


2024-09-03 23:25:09,272 - INFO - Starting data transformation!!


2024-09-03 23:25:10,906 - INFO - dim_date data generated and saved!!


2024-09-03 23:25:10,981 - INFO - Transformed data saved to Dataset/Cleaned_payroll_Data/nycpayroll_2020.csv


2024-09-03 23:25:11,138 - INFO -       Start worker at:      tcp://127.0.0.1:55495


2024-09-03 23:25:11,140 - INFO -          Listening to:      tcp://127.0.0.1:55495


2024-09-03 23:25:11,140 - INFO -           Worker name:                          0


2024-09-03 23:25:11,142 - INFO -          dashboard at:            127.0.0.1:55496


2024-09-03 23:25:11,142 - INFO - Waiting to connect to:      tcp://127.0.0.1:55485


2024-09-03 23:25:11,145 - INFO - -------------------------------------------------


2024-09-03 23:25:11,148 - INFO -               Threads:                          4


2024-09-03 23:25:11,149 - INFO -                Memory:                  19.84 GiB


2024-09-03 23:25:11,152 - INFO -       Local Directory: C:\Users\oluwa\AppData\Local\Temp\dask-scratch-space\worker-drar2vg4


2024-09-03 23:25:11,155 - INFO - -------------------------------------------------


2024-09-03 23:25:11,175 - INFO - Register worker <WorkerState 'tcp://127.0.0.1:55495', name: 0, status: init, memory: 0, processing: 0>


2024-09-03 23:25:11,188 - INFO - Starting worker compute stream, tcp://127.0.0.1:55495


2024-09-03 23:25:11,189 - INFO - Starting established connection to tcp://127.0.0.1:55497


2024-09-03 23:25:11,191 - INFO -         Registered to:      tcp://127.0.0.1:55485


2024-09-03 23:25:11,192 - INFO - -------------------------------------------------


2024-09-03 23:25:11,203 - INFO - Starting established connection to tcp://127.0.0.1:55485


2024-09-03 23:25:11,246 - INFO - Receive client connection: Client-5ccfa90c-6a43-11ef-a37c-f4a4751e46e5


2024-09-03 23:25:11,248 - INFO - Starting established connection to tcp://127.0.0.1:55498


2024-09-03 23:25:11,253 - INFO - Dask client initialized with 1 worker.


2024-09-03 23:25:11,303 - INFO - Connected to Snowflake successfully.


2024-09-03 23:25:11,310 - INFO - Transformed NycPayroll CSV file loaded successfully.


2024-09-03 23:25:11,312 - INFO - Snowflake Connector for Python Version: 3.12.1, Python Version: 3.12.4, Platform: Windows-11-10.0.22631-SP0


2024-09-03 23:25:11,314 - INFO - Connecting to GLOBAL Snowflake domain


2024-09-03 23:25:11,315 - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.


2024-09-03 23:25:15,001 - INFO - Number of results in first chunk: 1


2024-09-03 23:25:16,273 - INFO - Number of results in first chunk: 1


2024-09-03 23:25:22,637 - INFO - Number of results in first chunk: 1


2024-09-03 23:25:26,034 - INFO - Number of results in first chunk: 1


2024-09-03 23:25:26,036 - INFO - Truncated and created Dim_Employee successfully.


2024-09-03 23:25:30,296 - INFO - Number of results in first chunk: 1


2024-09-03 23:25:30,299 - ERROR - Error loading data into Snowflake: (snowflake.connector.errors.ProgrammingError) 001003 (42000): 01b6cae1-0000-6762-0022-af0300019e6a: SQL compilation error:
syntax error line 1 at position 27 unexpected '{'.
syntax error line 1 at position 439 unexpected ')'.
[SQL: CREATE TABLE IF NOT EXISTS {'name': 'Dim_Employee', 'columns': [{'name': 'EmployeeID', 'type': 'INT'}, {'name': 'LastName', 'type': 'VARCHAR(50)'}, {'name': 'FirstName', 'type': 'VARCHAR(50)'}, {'name': 'AgencyStartDate', 'type': 'DATE'}, {'name': 'TitleCode', 'type': 'INT'}, {'name': 'TitleDescription', 'type': 'TEXT'}, {'name': 'WorkLocationBorough', 'type': 'VARCHAR(255)'}, {'name': 'LeaveStatusasofJune30', 'type': 'VARCHAR(50)'}]}();]
(Background on this error at: https://sqlalche.me/e/20/f405)


2024-09-03 23:25:30,303 - ERROR - ETL pipeline failed: (snowflake.connector.errors.ProgrammingError) 001003 (42000): 01b6cae1-0000-6762-0022-af0300019e6a: SQL compilation error:
syntax error line 1 at position 27 unexpected '{'.
syntax error line 1 at position 439 unexpected ')'.
[SQL: CREATE TABLE IF NOT EXISTS {'name': 'Dim_Employee', 'columns': [{'name': 'EmployeeID', 'type': 'INT'}, {'name': 'LastName', 'type': 'VARCHAR(50)'}, {'name': 'FirstName', 'type': 'VARCHAR(50)'}, {'name': 'AgencyStartDate', 'type': 'DATE'}, {'name': 'TitleCode', 'type': 'INT'}, {'name': 'TitleDescription', 'type': 'TEXT'}, {'name': 'WorkLocationBorough', 'type': 'VARCHAR(255)'}, {'name': 'LeaveStatusasofJune30', 'type': 'VARCHAR(50)'}]}();]
(Background on this error at: https://sqlalche.me/e/20/f405)


2024-09-03 23:25:30,453 - INFO - closed


2024-09-03 23:25:30,454 - INFO - No async queries seem to be running, deleting session


2024-09-03 23:25:30,790 - INFO - Retire worker addresses (0,)


2024-09-03 23:25:30,796 - INFO - Closing Nanny at 'tcp://127.0.0.1:55488'. Reason: nanny-close


2024-09-03 23:25:30,798 - INFO - Nanny asking worker to close. Reason: nanny-close


2024-09-03 23:25:30,803 - INFO - Stopping worker at tcp://127.0.0.1:55495. Reason: nanny-close


2024-09-03 23:25:30,806 - INFO - Removing Worker plugin shuffle


2024-09-03 23:25:30,818 - INFO - Received 'close-stream' from tcp://127.0.0.1:55497; closing.


2024-09-03 23:25:30,818 - INFO - Connection to tcp://127.0.0.1:55485 has been closed.


2024-09-03 23:25:30,829 - INFO - Remove worker <WorkerState 'tcp://127.0.0.1:55495', name: 0, status: closing, memory: 0, processing: 0> (stimulus_id='handle-worker-cleanup-1725402330.8257434')


2024-09-03 23:25:30,838 - INFO - Lost all workers


2024-09-03 23:25:31,422 - INFO - Closing scheduler. Reason: unknown


2024-09-03 23:25:31,424 - INFO - Scheduler closing all comms


2024-09-03 23:41:05,507 - INFO - Starting extract_files_from_adls function


2024-09-03 23:41:05,519 - INFO - Request URL: 'https://nycpayrollstorageaccount.blob.core.windows.net/nycpayrollcontainer?restype=REDACTED&comp=REDACTED&prefix=REDACTED'
Request method: 'GET'
Request headers:
    'x-ms-version': 'REDACTED'
    'Accept': 'application/xml'
    'User-Agent': 'azsdk-python-storage-blob/12.22.0 Python/3.12.4 (Windows-11-10.0.22631-SP0)'
    'x-ms-date': 'REDACTED'
    'x-ms-client-request-id': '9adba1f7-6a45-11ef-93ab-f4a4751e46e5'
    'Authorization': 'REDACTED'
No body was attached to the request


2024-09-03 23:41:06,902 - INFO - Response status: 200
Response headers:
    'Transfer-Encoding': 'chunked'
    'Content-Type': 'application/xml'
    'Server': 'Windows-Azure-Blob/1.0 Microsoft-HTTPAPI/2.0'
    'x-ms-request-id': 'e5a2f268-401e-0058-4752-fe10c0000000'
    'x-ms-client-request-id': '9adba1f7-6a45-11ef-93ab-f4a4751e46e5'
    'x-ms-version': 'REDACTED'
    'Date': 'Tue, 03 Sep 2024 22:41:10 GMT'


2024-09-03 23:41:06,910 - INFO - Starting data transformation!!


2024-09-03 23:41:08,758 - INFO - dim_date data generated and saved!!


2024-09-03 23:41:08,872 - INFO - Transformed data saved to Dataset/Cleaned_payroll_Data/nycpayroll_2020.csv


2024-09-03 23:41:08,889 - INFO - Starting ETL pipeline.


2024-09-03 23:41:08,893 - INFO - ETL Pipeline started.


2024-09-03 23:41:08,894 - INFO - ETL Step 1: Extracting data from ADLS.


2024-09-03 23:41:08,895 - INFO - Starting extract_files_from_adls function


2024-09-03 23:41:08,897 - INFO - Request URL: 'https://nycpayrollstorageaccount.blob.core.windows.net/nycpayrollcontainer?restype=REDACTED&comp=REDACTED&prefix=REDACTED'
Request method: 'GET'
Request headers:
    'x-ms-version': 'REDACTED'
    'Accept': 'application/xml'
    'User-Agent': 'azsdk-python-storage-blob/12.22.0 Python/3.12.4 (Windows-11-10.0.22631-SP0)'
    'x-ms-date': 'REDACTED'
    'x-ms-client-request-id': '9cdfb910-6a45-11ef-bfdb-f4a4751e46e5'
    'Authorization': 'REDACTED'
No body was attached to the request


2024-09-03 23:41:09,256 - INFO - Response status: 200
Response headers:
    'Transfer-Encoding': 'chunked'
    'Content-Type': 'application/xml'
    'Server': 'Windows-Azure-Blob/1.0 Microsoft-HTTPAPI/2.0'
    'x-ms-request-id': 'e5a2fa51-401e-0058-3252-fe10c0000000'
    'x-ms-client-request-id': '9cdfb910-6a45-11ef-bfdb-f4a4751e46e5'
    'x-ms-version': 'REDACTED'
    'Date': 'Tue, 03 Sep 2024 22:41:13 GMT'


2024-09-03 23:41:09,262 - INFO - Data extraction and movement completed.


2024-09-03 23:41:09,264 - INFO - ETL Step 1: Data extraction completed.


2024-09-03 23:41:09,267 - INFO - ETL Step 2: Transforming data.


2024-09-03 23:41:09,268 - INFO - Starting data transformation!!


2024-09-03 23:41:10,312 - INFO - dim_date data generated and saved!!


2024-09-03 23:41:10,449 - INFO - Transformed data saved to Dataset/Cleaned_payroll_Data/nycpayroll_2020.csv


2024-09-03 23:41:10,450 - INFO - ETL Step 2: Data transformation completed.


2024-09-03 23:41:10,451 - INFO - ETL Step 3: Loading data into Snowflake.


2024-09-03 23:41:11,803 - INFO - To route to workers diagnostics web server please install jupyter-server-proxy: python -m pip install jupyter-server-proxy


2024-09-03 23:41:11,921 - INFO - State start


2024-09-03 23:41:11,969 - INFO -   Scheduler at:     tcp://127.0.0.1:64026


2024-09-03 23:41:11,969 - INFO -   dashboard at:  http://127.0.0.1:8787/status


2024-09-03 23:41:11,970 - INFO - Registering Worker plugin shuffle


2024-09-03 23:41:12,034 - INFO -         Start Nanny at: 'tcp://127.0.0.1:64029'


2024-09-03 23:41:16,198 - INFO - Starting extract_files_from_adls function


2024-09-03 23:41:16,201 - INFO - Request URL: 'https://nycpayrollstorageaccount.blob.core.windows.net/nycpayrollcontainer?restype=REDACTED&comp=REDACTED&prefix=REDACTED'
Request method: 'GET'
Request headers:
    'x-ms-version': 'REDACTED'
    'Accept': 'application/xml'
    'User-Agent': 'azsdk-python-storage-blob/12.22.0 Python/3.12.4 (Windows-11-10.0.22631-SP0)'
    'x-ms-date': 'REDACTED'
    'x-ms-client-request-id': 'a13a04d4-6a45-11ef-bff6-f4a4751e46e5'
    'Authorization': 'REDACTED'
No body was attached to the request


2024-09-03 23:41:17,148 - INFO - Response status: 200
Response headers:
    'Transfer-Encoding': 'chunked'
    'Content-Type': 'application/xml'
    'Server': 'Windows-Azure-Blob/1.0 Microsoft-HTTPAPI/2.0'
    'x-ms-request-id': '2284c06b-e01e-0041-8052-fe907b000000'
    'x-ms-client-request-id': 'a13a04d4-6a45-11ef-bff6-f4a4751e46e5'
    'x-ms-version': 'REDACTED'
    'Date': 'Tue, 03 Sep 2024 22:41:21 GMT'


2024-09-03 23:41:17,159 - INFO - Starting data transformation!!


2024-09-03 23:41:19,102 - INFO - dim_date data generated and saved!!


2024-09-03 23:41:19,186 - INFO - Transformed data saved to Dataset/Cleaned_payroll_Data/nycpayroll_2020.csv


2024-09-03 23:41:19,341 - INFO -       Start worker at:      tcp://127.0.0.1:64037


2024-09-03 23:41:19,343 - INFO -          Listening to:      tcp://127.0.0.1:64037


2024-09-03 23:41:19,345 - INFO -           Worker name:                          0


2024-09-03 23:41:19,346 - INFO -          dashboard at:            127.0.0.1:64038


2024-09-03 23:41:19,347 - INFO - Waiting to connect to:      tcp://127.0.0.1:64026


2024-09-03 23:41:19,347 - INFO - -------------------------------------------------


2024-09-03 23:41:19,348 - INFO -               Threads:                          4


2024-09-03 23:41:19,349 - INFO -                Memory:                  19.84 GiB


2024-09-03 23:41:19,350 - INFO -       Local Directory: C:\Users\oluwa\AppData\Local\Temp\dask-scratch-space\worker-zghxgefb


2024-09-03 23:41:19,351 - INFO - -------------------------------------------------


2024-09-03 23:41:19,365 - INFO - Register worker <WorkerState 'tcp://127.0.0.1:64037', name: 0, status: init, memory: 0, processing: 0>


2024-09-03 23:41:19,369 - INFO - Starting worker compute stream, tcp://127.0.0.1:64037


2024-09-03 23:41:19,370 - INFO - Starting established connection to tcp://127.0.0.1:64039


2024-09-03 23:41:19,372 - INFO -         Registered to:      tcp://127.0.0.1:64026


2024-09-03 23:41:19,373 - INFO - -------------------------------------------------


2024-09-03 23:41:19,375 - INFO - Starting established connection to tcp://127.0.0.1:64026


2024-09-03 23:41:19,445 - INFO - Receive client connection: Client-9dcd07db-6a45-11ef-9f08-f4a4751e46e5


2024-09-03 23:41:19,447 - INFO - Starting established connection to tcp://127.0.0.1:64040


2024-09-03 23:41:19,449 - INFO - Dask client initialized with 1 worker.


2024-09-03 23:41:19,531 - INFO - Connected to Snowflake successfully.


2024-09-03 23:41:19,537 - INFO - Transformed NycPayroll CSV file loaded successfully.


2024-09-03 23:41:19,539 - INFO - Snowflake Connector for Python Version: 3.12.1, Python Version: 3.12.4, Platform: Windows-11-10.0.22631-SP0


2024-09-03 23:41:19,541 - INFO - Connecting to GLOBAL Snowflake domain


2024-09-03 23:41:19,542 - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.


2024-09-03 23:41:24,033 - INFO - Number of results in first chunk: 1


2024-09-03 23:41:24,932 - INFO - Number of results in first chunk: 1


2024-09-03 23:41:25,543 - INFO - Number of results in first chunk: 1


2024-09-03 23:41:25,546 - INFO - Table Dim_Employee created or already exists.


2024-09-03 23:41:28,202 - INFO - Number of results in first chunk: 1


2024-09-03 23:41:28,205 - INFO - Table Dim_Agency created or already exists.


2024-09-03 23:41:31,786 - INFO - Number of results in first chunk: 1


2024-09-03 23:41:31,789 - INFO - Table Dim_PayBasis created or already exists.


2024-09-03 23:41:33,441 - INFO - Number of results in first chunk: 1


2024-09-03 23:41:33,443 - INFO - Table Dim_Date created or already exists.


2024-09-03 23:41:34,245 - INFO - Number of results in first chunk: 1


2024-09-03 23:41:34,247 - INFO - Table FactPayroll created or already exists.


2024-09-03 23:41:35,884 - INFO - Number of results in first chunk: 1


2024-09-03 23:41:35,886 - INFO - Truncated Dim_Employee successfully.


2024-09-03 23:41:40,903 - INFO - Number of results in first chunk: 1


2024-09-03 23:41:40,905 - INFO - Truncated Dim_Agency successfully.


2024-09-03 23:41:41,626 - INFO - Number of results in first chunk: 1


2024-09-03 23:41:41,629 - INFO - Truncated Dim_PayBasis successfully.


2024-09-03 23:41:44,486 - INFO - Number of results in first chunk: 1


2024-09-03 23:41:44,487 - INFO - Truncated Dim_Date successfully.


2024-09-03 23:41:46,544 - INFO - Number of results in first chunk: 1


2024-09-03 23:41:46,548 - INFO - Truncated FactPayroll successfully.


2024-09-03 23:41:47,543 - INFO - Number of results in first chunk: 8


2024-09-03 23:41:47,904 - INFO - Number of results in first chunk: 8


2024-09-03 23:41:50,336 - INFO - Number of results in first chunk: 11


2024-09-03 23:41:50,718 - INFO - Number of results in first chunk: 0


2024-09-03 23:41:51,099 - INFO - Number of results in first chunk: 1


2024-09-03 23:41:57,396 - INFO - Number of results in first chunk: 1


2024-09-03 23:42:02,382 - INFO - Number of results in first chunk: 64


2024-09-03 23:42:03,544 - INFO - Number of results in first chunk: 0


2024-09-03 23:42:04,360 - INFO - Number of results in first chunk: 0


2024-09-03 23:42:05,487 - INFO - Number of results in first chunk: 2


2024-09-03 23:42:09,679 - INFO - Number of results in first chunk: 1


2024-09-03 23:42:11,534 - INFO - Number of results in first chunk: 1


2024-09-03 23:42:16,136 - INFO - Number of results in first chunk: 11


2024-09-03 23:42:16,142 - INFO - Dim_Employee data loaded successfully!!


2024-09-03 23:42:16,743 - INFO - Number of results in first chunk: 2


2024-09-03 23:42:19,199 - INFO - Number of results in first chunk: 2


2024-09-03 23:42:19,633 - INFO - Number of results in first chunk: 11


2024-09-03 23:42:20,037 - INFO - Number of results in first chunk: 0


2024-09-03 23:42:20,488 - INFO - Number of results in first chunk: 1


2024-09-03 23:42:20,998 - INFO - Number of results in first chunk: 1


2024-09-03 23:42:24,121 - INFO - Number of results in first chunk: 64


2024-09-03 23:42:25,939 - INFO - Number of results in first chunk: 0


2024-09-03 23:42:26,263 - INFO - Number of results in first chunk: 0


2024-09-03 23:42:27,045 - INFO - Number of results in first chunk: 2


2024-09-03 23:42:29,421 - INFO - Number of results in first chunk: 1


2024-09-03 23:42:31,546 - INFO - Number of results in first chunk: 1


2024-09-03 23:42:34,871 - INFO - Number of results in first chunk: 11


2024-09-03 23:42:34,877 - INFO - Dim_Agency data loaded successfully!!


2024-09-03 23:42:35,500 - INFO - Number of results in first chunk: 2


2024-09-03 23:42:35,893 - INFO - Number of results in first chunk: 2


2024-09-03 23:42:36,816 - INFO - Number of results in first chunk: 11


2024-09-03 23:42:37,483 - INFO - Number of results in first chunk: 0


2024-09-03 23:42:38,359 - INFO - Number of results in first chunk: 1


2024-09-03 23:42:41,841 - INFO - Number of results in first chunk: 1


2024-09-03 23:42:45,037 - INFO - Number of results in first chunk: 64


2024-09-03 23:42:49,043 - INFO - Number of results in first chunk: 0


2024-09-03 23:42:49,406 - INFO - Number of results in first chunk: 0


2024-09-03 23:42:50,236 - INFO - Number of results in first chunk: 2


2024-09-03 23:42:51,861 - INFO - Number of results in first chunk: 1


2024-09-03 23:42:52,578 - INFO - Number of results in first chunk: 1


2024-09-03 23:42:53,829 - INFO - Number of results in first chunk: 11


2024-09-03 23:42:53,833 - INFO - Dim_PayBasis data loaded successfully!!


2024-09-03 23:42:54,175 - INFO - Number of results in first chunk: 6


2024-09-03 23:42:54,935 - INFO - Number of results in first chunk: 6


2024-09-03 23:42:55,756 - INFO - Number of results in first chunk: 11


2024-09-03 23:42:56,575 - INFO - Number of results in first chunk: 0


2024-09-03 23:42:56,892 - INFO - Number of results in first chunk: 1


2024-09-03 23:42:58,214 - INFO - Number of results in first chunk: 1


2024-09-03 23:43:01,050 - INFO - Number of results in first chunk: 64


2024-09-03 23:43:01,393 - INFO - Number of results in first chunk: 0


2024-09-03 23:43:01,898 - INFO - Number of results in first chunk: 0


2024-09-03 23:43:03,472 - INFO - Number of results in first chunk: 2


2024-09-03 23:43:04,665 - INFO - Number of results in first chunk: 1


2024-09-03 23:43:08,038 - INFO - Number of results in first chunk: 1


2024-09-03 23:43:08,874 - INFO - Number of results in first chunk: 11


2024-09-03 23:43:08,877 - INFO - Dim_Date data loaded successfully.


2024-09-03 23:43:18,392 - INFO - Number of results in first chunk: 1


2024-09-03 23:43:24,042 - INFO - Number of results in first chunk: 12


2024-09-03 23:43:24,045 - INFO - FactPayroll data loaded successfully!!


2024-09-03 23:43:24,047 - INFO - All data loaded successfully!!


2024-09-03 23:43:25,480 - INFO - Number of results in first chunk: 1


2024-09-03 23:43:25,547 - INFO - Remove client Client-9dcd07db-6a45-11ef-9f08-f4a4751e46e5


2024-09-03 23:43:25,555 - INFO - Received 'close-stream' from tcp://127.0.0.1:64040; closing.


2024-09-03 23:43:25,581 - INFO - Remove client Client-9dcd07db-6a45-11ef-9f08-f4a4751e46e5


2024-09-03 23:43:25,595 - INFO - Close client connection: Client-9dcd07db-6a45-11ef-9f08-f4a4751e46e5


2024-09-03 23:43:25,608 - INFO - Retire worker addresses (0,)


2024-09-03 23:43:25,618 - INFO - Closing Nanny at 'tcp://127.0.0.1:64029'. Reason: nanny-close


2024-09-03 23:43:25,632 - INFO - Nanny asking worker to close. Reason: nanny-close


2024-09-03 23:43:25,643 - INFO - Stopping worker at tcp://127.0.0.1:64037. Reason: nanny-close


2024-09-03 23:43:25,646 - INFO - Removing Worker plugin shuffle


2024-09-03 23:43:25,658 - INFO - Connection to tcp://127.0.0.1:64026 has been closed.


2024-09-03 23:43:25,658 - INFO - Received 'close-stream' from tcp://127.0.0.1:64039; closing.


2024-09-03 23:43:25,663 - INFO - Remove worker <WorkerState 'tcp://127.0.0.1:64037', name: 0, status: closing, memory: 0, processing: 0> (stimulus_id='handle-worker-cleanup-1725403405.663754')


2024-09-03 23:43:25,665 - INFO - Lost all workers


2024-09-03 23:43:26,137 - INFO - Closing scheduler. Reason: unknown


2024-09-03 23:43:26,139 - INFO - Scheduler closing all comms


2024-09-03 23:43:26,147 - INFO - Dask client closed.


2024-09-03 23:43:26,150 - INFO - ETL Step 3: Data loading completed.


2024-09-03 23:43:26,151 - INFO - ETL pipeline completed successfully.


2024-09-03 23:43:26,154 - INFO - closed


2024-09-03 23:43:26,156 - INFO - No async queries seem to be running, deleting session


2024-09-04 13:31:05,218 - INFO - Starting extract_files_from_adls function


2024-09-04 13:31:05,221 - INFO - Request URL: 'https://nycpayrollstorageaccount.blob.core.windows.net/nycpayrollcontainer?restype=REDACTED&comp=REDACTED&prefix=REDACTED'
Request method: 'GET'
Request headers:
    'x-ms-version': 'REDACTED'
    'Accept': 'application/xml'
    'User-Agent': 'azsdk-python-storage-blob/12.22.0 Python/3.12.4 (Windows-11-10.0.22631-SP0)'
    'x-ms-date': 'REDACTED'
    'x-ms-client-request-id': '8dcb7e9b-6ab9-11ef-aab7-f4a4751e46e5'
    'Authorization': 'REDACTED'
No body was attached to the request


2024-09-04 13:31:06,848 - INFO - Response status: 200
Response headers:
    'Transfer-Encoding': 'chunked'
    'Content-Type': 'application/xml'
    'Server': 'Windows-Azure-Blob/1.0 Microsoft-HTTPAPI/2.0'
    'x-ms-request-id': 'e3f09797-201e-003c-3bc6-fee158000000'
    'x-ms-client-request-id': '8dcb7e9b-6ab9-11ef-aab7-f4a4751e46e5'
    'x-ms-version': 'REDACTED'
    'Date': 'Wed, 04 Sep 2024 12:31:06 GMT'


2024-09-04 13:31:06,875 - INFO - Starting data transformation!!


2024-09-04 13:31:08,455 - INFO - dim_date data generated and saved!!


2024-09-04 13:31:08,525 - INFO - Transformed data saved to Dataset/Cleaned_payroll_Data/nycpayroll_2020.csv


2024-09-04 13:31:08,541 - INFO - Starting ETL pipeline.


2024-09-04 13:31:08,544 - INFO - ETL Pipeline started.


2024-09-04 13:31:08,545 - INFO - ETL Step 1: Extracting data from ADLS.


2024-09-04 13:31:08,545 - INFO - Starting extract_files_from_adls function


2024-09-04 13:31:08,546 - INFO - Request URL: 'https://nycpayrollstorageaccount.blob.core.windows.net/nycpayrollcontainer?restype=REDACTED&comp=REDACTED&prefix=REDACTED'
Request method: 'GET'
Request headers:
    'x-ms-version': 'REDACTED'
    'Accept': 'application/xml'
    'User-Agent': 'azsdk-python-storage-blob/12.22.0 Python/3.12.4 (Windows-11-10.0.22631-SP0)'
    'x-ms-date': 'REDACTED'
    'x-ms-client-request-id': '8fc739f8-6ab9-11ef-9dbe-f4a4751e46e5'
    'Authorization': 'REDACTED'
No body was attached to the request


2024-09-04 13:31:08,895 - INFO - Response status: 200
Response headers:
    'Transfer-Encoding': 'chunked'
    'Content-Type': 'application/xml'
    'Server': 'Windows-Azure-Blob/1.0 Microsoft-HTTPAPI/2.0'
    'x-ms-request-id': 'e3f09f8f-201e-003c-1bc6-fee158000000'
    'x-ms-client-request-id': '8fc739f8-6ab9-11ef-9dbe-f4a4751e46e5'
    'x-ms-version': 'REDACTED'
    'Date': 'Wed, 04 Sep 2024 12:31:08 GMT'


2024-09-04 13:31:08,899 - INFO - Data extraction and movement completed.


2024-09-04 13:31:08,900 - INFO - ETL Step 1: Data extraction completed.


2024-09-04 13:31:08,901 - INFO - ETL Step 2: Transforming data.


2024-09-04 13:31:08,902 - INFO - Starting data transformation!!


2024-09-04 13:31:09,669 - INFO - dim_date data generated and saved!!


2024-09-04 13:31:09,723 - INFO - Transformed data saved to Dataset/Cleaned_payroll_Data/nycpayroll_2020.csv


2024-09-04 13:31:09,723 - INFO - ETL Step 2: Data transformation completed.


2024-09-04 13:31:09,725 - INFO - ETL Step 3: Loading data into Snowflake.


2024-09-04 13:31:10,793 - INFO - To route to workers diagnostics web server please install jupyter-server-proxy: python -m pip install jupyter-server-proxy


2024-09-04 13:31:10,830 - INFO - State start


2024-09-04 13:31:10,874 - INFO -   Scheduler at:     tcp://127.0.0.1:54468


2024-09-04 13:31:10,875 - INFO -   dashboard at:  http://127.0.0.1:8787/status


2024-09-04 13:31:10,876 - INFO - Registering Worker plugin shuffle


2024-09-04 13:31:10,934 - INFO -         Start Nanny at: 'tcp://127.0.0.1:54471'


2024-09-04 13:31:14,340 - INFO - Starting extract_files_from_adls function


2024-09-04 13:31:14,342 - INFO - Request URL: 'https://nycpayrollstorageaccount.blob.core.windows.net/nycpayrollcontainer?restype=REDACTED&comp=REDACTED&prefix=REDACTED'
Request method: 'GET'
Request headers:
    'x-ms-version': 'REDACTED'
    'Accept': 'application/xml'
    'User-Agent': 'azsdk-python-storage-blob/12.22.0 Python/3.12.4 (Windows-11-10.0.22631-SP0)'
    'x-ms-date': 'REDACTED'
    'x-ms-client-request-id': '933b7e57-6ab9-11ef-8e3b-f4a4751e46e5'
    'Authorization': 'REDACTED'
No body was attached to the request


2024-09-04 13:31:20,193 - INFO - Response status: 200
Response headers:
    'Transfer-Encoding': 'chunked'
    'Content-Type': 'application/xml'
    'Server': 'Windows-Azure-Blob/1.0 Microsoft-HTTPAPI/2.0'
    'x-ms-request-id': '8a77b9f2-601e-005f-22c6-fe7ca3000000'
    'x-ms-client-request-id': '933b7e57-6ab9-11ef-8e3b-f4a4751e46e5'
    'x-ms-version': 'REDACTED'
    'Date': 'Wed, 04 Sep 2024 12:31:19 GMT'


2024-09-04 13:31:20,196 - INFO - Starting data transformation!!


2024-09-04 13:31:21,200 - INFO - dim_date data generated and saved!!


2024-09-04 13:31:21,258 - INFO - Transformed data saved to Dataset/Cleaned_payroll_Data/nycpayroll_2020.csv


2024-09-04 13:31:21,435 - INFO -       Start worker at:      tcp://127.0.0.1:54478


2024-09-04 13:31:21,436 - INFO -          Listening to:      tcp://127.0.0.1:54478


2024-09-04 13:31:21,437 - INFO -           Worker name:                          0


2024-09-04 13:31:21,438 - INFO -          dashboard at:            127.0.0.1:54479


2024-09-04 13:31:21,439 - INFO - Waiting to connect to:      tcp://127.0.0.1:54468


2024-09-04 13:31:21,440 - INFO - -------------------------------------------------


2024-09-04 13:31:21,441 - INFO -               Threads:                          4


2024-09-04 13:31:21,442 - INFO -                Memory:                  19.84 GiB


2024-09-04 13:31:21,443 - INFO -       Local Directory: C:\Users\oluwa\AppData\Local\Temp\dask-scratch-space\worker-d41ujwax


2024-09-04 13:31:21,445 - INFO - -------------------------------------------------


2024-09-04 13:31:21,466 - INFO - Register worker <WorkerState 'tcp://127.0.0.1:54478', name: 0, status: init, memory: 0, processing: 0>


2024-09-04 13:31:21,474 - INFO - Starting worker compute stream, tcp://127.0.0.1:54478


2024-09-04 13:31:21,475 - INFO - Starting Worker plugin shuffle


cp://127.0.0.1:54480


2024-09-04 13:31:21,479 - INFO -         Registered to:      tcp://127.0.0.1:54468


2024-09-04 13:31:21,480 - INFO - -------------------------------------------------


2024-09-04 13:31:21,489 - INFO - Starting established connection to tcp://127.0.0.1:54468


2024-09-04 13:31:21,523 - INFO - Receive client connection: Client-907b0ae1-6ab9-11ef-986c-f4a4751e46e5


2024-09-04 13:31:21,525 - INFO - Starting established connection to tcp://127.0.0.1:54481


2024-09-04 13:31:21,528 - INFO - Dask client initialized with 1 worker.


2024-09-04 13:31:21,576 - INFO - Connected to Snowflake successfully.


2024-09-04 13:31:21,587 - INFO - Transformed NycPayroll CSV file loaded successfully.


2024-09-04 13:31:21,589 - INFO - Snowflake Connector for Python Version: 3.12.1, Python Version: 3.12.4, Platform: Windows-11-10.0.22631-SP0


2024-09-04 13:31:21,590 - INFO - Connecting to GLOBAL Snowflake domain


2024-09-04 13:31:21,592 - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.


2024-09-04 13:32:48,750 - INFO - Number of results in first chunk: 1


2024-09-04 13:32:49,155 - INFO - Number of results in first chunk: 1


2024-09-04 13:32:49,674 - INFO - Number of results in first chunk: 1


2024-09-04 13:32:49,677 - INFO - Table "Dim_Employee" created or already exists.


2024-09-04 13:32:50,073 - INFO - Number of results in first chunk: 1


2024-09-04 13:32:50,074 - INFO - Table "Dim_Agency" created or already exists.


2024-09-04 13:32:50,585 - INFO - Number of results in first chunk: 1


2024-09-04 13:32:50,586 - INFO - Table "Dim_PayBasis" created or already exists.


2024-09-04 13:32:51,447 - INFO - Number of results in first chunk: 1


2024-09-04 13:32:51,448 - INFO - Table "Dim_Date" created or already exists.


2024-09-04 13:32:53,087 - INFO - Number of results in first chunk: 1


2024-09-04 13:32:53,089 - INFO - Table "FactPayroll" created or already exists.


2024-09-04 13:32:55,045 - INFO - Number of results in first chunk: 1


2024-09-04 13:32:55,045 - INFO - Truncated "Dim_Employee" successfully.


2024-09-04 13:32:55,701 - INFO - Number of results in first chunk: 1


2024-09-04 13:32:55,702 - INFO - Truncated "Dim_Agency" successfully.


2024-09-04 13:32:56,312 - INFO - Number of results in first chunk: 1


2024-09-04 13:32:56,313 - INFO - Truncated "Dim_PayBasis" successfully.


2024-09-04 13:32:56,756 - INFO - Number of results in first chunk: 1


2024-09-04 13:32:56,757 - INFO - Truncated "Dim_Date" successfully.


2024-09-04 13:32:57,255 - INFO - Number of results in first chunk: 1


2024-09-04 13:32:57,256 - INFO - Truncated "FactPayroll" successfully.


2024-09-04 13:32:57,745 - INFO - Number of results in first chunk: 8


2024-09-04 13:32:58,162 - INFO - Number of results in first chunk: 8


2024-09-04 13:32:59,016 - INFO - Number of results in first chunk: 7


2024-09-04 13:33:01,030 - INFO - Number of results in first chunk: 0


2024-09-04 13:33:02,865 - INFO - Number of results in first chunk: 1


2024-09-04 13:33:03,367 - INFO - Number of results in first chunk: 5


2024-09-04 13:33:05,530 - INFO - Number of results in first chunk: 46


2024-09-04 13:33:05,922 - INFO - Number of results in first chunk: 4


2024-09-04 13:33:06,655 - INFO - Number of results in first chunk: 1


2024-09-04 13:33:07,064 - INFO - Number of results in first chunk: 1


2024-09-04 13:33:07,985 - INFO - Number of results in first chunk: 1


2024-09-04 13:33:08,426 - INFO - Number of results in first chunk: 1


2024-09-04 13:33:09,840 - INFO - Number of results in first chunk: 7


2024-09-04 13:33:09,841 - INFO - Dim_Employee data loaded successfully!!


2024-09-04 13:33:10,426 - INFO - Number of results in first chunk: 2


2024-09-04 13:33:10,755 - INFO - Number of results in first chunk: 2


2024-09-04 13:33:11,438 - INFO - Number of results in first chunk: 7


2024-09-04 13:33:12,084 - INFO - Number of results in first chunk: 0


2024-09-04 13:33:12,802 - INFO - Number of results in first chunk: 1


2024-09-04 13:33:13,925 - INFO - Number of results in first chunk: 4


2024-09-04 13:33:15,187 - INFO - Number of results in first chunk: 46


2024-09-04 13:33:15,778 - INFO - Number of results in first chunk: 3


2024-09-04 13:33:16,183 - INFO - Number of results in first chunk: 1


2024-09-04 13:33:16,553 - INFO - Number of results in first chunk: 1


2024-09-04 13:33:17,116 - INFO - Number of results in first chunk: 1


2024-09-04 13:33:17,643 - INFO - Number of results in first chunk: 1


2024-09-04 13:33:19,052 - INFO - Number of results in first chunk: 7


2024-09-04 13:33:19,053 - INFO - Dim_Agency data loaded successfully!!


2024-09-04 13:33:19,358 - INFO - Number of results in first chunk: 2


2024-09-04 13:33:19,933 - INFO - Number of results in first chunk: 2


2024-09-04 13:33:20,246 - INFO - Number of results in first chunk: 7


2024-09-04 13:33:20,581 - INFO - Number of results in first chunk: 0


2024-09-04 13:33:21,708 - INFO - Number of results in first chunk: 1


2024-09-04 13:33:22,191 - INFO - Number of results in first chunk: 3


2024-09-04 13:33:23,584 - INFO - Number of results in first chunk: 46


2024-09-04 13:33:23,918 - INFO - Number of results in first chunk: 2


2024-09-04 13:33:24,282 - INFO - Number of results in first chunk: 1


2024-09-04 13:33:24,684 - INFO - Number of results in first chunk: 1


2024-09-04 13:33:25,175 - INFO - Number of results in first chunk: 1


2024-09-04 13:33:25,609 - INFO - Number of results in first chunk: 1


2024-09-04 13:33:26,534 - INFO - Number of results in first chunk: 7


2024-09-04 13:33:26,535 - INFO - Dim_PayBasis data loaded successfully!!


2024-09-04 13:33:26,830 - INFO - Number of results in first chunk: 6


2024-09-04 13:33:27,450 - INFO - Number of results in first chunk: 6


2024-09-04 13:33:28,067 - INFO - Number of results in first chunk: 7


2024-09-04 13:33:28,645 - INFO - Number of results in first chunk: 0


2024-09-04 13:33:29,002 - INFO - Number of results in first chunk: 1


2024-09-04 13:33:30,112 - INFO - Number of results in first chunk: 2


2024-09-04 13:33:31,350 - INFO - Number of results in first chunk: 46


2024-09-04 13:33:31,952 - INFO - Number of results in first chunk: 1


2024-09-04 13:33:32,781 - INFO - Number of results in first chunk: 1


2024-09-04 13:33:33,193 - INFO - Number of results in first chunk: 1


2024-09-04 13:33:33,794 - INFO - Number of results in first chunk: 1


2024-09-04 13:33:34,450 - INFO - Number of results in first chunk: 1


2024-09-04 13:33:35,860 - INFO - Number of results in first chunk: 7


2024-09-04 13:33:35,862 - INFO - Dim_Date data loaded successfully.


2024-09-04 13:33:36,285 - INFO - Number of results in first chunk: 13


2024-09-04 13:33:36,866 - INFO - Number of results in first chunk: 13


2024-09-04 13:33:37,908 - INFO - Number of results in first chunk: 7


2024-09-04 13:33:38,330 - INFO - Number of results in first chunk: 0


2024-09-04 13:33:38,968 - INFO - Number of results in first chunk: 1


2024-09-04 13:33:39,694 - INFO - Number of results in first chunk: 1


2024-09-04 13:33:47,712 - INFO - Number of results in first chunk: 46


2024-09-04 13:33:48,432 - INFO - Number of results in first chunk: 0


2024-09-04 13:33:54,121 - INFO - Number of results in first chunk: 0


2024-09-04 13:34:04,527 - INFO - Number of results in first chunk: 1


2024-09-04 13:34:11,281 - INFO - Number of results in first chunk: 1


2024-09-04 13:34:19,768 - INFO - Number of results in first chunk: 1


2024-09-04 13:34:51,233 - INFO - Number of results in first chunk: 7


2024-09-04 13:34:51,234 - INFO - FactPayroll data loaded successfully!!


2024-09-04 13:34:51,234 - INFO - All data loaded successfully!!


2024-09-04 13:34:53,206 - INFO - Number of results in first chunk: 1


2024-09-04 13:34:53,209 - INFO - Remove client Client-907b0ae1-6ab9-11ef-986c-f4a4751e46e5


2024-09-04 13:34:53,210 - INFO - Received 'close-stream' from tcp://127.0.0.1:54481; closing.


2024-09-04 13:34:53,211 - INFO - Remove client Client-907b0ae1-6ab9-11ef-986c-f4a4751e46e5


2024-09-04 13:34:53,212 - INFO - Close client connection: Client-907b0ae1-6ab9-11ef-986c-f4a4751e46e5


2024-09-04 13:34:53,214 - INFO - Retire worker addresses (0,)


2024-09-04 13:34:53,216 - INFO - Closing Nanny at 'tcp://127.0.0.1:54471'. Reason: nanny-close


2024-09-04 13:34:53,217 - INFO - Nanny asking worker to close. Reason: nanny-close


2024-09-04 13:34:53,218 - INFO - Stopping worker at tcp://127.0.0.1:54478. Reason: nanny-close


2024-09-04 13:34:53,220 - INFO - Removing Worker plugin shuffle


2024-09-04 13:34:53,224 - INFO - Received 'close-stream' from tcp://127.0.0.1:54480; closing.


2024-09-04 13:34:53,224 - INFO - Connection to tcp://127.0.0.1:54468 has been closed.


2024-09-04 13:34:53,225 - INFO - Remove worker <WorkerState 'tcp://127.0.0.1:54478', name: 0, status: closing, memory: 0, processing: 0> (stimulus_id='handle-worker-cleanup-1725453293.2258606')


2024-09-04 13:34:53,227 - INFO - Lost all workers


2024-09-04 13:34:53,721 - INFO - Closing scheduler. Reason: unknown


2024-09-04 13:34:53,722 - INFO - Scheduler closing all comms


2024-09-04 13:34:53,725 - INFO - Dask client closed.


2024-09-04 13:34:53,727 - INFO - ETL Step 3: Data loading completed.


2024-09-04 13:34:53,728 - INFO - Connected to Snowflake successfully.


2024-09-04 13:34:53,729 - INFO - Snowflake Connector for Python Version: 3.12.1, Python Version: 3.12.4, Platform: Windows-11-10.0.22631-SP0


2024-09-04 13:34:53,733 - INFO - Connecting to GLOBAL Snowflake domain


2024-09-04 13:34:53,734 - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.


2024-09-04 13:35:01,143 - INFO - Number of results in first chunk: 1


2024-09-04 13:35:03,640 - INFO - Number of results in first chunk: 1


2024-09-04 13:35:15,303 - INFO - Number of results in first chunk: 1


2024-09-04 13:35:15,303 - ERROR - ETL pipeline failed: (snowflake.connector.errors.ProgrammingError) 090232 (25000): 01b6ce33-0000-68c9-0022-af030002361e: Stored procedure execution error: Scoped transaction started in stored procedure is incomplete and it was rolled back.
[SQL: CALL "STG".PAYROLL_AGGREGATES();]
(Background on this error at: https://sqlalche.me/e/20/f405)


2024-09-04 13:35:15,431 - INFO - closed


2024-09-04 13:35:15,433 - INFO - No async queries seem to be running, deleting session


2024-09-04 13:35:16,440 - INFO - closed


2024-09-04 13:35:16,441 - INFO - No async queries seem to be running, deleting session


2024-09-04 14:11:55,207 - INFO - Starting extract_files_from_adls function


2024-09-04 14:11:55,210 - INFO - Request URL: 'https://nycpayrollstorageaccount.blob.core.windows.net/nycpayrollcontainer?restype=REDACTED&comp=REDACTED&prefix=REDACTED'
Request method: 'GET'
Request headers:
    'x-ms-version': 'REDACTED'
    'Accept': 'application/xml'
    'User-Agent': 'azsdk-python-storage-blob/12.22.0 Python/3.12.4 (Windows-11-10.0.22631-SP0)'
    'x-ms-date': 'REDACTED'
    'x-ms-client-request-id': '421a485a-6abf-11ef-a0bf-f4a4751e46e5'
    'Authorization': 'REDACTED'
No body was attached to the request


2024-09-04 14:11:56,671 - INFO - Response status: 200
Response headers:
    'Transfer-Encoding': 'chunked'
    'Content-Type': 'application/xml'
    'Server': 'Windows-Azure-Blob/1.0 Microsoft-HTTPAPI/2.0'
    'x-ms-request-id': 'cef58a0c-c01e-0069-6bcc-fef1d3000000'
    'x-ms-client-request-id': '421a485a-6abf-11ef-a0bf-f4a4751e46e5'
    'x-ms-version': 'REDACTED'
    'Date': 'Wed, 04 Sep 2024 13:11:56 GMT'


2024-09-04 14:11:56,678 - INFO - Starting data transformation!!


2024-09-04 14:11:58,665 - INFO - dim_date data generated and saved!!


2024-09-04 14:11:58,739 - INFO - Transformed data saved to Dataset/Cleaned_payroll_Data/nycpayroll_2020.csv


2024-09-04 14:11:58,744 - INFO - Starting ETL pipeline.


2024-09-04 14:11:58,748 - INFO - ETL Pipeline started.


2024-09-04 14:11:58,749 - INFO - ETL Step 1: Extracting data from ADLS.


2024-09-04 14:11:58,749 - INFO - Starting extract_files_from_adls function


2024-09-04 14:11:58,750 - INFO - Request URL: 'https://nycpayrollstorageaccount.blob.core.windows.net/nycpayrollcontainer?restype=REDACTED&comp=REDACTED&prefix=REDACTED'
Request method: 'GET'
Request headers:
    'x-ms-version': 'REDACTED'
    'Accept': 'application/xml'
    'User-Agent': 'azsdk-python-storage-blob/12.22.0 Python/3.12.4 (Windows-11-10.0.22631-SP0)'
    'x-ms-date': 'REDACTED'
    'x-ms-client-request-id': '4436a3b3-6abf-11ef-bf5b-f4a4751e46e5'
    'Authorization': 'REDACTED'
No body was attached to the request


2024-09-04 14:11:59,128 - INFO - Response status: 200
Response headers:
    'Transfer-Encoding': 'chunked'
    'Content-Type': 'application/xml'
    'Server': 'Windows-Azure-Blob/1.0 Microsoft-HTTPAPI/2.0'
    'x-ms-request-id': 'cef59541-c01e-0069-32cc-fef1d3000000'
    'x-ms-client-request-id': '4436a3b3-6abf-11ef-bf5b-f4a4751e46e5'
    'x-ms-version': 'REDACTED'
    'Date': 'Wed, 04 Sep 2024 13:11:58 GMT'


2024-09-04 14:11:59,134 - INFO - Data extraction and movement completed.


2024-09-04 14:11:59,138 - INFO - ETL Step 1: Data extraction completed.


2024-09-04 14:11:59,140 - INFO - ETL Step 2: Transforming data.


2024-09-04 14:11:59,142 - INFO - Starting data transformation!!


2024-09-04 14:12:00,194 - INFO - dim_date data generated and saved!!


2024-09-04 14:12:00,333 - INFO - Transformed data saved to Dataset/Cleaned_payroll_Data/nycpayroll_2020.csv


2024-09-04 14:12:00,333 - INFO - ETL Step 2: Data transformation completed.


2024-09-04 14:12:00,334 - INFO - ETL Step 3: Loading data into Snowflake.


2024-09-04 14:12:01,738 - INFO - To route to workers diagnostics web server please install jupyter-server-proxy: python -m pip install jupyter-server-proxy


2024-09-04 14:12:01,798 - INFO - State start


2024-09-04 14:12:01,865 - INFO -   Scheduler at:     tcp://127.0.0.1:63401


2024-09-04 14:12:01,866 - INFO -   dashboard at:  http://127.0.0.1:8787/status


2024-09-04 14:12:01,868 - INFO - Registering Worker plugin shuffle


2024-09-04 14:12:01,938 - INFO -         Start Nanny at: 'tcp://127.0.0.1:63404'


2024-09-04 14:12:06,776 - INFO - Starting extract_files_from_adls function


2024-09-04 14:12:06,780 - INFO - Request URL: 'https://nycpayrollstorageaccount.blob.core.windows.net/nycpayrollcontainer?restype=REDACTED&comp=REDACTED&prefix=REDACTED'
Request method: 'GET'
Request headers:
    'x-ms-version': 'REDACTED'
    'Accept': 'application/xml'
    'User-Agent': 'azsdk-python-storage-blob/12.22.0 Python/3.12.4 (Windows-11-10.0.22631-SP0)'
    'x-ms-date': 'REDACTED'
    'x-ms-client-request-id': '48ffae70-6abf-11ef-ab0b-f4a4751e46e5'
    'Authorization': 'REDACTED'
No body was attached to the request


2024-09-04 14:12:07,945 - INFO - Response status: 200
Response headers:
    'Transfer-Encoding': 'chunked'
    'Content-Type': 'application/xml'
    'Server': 'Windows-Azure-Blob/1.0 Microsoft-HTTPAPI/2.0'
    'x-ms-request-id': '11fe2951-901e-0006-6dcc-fefb20000000'
    'x-ms-client-request-id': '48ffae70-6abf-11ef-ab0b-f4a4751e46e5'
    'x-ms-version': 'REDACTED'
    'Date': 'Wed, 04 Sep 2024 13:12:07 GMT'


2024-09-04 14:12:07,955 - INFO - Starting data transformation!!


2024-09-04 14:12:09,674 - INFO - dim_date data generated and saved!!


2024-09-04 14:12:09,746 - INFO - Transformed data saved to Dataset/Cleaned_payroll_Data/nycpayroll_2020.csv


2024-09-04 14:12:09,911 - INFO -       Start worker at:      tcp://127.0.0.1:63414


2024-09-04 14:12:09,913 - INFO -          Listening to:      tcp://127.0.0.1:63414


2024-09-04 14:12:09,914 - INFO -           Worker name:                          0


2024-09-04 14:12:09,915 - INFO -          dashboard at:            127.0.0.1:63415


2024-09-04 14:12:09,916 - INFO - Waiting to connect to:      tcp://127.0.0.1:63401


2024-09-04 14:12:09,917 - INFO - -------------------------------------------------


2024-09-04 14:12:09,919 - INFO -               Threads:                          4


2024-09-04 14:12:09,920 - INFO -                Memory:                  19.84 GiB


2024-09-04 14:12:09,921 - INFO -       Local Directory: C:\Users\oluwa\AppData\Local\Temp\dask-scratch-space\worker-vxqj62og


2024-09-04 14:12:09,923 - INFO - -------------------------------------------------


2024-09-04 14:12:09,935 - INFO - Register worker <WorkerState 'tcp://127.0.0.1:63414', name: 0, status: init, memory: 0, processing: 0>


2024-09-04 14:12:09,943 - INFO - Starting worker compute stream, tcp://127.0.0.1:63414


2024-09-04 14:12:09,945 - INFO - Starting Worker plugin shuffle


cp://127.0.0.1:63416


2024-09-04 14:12:09,948 - INFO -         Registered to:      tcp://127.0.0.1:63401


2024-09-04 14:12:09,949 - INFO - -------------------------------------------------


2024-09-04 14:12:09,959 - INFO - Starting established connection to tcp://127.0.0.1:63401


2024-09-04 14:12:09,977 - INFO - Receive client connection: Client-45288215-6abf-11ef-8d4c-f4a4751e46e5


2024-09-04 14:12:09,978 - INFO - Starting established connection to tcp://127.0.0.1:63417


2024-09-04 14:12:09,982 - INFO - Dask client initialized with 1 worker.


2024-09-04 14:12:10,025 - INFO - Connected to Snowflake successfully.


2024-09-04 14:12:10,031 - INFO - Transformed NycPayroll CSV file loaded successfully.


2024-09-04 14:12:10,033 - INFO - Snowflake Connector for Python Version: 3.12.1, Python Version: 3.12.4, Platform: Windows-11-10.0.22631-SP0


2024-09-04 14:12:10,036 - INFO - Connecting to GLOBAL Snowflake domain


2024-09-04 14:12:10,038 - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.


2024-09-04 14:12:14,047 - INFO - Number of results in first chunk: 1


2024-09-04 14:12:15,204 - INFO - Number of results in first chunk: 1


2024-09-04 14:12:16,046 - INFO - Number of results in first chunk: 1


2024-09-04 14:12:16,052 - INFO - Table "Dim_Employee" created or already exists.


2024-09-04 14:12:16,450 - INFO - Number of results in first chunk: 1


2024-09-04 14:12:16,455 - INFO - Table "Dim_Agency" created or already exists.


2024-09-04 14:12:17,149 - INFO - Number of results in first chunk: 1


2024-09-04 14:12:17,153 - INFO - Table "Dim_PayBasis" created or already exists.


2024-09-04 14:12:17,555 - INFO - Number of results in first chunk: 1


2024-09-04 14:12:17,556 - INFO - Table "Dim_Date" created or already exists.


2024-09-04 14:12:18,679 - INFO - Number of results in first chunk: 1


2024-09-04 14:12:18,682 - INFO - Table "FactPayroll" created or already exists.


2024-09-04 14:12:19,298 - INFO - Number of results in first chunk: 1


2024-09-04 14:12:19,302 - INFO - Truncated "Dim_Employee" successfully.


2024-09-04 14:12:19,972 - INFO - Number of results in first chunk: 1


2024-09-04 14:12:20,061 - INFO - Truncated "Dim_Agency" successfully.


2024-09-04 14:12:23,191 - INFO - Number of results in first chunk: 1


2024-09-04 14:12:23,192 - INFO - Truncated "Dim_PayBasis" successfully.


2024-09-04 14:12:23,930 - INFO - Number of results in first chunk: 1


2024-09-04 14:12:23,932 - INFO - Truncated "Dim_Date" successfully.


2024-09-04 14:12:24,725 - INFO - Number of results in first chunk: 1


2024-09-04 14:12:24,728 - INFO - Truncated "FactPayroll" successfully.


2024-09-04 14:12:25,244 - INFO - Number of results in first chunk: 8


2024-09-04 14:12:25,643 - INFO - Number of results in first chunk: 8


2024-09-04 14:12:26,269 - INFO - Number of results in first chunk: 7


2024-09-04 14:12:28,308 - INFO - Number of results in first chunk: 0


2024-09-04 14:12:29,844 - INFO - Number of results in first chunk: 1


2024-09-04 14:12:31,178 - INFO - Number of results in first chunk: 1


2024-09-04 14:12:33,530 - INFO - Number of results in first chunk: 46


2024-09-04 14:12:34,016 - INFO - Number of results in first chunk: 0


2024-09-04 14:12:34,456 - INFO - Number of results in first chunk: 0


2024-09-04 14:12:34,962 - INFO - Number of results in first chunk: 1


2024-09-04 14:12:38,255 - INFO - Number of results in first chunk: 1


2024-09-04 14:12:40,423 - INFO - Number of results in first chunk: 1


2024-09-04 14:12:42,850 - INFO - Number of results in first chunk: 7


2024-09-04 14:12:42,853 - INFO - Dim_Employee data loaded successfully!!


2024-09-04 14:12:44,016 - INFO - Number of results in first chunk: 2


2024-09-04 14:12:44,795 - INFO - Number of results in first chunk: 2


2024-09-04 14:12:45,445 - INFO - Number of results in first chunk: 7


2024-09-04 14:12:46,341 - INFO - Number of results in first chunk: 0


2024-09-04 14:12:46,738 - INFO - Number of results in first chunk: 1


2024-09-04 14:12:47,150 - INFO - Number of results in first chunk: 1


2024-09-04 14:12:48,822 - INFO - Number of results in first chunk: 46


2024-09-04 14:12:49,196 - INFO - Number of results in first chunk: 0


2024-09-04 14:12:49,667 - INFO - Number of results in first chunk: 0


2024-09-04 14:12:50,736 - INFO - Number of results in first chunk: 1


2024-09-04 14:12:51,961 - INFO - Number of results in first chunk: 1


2024-09-04 14:12:53,601 - INFO - Number of results in first chunk: 1


2024-09-04 14:12:54,941 - INFO - Number of results in first chunk: 7


2024-09-04 14:12:54,945 - INFO - Dim_Agency data loaded successfully!!


2024-09-04 14:12:55,443 - INFO - Number of results in first chunk: 2


2024-09-04 14:12:55,755 - INFO - Number of results in first chunk: 2


2024-09-04 14:12:56,544 - INFO - Number of results in first chunk: 7


2024-09-04 14:12:57,035 - INFO - Number of results in first chunk: 0


2024-09-04 14:12:59,044 - INFO - Number of results in first chunk: 1


2024-09-04 14:12:59,844 - INFO - Number of results in first chunk: 1


2024-09-04 14:13:01,589 - INFO - Number of results in first chunk: 46


2024-09-04 14:13:02,448 - INFO - Number of results in first chunk: 0


2024-09-04 14:13:03,784 - INFO - Number of results in first chunk: 0


2024-09-04 14:13:04,134 - INFO - Number of results in first chunk: 1


2024-09-04 14:13:04,569 - INFO - Number of results in first chunk: 1


2024-09-04 14:13:05,275 - INFO - Number of results in first chunk: 1


2024-09-04 14:13:06,547 - INFO - Number of results in first chunk: 7


2024-09-04 14:13:06,551 - INFO - Dim_PayBasis data loaded successfully!!


2024-09-04 14:13:06,914 - INFO - Number of results in first chunk: 6


2024-09-04 14:13:07,219 - INFO - Number of results in first chunk: 6


2024-09-04 14:13:07,628 - INFO - Number of results in first chunk: 7


2024-09-04 14:13:09,060 - INFO - Number of results in first chunk: 0


2024-09-04 14:13:09,485 - INFO - Number of results in first chunk: 1


2024-09-04 14:13:09,881 - INFO - Number of results in first chunk: 1


2024-09-04 14:13:11,728 - INFO - Number of results in first chunk: 46


2024-09-04 14:13:12,134 - INFO - Number of results in first chunk: 0


2024-09-04 14:13:12,550 - INFO - Number of results in first chunk: 0


2024-09-04 14:13:13,158 - INFO - Number of results in first chunk: 1


2024-09-04 14:13:14,095 - INFO - Number of results in first chunk: 1


2024-09-04 14:13:14,558 - INFO - Number of results in first chunk: 1


2024-09-04 14:13:17,561 - INFO - Number of results in first chunk: 7


2024-09-04 14:13:17,564 - INFO - Dim_Date data loaded successfully.


2024-09-04 14:13:18,071 - INFO - Number of results in first chunk: 13


2024-09-04 14:13:18,535 - INFO - Number of results in first chunk: 13


2024-09-04 14:13:19,100 - INFO - Number of results in first chunk: 7


2024-09-04 14:13:19,922 - INFO - Number of results in first chunk: 0


2024-09-04 14:13:20,324 - INFO - Number of results in first chunk: 1


2024-09-04 14:13:20,736 - INFO - Number of results in first chunk: 1


2024-09-04 14:13:22,068 - INFO - Number of results in first chunk: 46


2024-09-04 14:13:22,510 - INFO - Number of results in first chunk: 0


2024-09-04 14:13:22,942 - INFO - Number of results in first chunk: 0


2024-09-04 14:13:23,439 - INFO - Number of results in first chunk: 1


2024-09-04 14:13:24,052 - INFO - Number of results in first chunk: 1


2024-09-04 14:13:24,625 - INFO - Number of results in first chunk: 1


2024-09-04 14:13:25,643 - INFO - Number of results in first chunk: 7


2024-09-04 14:13:25,649 - INFO - FactPayroll data loaded successfully!!


2024-09-04 14:13:25,651 - INFO - All data loaded successfully!!


2024-09-04 14:13:26,095 - INFO - Number of results in first chunk: 1


2024-09-04 14:13:26,104 - INFO - Remove client Client-45288215-6abf-11ef-8d4c-f4a4751e46e5


2024-09-04 14:13:26,106 - INFO - Received 'close-stream' from tcp://127.0.0.1:63417; closing.


2024-09-04 14:13:26,109 - INFO - Remove client Client-45288215-6abf-11ef-8d4c-f4a4751e46e5


2024-09-04 14:13:26,115 - INFO - Close client connection: Client-45288215-6abf-11ef-8d4c-f4a4751e46e5


2024-09-04 14:13:26,121 - INFO - Retire worker addresses (0,)


2024-09-04 14:13:26,127 - INFO - Closing Nanny at 'tcp://127.0.0.1:63404'. Reason: nanny-close


2024-09-04 14:13:26,130 - INFO - Nanny asking worker to close. Reason: nanny-close


2024-09-04 14:13:26,139 - INFO - Stopping worker at tcp://127.0.0.1:63414. Reason: nanny-close


2024-09-04 14:13:26,143 - INFO - Removing Worker plugin shuffle


2024-09-04 14:13:26,153 - INFO - Received 'close-stream' from tcp://127.0.0.1:63416; closing.


2024-09-04 14:13:26,155 - INFO - Connection to tcp://127.0.0.1:63401 has been closed.


2024-09-04 14:13:26,160 - INFO - Remove worker <WorkerState 'tcp://127.0.0.1:63414', name: 0, status: closing, memory: 0, processing: 0> (stimulus_id='handle-worker-cleanup-1725455606.1600616')


2024-09-04 14:13:26,171 - INFO - Lost all workers


2024-09-04 14:13:26,889 - INFO - Closing scheduler. Reason: unknown


2024-09-04 14:13:26,891 - INFO - Scheduler closing all comms


2024-09-04 14:13:26,902 - INFO - Dask client closed.


2024-09-04 14:13:26,904 - INFO - ETL Step 3: Data loading completed.


2024-09-04 14:13:26,907 - INFO - Connected to Snowflake successfully.


2024-09-04 14:13:26,910 - INFO - Snowflake Connector for Python Version: 3.12.1, Python Version: 3.12.4, Platform: Windows-11-10.0.22631-SP0


2024-09-04 14:13:26,912 - INFO - Connecting to GLOBAL Snowflake domain


2024-09-04 14:13:26,914 - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.


2024-09-04 14:13:31,291 - INFO - Number of results in first chunk: 1


2024-09-04 14:13:31,689 - INFO - Number of results in first chunk: 1


2024-09-04 14:13:33,226 - INFO - Number of results in first chunk: 1


2024-09-04 14:13:33,229 - ERROR - ETL pipeline failed: (snowflake.connector.errors.ProgrammingError) 090232 (25000): 01b6ce59-0000-6ad0-0022-af030002705e: Stored procedure execution error: Scoped transaction started in stored procedure is incomplete and it was rolled back.
[SQL: CALL "STG".PAYROLL_AGGREGATES();]
(Background on this error at: https://sqlalche.me/e/20/f405)


2024-09-04 14:13:33,409 - INFO - closed


2024-09-04 14:13:33,410 - INFO - No async queries seem to be running, deleting session


2024-09-04 14:13:33,740 - INFO - closed


2024-09-04 14:13:33,741 - INFO - No async queries seem to be running, deleting session


2024-09-05 00:02:30,586 - INFO - Starting extract_files_from_adls function


2024-09-05 00:02:30,592 - INFO - Request URL: 'https://nycpayrollstorageaccount.blob.core.windows.net/nycpayrollcontainer?restype=REDACTED&comp=REDACTED&prefix=REDACTED'
Request method: 'GET'
Request headers:
    'x-ms-version': 'REDACTED'
    'Accept': 'application/xml'
    'User-Agent': 'azsdk-python-storage-blob/12.22.0 Python/3.12.4 (Windows-11-10.0.22631-SP0)'
    'x-ms-date': 'REDACTED'
    'x-ms-client-request-id': 'c33c52fc-6b11-11ef-a0c3-f4a4751e46e5'
    'Authorization': 'REDACTED'
No body was attached to the request


2024-09-05 00:02:32,152 - INFO - Response status: 200
Response headers:
    'Transfer-Encoding': 'chunked'
    'Content-Type': 'application/xml'
    'Server': 'Windows-Azure-Blob/1.0 Microsoft-HTTPAPI/2.0'
    'x-ms-request-id': '5d88f90e-701e-0043-5f1e-ff2ec3000000'
    'x-ms-client-request-id': 'c33c52fc-6b11-11ef-a0c3-f4a4751e46e5'
    'x-ms-version': 'REDACTED'
    'Date': 'Wed, 04 Sep 2024 23:02:32 GMT'


2024-09-05 00:02:32,174 - INFO - Starting data transformation!!


2024-09-05 00:02:36,440 - INFO - dim_date data generated and saved!!


2024-09-05 00:02:36,520 - INFO - Transformed data saved to Dataset/Cleaned_payroll_Data/nycpayroll_2020.csv


2024-09-05 00:02:36,539 - INFO - Starting ETL pipeline.


2024-09-05 00:02:36,545 - INFO - ETL Pipeline started.


2024-09-05 00:02:36,546 - INFO - ETL Step 1: Extracting data from ADLS.


2024-09-05 00:02:36,546 - INFO - Starting extract_files_from_adls function


2024-09-05 00:02:36,548 - INFO - Request URL: 'https://nycpayrollstorageaccount.blob.core.windows.net/nycpayrollcontainer?restype=REDACTED&comp=REDACTED&prefix=REDACTED'
Request method: 'GET'
Request headers:
    'x-ms-version': 'REDACTED'
    'Accept': 'application/xml'
    'User-Agent': 'azsdk-python-storage-blob/12.22.0 Python/3.12.4 (Windows-11-10.0.22631-SP0)'
    'x-ms-date': 'REDACTED'
    'x-ms-client-request-id': 'c6c94584-6b11-11ef-8a92-f4a4751e46e5'
    'Authorization': 'REDACTED'
No body was attached to the request


2024-09-05 00:02:36,859 - INFO - Response status: 200
Response headers:
    'Transfer-Encoding': 'chunked'
    'Content-Type': 'application/xml'
    'Server': 'Windows-Azure-Blob/1.0 Microsoft-HTTPAPI/2.0'
    'x-ms-request-id': '5d890f80-701e-0043-7e1e-ff2ec3000000'
    'x-ms-client-request-id': 'c6c94584-6b11-11ef-8a92-f4a4751e46e5'
    'x-ms-version': 'REDACTED'
    'Date': 'Wed, 04 Sep 2024 23:02:36 GMT'


2024-09-05 00:02:36,864 - INFO - Data extraction and movement completed.


2024-09-05 00:02:36,867 - INFO - ETL Step 1: Data extraction completed.


2024-09-05 00:02:36,869 - INFO - ETL Step 2: Transforming data.


2024-09-05 00:02:36,871 - INFO - Starting data transformation!!


2024-09-05 00:02:37,698 - INFO - dim_date data generated and saved!!


2024-09-05 00:02:37,822 - INFO - Transformed data saved to Dataset/Cleaned_payroll_Data/nycpayroll_2020.csv


2024-09-05 00:02:37,823 - INFO - ETL Step 2: Data transformation completed.


2024-09-05 00:02:37,823 - INFO - ETL Step 3: Loading data into Snowflake.


2024-09-05 00:02:40,979 - INFO - To route to workers diagnostics web server please install jupyter-server-proxy: python -m pip install jupyter-server-proxy


2024-09-05 00:02:41,144 - INFO - State start


2024-09-05 00:02:41,193 - INFO -   Scheduler at:     tcp://127.0.0.1:63099


2024-09-05 00:02:41,193 - INFO -   dashboard at:  http://127.0.0.1:8787/status


2024-09-05 00:02:41,194 - INFO - Registering Worker plugin shuffle


2024-09-05 00:02:41,251 - INFO -         Start Nanny at: 'tcp://127.0.0.1:63102'


2024-09-05 00:02:45,679 - INFO - Starting extract_files_from_adls function


2024-09-05 00:02:45,682 - INFO - Request URL: 'https://nycpayrollstorageaccount.blob.core.windows.net/nycpayrollcontainer?restype=REDACTED&comp=REDACTED&prefix=REDACTED'
Request method: 'GET'
Request headers:
    'x-ms-version': 'REDACTED'
    'Accept': 'application/xml'
    'User-Agent': 'azsdk-python-storage-blob/12.22.0 Python/3.12.4 (Windows-11-10.0.22631-SP0)'
    'x-ms-date': 'REDACTED'
    'x-ms-client-request-id': 'cc3b0c09-6b11-11ef-beca-f4a4751e46e5'
    'Authorization': 'REDACTED'
No body was attached to the request


2024-09-05 00:02:46,962 - INFO - Response status: 200
Response headers:
    'Transfer-Encoding': 'chunked'
    'Content-Type': 'application/xml'
    'Server': 'Windows-Azure-Blob/1.0 Microsoft-HTTPAPI/2.0'
    'x-ms-request-id': '37c5b25f-401e-0058-091e-ff10c0000000'
    'x-ms-client-request-id': 'cc3b0c09-6b11-11ef-beca-f4a4751e46e5'
    'x-ms-version': 'REDACTED'
    'Date': 'Wed, 04 Sep 2024 23:02:47 GMT'


2024-09-05 00:02:46,973 - INFO - Starting data transformation!!


2024-09-05 00:02:48,824 - INFO - dim_date data generated and saved!!


2024-09-05 00:02:48,893 - INFO - Transformed data saved to Dataset/Cleaned_payroll_Data/nycpayroll_2020.csv


2024-09-05 00:02:49,060 - INFO -       Start worker at:      tcp://127.0.0.1:63109


2024-09-05 00:02:49,061 - INFO -          Listening to:      tcp://127.0.0.1:63109


2024-09-05 00:02:49,062 - INFO -           Worker name:                          0


2024-09-05 00:02:49,064 - INFO -          dashboard at:            127.0.0.1:63110


2024-09-05 00:02:49,064 - INFO - Waiting to connect to:      tcp://127.0.0.1:63099


2024-09-05 00:02:49,065 - INFO - -------------------------------------------------


2024-09-05 00:02:49,067 - INFO -               Threads:                          4


2024-09-05 00:02:49,068 - INFO -                Memory:                  19.84 GiB


2024-09-05 00:02:49,071 - INFO -       Local Directory: C:\Users\oluwa\AppData\Local\Temp\dask-scratch-space\worker-jpmhm_7h


2024-09-05 00:02:49,072 - INFO - -------------------------------------------------


2024-09-05 00:02:49,084 - INFO - Register worker <WorkerState 'tcp://127.0.0.1:63109', name: 0, status: init, memory: 0, processing: 0>


2024-09-05 00:02:49,092 - INFO - Starting worker compute stream, tcp://127.0.0.1:63109


2024-09-05 00:02:49,094 - INFO - Starting Worker plugin shuffle


cp://127.0.0.1:63111


2024-09-05 00:02:49,097 - INFO -         Registered to:      tcp://127.0.0.1:63099


2024-09-05 00:02:49,100 - INFO - -------------------------------------------------


2024-09-05 00:02:49,106 - INFO - Starting established connection to tcp://127.0.0.1:63099


2024-09-05 00:02:49,151 - INFO - Receive client connection: Client-c78c34e4-6b11-11ef-ae30-f4a4751e46e5


2024-09-05 00:02:49,154 - INFO - Starting established connection to tcp://127.0.0.1:63112


2024-09-05 00:02:49,158 - INFO - Dask client initialized with 1 worker.


2024-09-05 00:02:49,234 - INFO - Connected to Snowflake successfully.


2024-09-05 00:02:49,241 - INFO - Transformed NycPayroll CSV file loaded successfully.


2024-09-05 00:02:49,243 - INFO - Snowflake Connector for Python Version: 3.12.1, Python Version: 3.12.4, Platform: Windows-11-10.0.22631-SP0


2024-09-05 00:02:49,245 - INFO - Connecting to GLOBAL Snowflake domain


2024-09-05 00:02:49,247 - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.


2024-09-05 00:02:55,275 - INFO - Number of results in first chunk: 1


2024-09-05 00:02:55,907 - INFO - Number of results in first chunk: 1


2024-09-05 00:02:56,928 - INFO - Number of results in first chunk: 1


2024-09-05 00:02:56,930 - INFO - Table "Dim_Employee" created or already exists.


2024-09-05 00:02:57,383 - INFO - Number of results in first chunk: 1


2024-09-05 00:02:57,386 - INFO - Table "Dim_Agency" created or already exists.


2024-09-05 00:02:58,464 - INFO - Number of results in first chunk: 1


2024-09-05 00:02:58,469 - INFO - Table "Dim_PayBasis" created or already exists.


2024-09-05 00:03:01,538 - INFO - Number of results in first chunk: 1


2024-09-05 00:03:01,541 - INFO - Table "Dim_Date" created or already exists.


2024-09-05 00:03:03,274 - INFO - Number of results in first chunk: 1


2024-09-05 00:03:03,276 - INFO - Table "FactPayroll" created or already exists.


2024-09-05 00:03:03,890 - INFO - Number of results in first chunk: 1


2024-09-05 00:03:03,893 - INFO - Truncated "Dim_Employee" successfully.


2024-09-05 00:03:04,769 - INFO - Number of results in first chunk: 1


2024-09-05 00:03:04,771 - INFO - Truncated "Dim_Agency" successfully.


2024-09-05 00:03:05,303 - INFO - Number of results in first chunk: 1


2024-09-05 00:03:05,305 - INFO - Truncated "Dim_PayBasis" successfully.


2024-09-05 00:03:06,041 - INFO - Number of results in first chunk: 1


2024-09-05 00:03:06,043 - INFO - Truncated "Dim_Date" successfully.


2024-09-05 00:03:06,756 - INFO - Number of results in first chunk: 1


2024-09-05 00:03:06,757 - INFO - Truncated "FactPayroll" successfully.


2024-09-05 00:03:07,186 - INFO - Number of results in first chunk: 8


2024-09-05 00:03:08,259 - INFO - Number of results in first chunk: 8


2024-09-05 00:03:09,189 - INFO - Number of results in first chunk: 6


2024-09-05 00:03:09,507 - INFO - Number of results in first chunk: 0


2024-09-05 00:03:09,827 - INFO - Number of results in first chunk: 1


2024-09-05 00:03:10,249 - INFO - Number of results in first chunk: 0


2024-09-05 00:03:12,802 - INFO - Number of results in first chunk: 34


2024-09-05 00:03:13,272 - INFO - Number of results in first chunk: 0


2024-09-05 00:03:13,619 - INFO - Number of results in first chunk: 0


2024-09-05 00:03:13,986 - INFO - Number of results in first chunk: 1


2024-09-05 00:03:15,262 - INFO - Number of results in first chunk: 1


2024-09-05 00:03:20,259 - INFO - Number of results in first chunk: 1


2024-09-05 00:03:21,605 - INFO - Number of results in first chunk: 6


2024-09-05 00:03:21,608 - INFO - Dim_Employee data loaded successfully!!


2024-09-05 00:03:22,026 - INFO - Number of results in first chunk: 2


2024-09-05 00:03:23,261 - INFO - Number of results in first chunk: 2


2024-09-05 00:03:25,293 - INFO - Number of results in first chunk: 6


2024-09-05 00:03:25,806 - INFO - Number of results in first chunk: 0


2024-09-05 00:03:26,261 - INFO - Number of results in first chunk: 1


2024-09-05 00:03:26,631 - INFO - Number of results in first chunk: 0


2024-09-05 00:03:28,772 - INFO - Number of results in first chunk: 34


2024-09-05 00:03:29,266 - INFO - Number of results in first chunk: 0


2024-09-05 00:03:29,795 - INFO - Number of results in first chunk: 0


2024-09-05 00:03:30,411 - INFO - Number of results in first chunk: 1


2024-09-05 00:03:31,334 - INFO - Number of results in first chunk: 1


2024-09-05 00:03:35,125 - INFO - Number of results in first chunk: 1


2024-09-05 00:03:36,968 - INFO - Number of results in first chunk: 6


2024-09-05 00:03:36,972 - INFO - Dim_Agency data loaded successfully!!


2024-09-05 00:03:37,951 - INFO - Number of results in first chunk: 2


2024-09-05 00:03:38,283 - INFO - Number of results in first chunk: 2


2024-09-05 00:03:38,604 - INFO - Number of results in first chunk: 6


2024-09-05 00:03:39,534 - INFO - Number of results in first chunk: 0


2024-09-05 00:03:40,445 - INFO - Number of results in first chunk: 1


2024-09-05 00:03:40,854 - INFO - Number of results in first chunk: 0


2024-09-05 00:03:44,953 - INFO - Number of results in first chunk: 34


2024-09-05 00:03:46,075 - INFO - Number of results in first chunk: 0


2024-09-05 00:03:46,791 - INFO - Number of results in first chunk: 0


2024-09-05 00:03:52,571 - INFO - Number of results in first chunk: 1


2024-09-05 00:03:55,804 - INFO - Number of results in first chunk: 1


2024-09-05 00:03:57,062 - INFO - Number of results in first chunk: 1


2024-09-05 00:04:00,115 - INFO - Number of results in first chunk: 6


2024-09-05 00:04:00,117 - INFO - Dim_PayBasis data loaded successfully!!


2024-09-05 00:04:01,024 - INFO - Number of results in first chunk: 6


2024-09-05 00:04:01,435 - INFO - Number of results in first chunk: 6


2024-09-05 00:04:02,206 - INFO - Number of results in first chunk: 6


2024-09-05 00:04:02,767 - INFO - Number of results in first chunk: 0


2024-09-05 00:04:03,205 - INFO - Number of results in first chunk: 1


2024-09-05 00:04:03,777 - INFO - Number of results in first chunk: 0


2024-09-05 00:04:06,459 - INFO - Number of results in first chunk: 34


2024-09-05 00:04:06,862 - INFO - Number of results in first chunk: 0


2024-09-05 00:04:07,272 - INFO - Number of results in first chunk: 0


2024-09-05 00:04:07,766 - INFO - Number of results in first chunk: 1


2024-09-05 00:04:08,398 - INFO - Number of results in first chunk: 1


2024-09-05 00:04:09,383 - INFO - Number of results in first chunk: 1


2024-09-05 00:04:10,248 - INFO - Number of results in first chunk: 6


2024-09-05 00:04:10,251 - INFO - Dim_Date data loaded successfully.


2024-09-05 00:04:10,751 - INFO - Number of results in first chunk: 13


2024-09-05 00:04:11,096 - INFO - Number of results in first chunk: 13


2024-09-05 00:04:11,573 - INFO - Number of results in first chunk: 6


2024-09-05 00:04:12,260 - INFO - Number of results in first chunk: 0


2024-09-05 00:04:13,264 - INFO - Number of results in first chunk: 1


2024-09-05 00:04:13,746 - INFO - Number of results in first chunk: 0


2024-09-05 00:04:15,768 - INFO - Number of results in first chunk: 34


2024-09-05 00:04:16,098 - INFO - Number of results in first chunk: 0


2024-09-05 00:04:16,487 - INFO - Number of results in first chunk: 0


2024-09-05 00:04:17,254 - INFO - Number of results in first chunk: 1


2024-09-05 00:04:18,841 - INFO - Number of results in first chunk: 1


2024-09-05 00:04:19,269 - INFO - Number of results in first chunk: 1


2024-09-05 00:04:20,369 - INFO - Number of results in first chunk: 6


2024-09-05 00:04:20,372 - INFO - FactPayroll data loaded successfully!!


2024-09-05 00:04:20,374 - INFO - All data loaded successfully!!


2024-09-05 00:04:21,194 - INFO - Number of results in first chunk: 1


2024-09-05 00:04:21,235 - INFO - Remove client Client-c78c34e4-6b11-11ef-ae30-f4a4751e46e5


2024-09-05 00:04:21,236 - INFO - Received 'close-stream' from tcp://127.0.0.1:63112; closing.


2024-09-05 00:04:21,238 - INFO - Remove client Client-c78c34e4-6b11-11ef-ae30-f4a4751e46e5


2024-09-05 00:04:21,240 - INFO - Close client connection: Client-c78c34e4-6b11-11ef-ae30-f4a4751e46e5


2024-09-05 00:04:21,246 - INFO - Retire worker addresses (0,)


2024-09-05 00:04:21,250 - INFO - Closing Nanny at 'tcp://127.0.0.1:63102'. Reason: nanny-close


2024-09-05 00:04:21,252 - INFO - Nanny asking worker to close. Reason: nanny-close


2024-09-05 00:04:21,254 - INFO - Stopping worker at tcp://127.0.0.1:63109. Reason: nanny-close


2024-09-05 00:04:21,255 - INFO - Removing Worker plugin shuffle


2024-09-05 00:04:21,259 - INFO - Received 'close-stream' from tcp://127.0.0.1:63111; closing.


2024-09-05 00:04:21,259 - INFO - Connection to tcp://127.0.0.1:63099 has been closed.


2024-09-05 00:04:21,260 - INFO - Remove worker <WorkerState 'tcp://127.0.0.1:63109', name: 0, status: closing, memory: 0, processing: 0> (stimulus_id='handle-worker-cleanup-1725491061.26077')


2024-09-05 00:04:21,268 - INFO - Lost all workers


2024-09-05 00:04:21,817 - INFO - Closing scheduler. Reason: unknown


2024-09-05 00:04:21,819 - INFO - Scheduler closing all comms


2024-09-05 00:04:21,833 - INFO - Dask client closed.


2024-09-05 00:04:21,834 - INFO - ETL Step 3: Data loading completed.


2024-09-05 00:04:21,837 - INFO - Connected to Snowflake successfully.


2024-09-05 00:04:21,839 - INFO - Snowflake Connector for Python Version: 3.12.1, Python Version: 3.12.4, Platform: Windows-11-10.0.22631-SP0


2024-09-05 00:04:21,841 - INFO - Connecting to GLOBAL Snowflake domain


2024-09-05 00:04:21,842 - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.


2024-09-05 00:04:24,679 - INFO - Number of results in first chunk: 1


2024-09-05 00:04:25,501 - INFO - Number of results in first chunk: 1


2024-09-05 00:04:27,106 - INFO - Number of results in first chunk: 1


2024-09-05 00:04:27,108 - ERROR - ETL pipeline failed: (snowflake.connector.errors.ProgrammingError) 090232 (25000): 01b6d0a8-0000-6bc0-0022-af0300032286: Stored procedure execution error: Scoped transaction started in stored procedure is incomplete and it was rolled back.
[SQL: CALL "STG".PAYROLL_AGGREGATES();]
(Background on this error at: https://sqlalche.me/e/20/f405)


2024-09-05 00:04:27,291 - INFO - closed


2024-09-05 00:04:27,292 - INFO - No async queries seem to be running, deleting session


2024-09-05 00:04:27,656 - INFO - closed


2024-09-05 00:04:27,658 - INFO - No async queries seem to be running, deleting session


2024-09-05 06:46:52,076 - INFO - Starting extract_files_from_adls function


2024-09-05 06:46:52,080 - INFO - Request URL: 'https://nycpayrollstorageaccount.blob.core.windows.net/nycpayrollcontainer?restype=REDACTED&comp=REDACTED&prefix=REDACTED'
Request method: 'GET'
Request headers:
    'x-ms-version': 'REDACTED'
    'Accept': 'application/xml'
    'User-Agent': 'azsdk-python-storage-blob/12.22.0 Python/3.12.4 (Windows-11-10.0.22631-SP0)'
    'x-ms-date': 'REDACTED'
    'x-ms-client-request-id': '4035bf9d-6b4a-11ef-95c2-f4a4751e46e5'
    'Authorization': 'REDACTED'
No body was attached to the request


2024-09-05 06:46:53,553 - INFO - Response status: 200
Response headers:
    'Transfer-Encoding': 'chunked'
    'Content-Type': 'application/xml'
    'Server': 'Windows-Azure-Blob/1.0 Microsoft-HTTPAPI/2.0'
    'x-ms-request-id': 'f6b605da-a01e-001d-3d57-ffc523000000'
    'x-ms-client-request-id': '4035bf9d-6b4a-11ef-95c2-f4a4751e46e5'
    'x-ms-version': 'REDACTED'
    'Date': 'Thu, 05 Sep 2024 05:46:53 GMT'


2024-09-05 06:46:53,574 - INFO - Starting data transformation!!


2024-09-05 06:46:54,573 - INFO - dim_date data generated and saved!!


2024-09-05 06:46:54,631 - INFO - Transformed data saved to Dataset/Cleaned_payroll_Data/nycpayroll_2020.csv


2024-09-05 06:46:54,639 - INFO - Starting ETL pipeline.


2024-09-05 06:46:54,642 - INFO - ETL Pipeline started.


2024-09-05 06:46:54,643 - INFO - ETL Step 1: Extracting data from ADLS.


2024-09-05 06:46:54,643 - INFO - Starting extract_files_from_adls function


2024-09-05 06:46:54,644 - INFO - Request URL: 'https://nycpayrollstorageaccount.blob.core.windows.net/nycpayrollcontainer?restype=REDACTED&comp=REDACTED&prefix=REDACTED'
Request method: 'GET'
Request headers:
    'x-ms-version': 'REDACTED'
    'Accept': 'application/xml'
    'User-Agent': 'azsdk-python-storage-blob/12.22.0 Python/3.12.4 (Windows-11-10.0.22631-SP0)'
    'x-ms-date': 'REDACTED'
    'x-ms-client-request-id': '41bd2ce6-6b4a-11ef-80db-f4a4751e46e5'
    'Authorization': 'REDACTED'
No body was attached to the request


2024-09-05 06:46:54,969 - INFO - Response status: 200
Response headers:
    'Transfer-Encoding': 'chunked'
    'Content-Type': 'application/xml'
    'Server': 'Windows-Azure-Blob/1.0 Microsoft-HTTPAPI/2.0'
    'x-ms-request-id': 'f6b6103d-a01e-001d-5457-ffc523000000'
    'x-ms-client-request-id': '41bd2ce6-6b4a-11ef-80db-f4a4751e46e5'
    'x-ms-version': 'REDACTED'
    'Date': 'Thu, 05 Sep 2024 05:46:54 GMT'


2024-09-05 06:46:54,975 - INFO - Data extraction and movement completed.


2024-09-05 06:46:54,976 - INFO - ETL Step 1: Data extraction completed.


2024-09-05 06:46:54,978 - INFO - ETL Step 2: Transforming data.


2024-09-05 06:46:54,979 - INFO - Starting data transformation!!


2024-09-05 06:46:55,389 - INFO - dim_date data generated and saved!!


2024-09-05 06:46:55,443 - INFO - Transformed data saved to Dataset/Cleaned_payroll_Data/nycpayroll_2020.csv


2024-09-05 06:46:55,443 - INFO - ETL Step 2: Data transformation completed.


2024-09-05 06:46:55,445 - INFO - ETL Step 3: Loading data into Snowflake.


2024-09-05 06:46:56,889 - INFO - To route to workers diagnostics web server please install jupyter-server-proxy: python -m pip install jupyter-server-proxy


2024-09-05 06:46:56,931 - INFO - State start


2024-09-05 06:46:56,976 - INFO -   Scheduler at:     tcp://127.0.0.1:60558


2024-09-05 06:46:56,977 - INFO -   dashboard at:  http://127.0.0.1:8787/status


2024-09-05 06:46:56,978 - INFO - Registering Worker plugin shuffle


2024-09-05 06:46:57,025 - INFO -         Start Nanny at: 'tcp://127.0.0.1:60561'


2024-09-05 06:46:59,459 - INFO - Starting extract_files_from_adls function


2024-09-05 06:46:59,461 - INFO - Request URL: 'https://nycpayrollstorageaccount.blob.core.windows.net/nycpayrollcontainer?restype=REDACTED&comp=REDACTED&prefix=REDACTED'
Request method: 'GET'
Request headers:
    'x-ms-version': 'REDACTED'
    'Accept': 'application/xml'
    'User-Agent': 'azsdk-python-storage-blob/12.22.0 Python/3.12.4 (Windows-11-10.0.22631-SP0)'
    'x-ms-date': 'REDACTED'
    'x-ms-client-request-id': '449c1e2f-6b4a-11ef-a761-f4a4751e46e5'
    'Authorization': 'REDACTED'
No body was attached to the request


2024-09-05 06:47:00,679 - INFO - Response status: 200
Response headers:
    'Transfer-Encoding': 'chunked'
    'Content-Type': 'application/xml'
    'Server': 'Windows-Azure-Blob/1.0 Microsoft-HTTPAPI/2.0'
    'x-ms-request-id': '4689d6f7-201e-0003-3d57-ff29fb000000'
    'x-ms-client-request-id': '449c1e2f-6b4a-11ef-a761-f4a4751e46e5'
    'x-ms-version': 'REDACTED'
    'Date': 'Thu, 05 Sep 2024 05:47:00 GMT'


2024-09-05 06:47:00,690 - INFO - Starting data transformation!!


2024-09-05 06:47:01,579 - INFO - dim_date data generated and saved!!


2024-09-05 06:47:01,634 - INFO - Transformed data saved to Dataset/Cleaned_payroll_Data/nycpayroll_2020.csv


2024-09-05 06:47:01,739 - INFO -       Start worker at:      tcp://127.0.0.1:60568


2024-09-05 06:47:01,740 - INFO -          Listening to:      tcp://127.0.0.1:60568


2024-09-05 06:47:01,740 - INFO -           Worker name:                          0


2024-09-05 06:47:01,741 - INFO -          dashboard at:            127.0.0.1:60569


2024-09-05 06:47:01,741 - INFO - Waiting to connect to:      tcp://127.0.0.1:60558


2024-09-05 06:47:01,741 - INFO - -------------------------------------------------


2024-09-05 06:47:01,742 - INFO -               Threads:                          4


2024-09-05 06:47:01,742 - INFO -                Memory:                  19.84 GiB


2024-09-05 06:47:01,743 - INFO -       Local Directory: C:\Users\oluwa\AppData\Local\Temp\dask-scratch-space\worker-kqmhha73


2024-09-05 06:47:01,743 - INFO - -------------------------------------------------


2024-09-05 06:47:01,749 - INFO - Register worker <WorkerState 'tcp://127.0.0.1:60568', name: 0, status: init, memory: 0, processing: 0>


2024-09-05 06:47:01,752 - INFO - Starting worker compute stream, tcp://127.0.0.1:60568


2024-09-05 06:47:01,753 - INFO - Starting established connection to tcp://127.0.0.1:60570


2024-09-05 06:47:01,753 - INFO - Starting Worker plugin shuffle


2024-09-05 06:47:01,756 - INFO -         Registered to:      tcp://127.0.0.1:60558


2024-09-05 06:47:01,757 - INFO - -------------------------------------------------


2024-09-05 06:47:01,759 - INFO - Starting established connection to tcp://127.0.0.1:60558


2024-09-05 06:47:01,816 - INFO - Receive client connection: Client-423779af-6b4a-11ef-9e6c-f4a4751e46e5


2024-09-05 06:47:01,817 - INFO - Starting established connection to tcp://127.0.0.1:60571


2024-09-05 06:47:01,819 - INFO - Dask client initialized with 1 worker.


2024-09-05 06:47:01,840 - INFO - Connected to Snowflake successfully.


2024-09-05 06:47:01,843 - INFO - Transformed NycPayroll CSV file loaded successfully.


2024-09-05 06:47:01,844 - INFO - Snowflake Connector for Python Version: 3.12.1, Python Version: 3.12.4, Platform: Windows-11-10.0.22631-SP0


2024-09-05 06:47:01,845 - INFO - Connecting to GLOBAL Snowflake domain


2024-09-05 06:47:01,845 - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.


2024-09-05 06:47:05,641 - INFO - Number of results in first chunk: 1


2024-09-05 06:47:06,048 - INFO - Number of results in first chunk: 1


2024-09-05 06:47:06,569 - INFO - Number of results in first chunk: 1


2024-09-05 06:47:06,571 - INFO - Table "Dim_Employee" created or already exists.


2024-09-05 06:47:06,935 - INFO - Number of results in first chunk: 1


2024-09-05 06:47:06,935 - INFO - Table "Dim_Agency" created or already exists.


2024-09-05 06:47:07,258 - INFO - Number of results in first chunk: 1


2024-09-05 06:47:07,260 - INFO - Table "Dim_PayBasis" created or already exists.


2024-09-05 06:47:07,594 - INFO - Number of results in first chunk: 1


2024-09-05 06:47:07,596 - INFO - Table "Dim_Date" created or already exists.


2024-09-05 06:47:08,082 - INFO - Number of results in first chunk: 1


2024-09-05 06:47:08,085 - INFO - Table "FactPayroll" created or already exists.


2024-09-05 06:47:08,548 - INFO - Number of results in first chunk: 1


2024-09-05 06:47:08,550 - INFO - Truncated "Dim_Employee" successfully.


2024-09-05 06:47:08,971 - INFO - Number of results in first chunk: 1


2024-09-05 06:47:08,973 - INFO - Truncated "Dim_Agency" successfully.


2024-09-05 06:47:09,382 - INFO - Number of results in first chunk: 1


2024-09-05 06:47:09,383 - INFO - Truncated "Dim_PayBasis" successfully.


2024-09-05 06:47:09,797 - INFO - Number of results in first chunk: 1


2024-09-05 06:47:09,798 - INFO - Truncated "Dim_Date" successfully.


2024-09-05 06:47:10,158 - INFO - Number of results in first chunk: 1


2024-09-05 06:47:10,160 - INFO - Truncated "FactPayroll" successfully.


2024-09-05 06:47:10,557 - INFO - Number of results in first chunk: 8


2024-09-05 06:47:10,878 - INFO - Number of results in first chunk: 8


2024-09-05 06:47:11,456 - INFO - Number of results in first chunk: 6


2024-09-05 06:47:11,849 - INFO - Number of results in first chunk: 0


2024-09-05 06:47:12,309 - INFO - Number of results in first chunk: 1


2024-09-05 06:47:12,731 - INFO - Number of results in first chunk: 0


2024-09-05 06:47:14,241 - INFO - Number of results in first chunk: 34


2024-09-05 06:47:14,600 - INFO - Number of results in first chunk: 0


2024-09-05 06:47:14,938 - INFO - Number of results in first chunk: 0


2024-09-05 06:47:15,253 - INFO - Number of results in first chunk: 1


2024-09-05 06:47:15,975 - INFO - Number of results in first chunk: 1


2024-09-05 06:47:16,409 - INFO - Number of results in first chunk: 1


2024-09-05 06:47:17,644 - INFO - Number of results in first chunk: 6


2024-09-05 06:47:17,647 - INFO - Dim_Employee data loaded successfully!!


2024-09-05 06:47:18,005 - INFO - Number of results in first chunk: 2


2024-09-05 06:47:18,395 - INFO - Number of results in first chunk: 2


2024-09-05 06:47:18,788 - INFO - Number of results in first chunk: 6


2024-09-05 06:47:19,111 - INFO - Number of results in first chunk: 0


2024-09-05 06:47:19,448 - INFO - Number of results in first chunk: 1


2024-09-05 06:47:19,789 - INFO - Number of results in first chunk: 0


2024-09-05 06:47:21,115 - INFO - Number of results in first chunk: 34


2024-09-05 06:47:21,528 - INFO - Number of results in first chunk: 0


2024-09-05 06:47:21,845 - INFO - Number of results in first chunk: 0


2024-09-05 06:47:22,183 - INFO - Number of results in first chunk: 1


2024-09-05 06:47:22,656 - INFO - Number of results in first chunk: 1


2024-09-05 06:47:23,127 - INFO - Number of results in first chunk: 1


2024-09-05 06:47:24,358 - INFO - Number of results in first chunk: 6


2024-09-05 06:47:24,359 - INFO - Dim_Agency data loaded successfully!!


2024-09-05 06:47:25,288 - INFO - Number of results in first chunk: 2


2024-09-05 06:47:25,611 - INFO - Number of results in first chunk: 2


2024-09-05 06:47:26,780 - INFO - Number of results in first chunk: 6


2024-09-05 06:47:27,159 - INFO - Number of results in first chunk: 0


2024-09-05 06:47:27,934 - INFO - Number of results in first chunk: 1


2024-09-05 06:47:28,251 - INFO - Number of results in first chunk: 0


2024-09-05 06:47:29,428 - INFO - Number of results in first chunk: 34


2024-09-05 06:47:29,777 - INFO - Number of results in first chunk: 0


2024-09-05 06:47:30,734 - INFO - Number of results in first chunk: 0


2024-09-05 06:47:31,055 - INFO - Number of results in first chunk: 1


2024-09-05 06:47:31,577 - INFO - Number of results in first chunk: 1


2024-09-05 06:47:32,034 - INFO - Number of results in first chunk: 1


2024-09-05 06:47:32,842 - INFO - Number of results in first chunk: 6


2024-09-05 06:47:32,843 - INFO - Dim_PayBasis data loaded successfully!!


2024-09-05 06:47:33,175 - INFO - Number of results in first chunk: 6


2024-09-05 06:47:33,523 - INFO - Number of results in first chunk: 6


2024-09-05 06:47:33,848 - INFO - Number of results in first chunk: 6


2024-09-05 06:47:34,147 - INFO - Number of results in first chunk: 0


2024-09-05 06:47:34,500 - INFO - Number of results in first chunk: 1


2024-09-05 06:47:34,832 - INFO - Number of results in first chunk: 0


2024-09-05 06:47:36,028 - INFO - Number of results in first chunk: 34


2024-09-05 06:47:36,368 - INFO - Number of results in first chunk: 0


2024-09-05 06:47:36,687 - INFO - Number of results in first chunk: 0


2024-09-05 06:47:37,038 - INFO - Number of results in first chunk: 1


2024-09-05 06:47:37,536 - INFO - Number of results in first chunk: 1


2024-09-05 06:47:37,904 - INFO - Number of results in first chunk: 1


2024-09-05 06:47:39,338 - INFO - Number of results in first chunk: 6


2024-09-05 06:47:39,340 - INFO - Dim_Date data loaded successfully.


2024-09-05 06:47:39,659 - INFO - Number of results in first chunk: 13


2024-09-05 06:47:39,962 - INFO - Number of results in first chunk: 13


2024-09-05 06:47:40,290 - INFO - Number of results in first chunk: 6


2024-09-05 06:47:40,616 - INFO - Number of results in first chunk: 0


2024-09-05 06:47:41,535 - INFO - Number of results in first chunk: 1


2024-09-05 06:47:41,888 - INFO - Number of results in first chunk: 0


2024-09-05 06:47:43,156 - INFO - Number of results in first chunk: 34


2024-09-05 06:47:43,525 - INFO - Number of results in first chunk: 0


2024-09-05 06:47:43,875 - INFO - Number of results in first chunk: 0


2024-09-05 06:47:44,238 - INFO - Number of results in first chunk: 1


2024-09-05 06:47:44,976 - INFO - Number of results in first chunk: 1


2024-09-05 06:47:45,457 - INFO - Number of results in first chunk: 1


2024-09-05 06:47:46,383 - INFO - Number of results in first chunk: 6


2024-09-05 06:47:46,384 - INFO - FactPayroll data loaded successfully!!


2024-09-05 06:47:46,385 - INFO - All data loaded successfully!!


2024-09-05 06:47:46,740 - INFO - Number of results in first chunk: 1


2024-09-05 06:47:46,748 - INFO - Remove client Client-423779af-6b4a-11ef-9e6c-f4a4751e46e5


2024-09-05 06:47:46,750 - INFO - Received 'close-stream' from tcp://127.0.0.1:60571; closing.


2024-09-05 06:47:46,755 - INFO - Remove client Client-423779af-6b4a-11ef-9e6c-f4a4751e46e5


2024-09-05 06:47:46,760 - INFO - Close client connection: Client-423779af-6b4a-11ef-9e6c-f4a4751e46e5


2024-09-05 06:47:46,769 - INFO - Retire worker addresses (0,)


2024-09-05 06:47:46,775 - INFO - Closing Nanny at 'tcp://127.0.0.1:60561'. Reason: nanny-close


2024-09-05 06:47:46,776 - INFO - Nanny asking worker to close. Reason: nanny-close


2024-09-05 06:47:46,800 - INFO - Stopping worker at tcp://127.0.0.1:60568. Reason: nanny-close


2024-09-05 06:47:46,804 - INFO - Removing Worker plugin shuffle


2024-09-05 06:47:46,808 - INFO - Connection to tcp://127.0.0.1:60558 has been closed.


2024-09-05 06:47:46,837 - INFO - Received 'close-stream' from tcp://127.0.0.1:60570; closing.


2024-09-05 06:47:46,840 - INFO - Remove worker <WorkerState 'tcp://127.0.0.1:60568', name: 0, status: closing, memory: 0, processing: 0> (stimulus_id='handle-worker-cleanup-1725515266.8407748')


2024-09-05 06:47:46,842 - INFO - Lost all workers


2024-09-05 06:47:47,232 - INFO - Closing scheduler. Reason: unknown


2024-09-05 06:47:47,233 - INFO - Scheduler closing all comms


2024-09-05 06:47:47,238 - INFO - Dask client closed.


2024-09-05 06:47:47,238 - INFO - ETL Step 3: Data loading completed.


2024-09-05 06:47:47,240 - INFO - Connected to Snowflake successfully.


2024-09-05 06:47:47,241 - INFO - Snowflake Connector for Python Version: 3.12.1, Python Version: 3.12.4, Platform: Windows-11-10.0.22631-SP0


2024-09-05 06:47:47,242 - INFO - Connecting to GLOBAL Snowflake domain


2024-09-05 06:47:47,242 - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.


2024-09-05 06:47:49,523 - INFO - Number of results in first chunk: 1


2024-09-05 06:47:49,818 - INFO - Number of results in first chunk: 1


2024-09-05 06:47:51,765 - INFO - Number of results in first chunk: 1


2024-09-05 06:47:51,765 - ERROR - ETL pipeline failed: (snowflake.connector.errors.ProgrammingError) 090232 (25000): 01b6d23b-0000-6bf3-0022-af0300036056: Stored procedure execution error: Scoped transaction started in stored procedure is incomplete and it was rolled back.
[SQL: CALL "STG".PAYROLL_AGGREGATES();]
(Background on this error at: https://sqlalche.me/e/20/f405)


2024-09-05 06:47:51,791 - INFO - closed


2024-09-05 06:47:51,791 - INFO - No async queries seem to be running, deleting session


2024-09-05 06:47:52,058 - INFO - closed


2024-09-05 06:47:52,059 - INFO - No async queries seem to be running, deleting session


2024-09-05 06:58:45,345 - INFO - Starting extract_files_from_adls function


2024-09-05 06:58:45,347 - INFO - Request URL: 'https://nycpayrollstorageaccount.blob.core.windows.net/nycpayrollcontainer?restype=REDACTED&comp=REDACTED&prefix=REDACTED'
Request method: 'GET'
Request headers:
    'x-ms-version': 'REDACTED'
    'Accept': 'application/xml'
    'User-Agent': 'azsdk-python-storage-blob/12.22.0 Python/3.12.4 (Windows-11-10.0.22631-SP0)'
    'x-ms-date': 'REDACTED'
    'x-ms-client-request-id': 'e959b44e-6b4b-11ef-891e-f4a4751e46e5'
    'Authorization': 'REDACTED'
No body was attached to the request


2024-09-05 06:58:46,684 - INFO - Response status: 200
Response headers:
    'Transfer-Encoding': 'chunked'
    'Content-Type': 'application/xml'
    'Server': 'Windows-Azure-Blob/1.0 Microsoft-HTTPAPI/2.0'
    'x-ms-request-id': '5a2a3ad8-901e-0064-6558-ff3907000000'
    'x-ms-client-request-id': 'e959b44e-6b4b-11ef-891e-f4a4751e46e5'
    'x-ms-version': 'REDACTED'
    'Date': 'Thu, 05 Sep 2024 05:58:47 GMT'


2024-09-05 06:58:46,690 - INFO - Starting data transformation!!


2024-09-05 06:58:47,441 - INFO - dim_date data generated and saved!!


2024-09-05 06:58:47,495 - INFO - Transformed data saved to Dataset/Cleaned_payroll_Data/nycpayroll_2020.csv


2024-09-05 06:58:47,507 - INFO - Starting ETL pipeline.


2024-09-05 06:58:47,511 - INFO - ETL Pipeline started.


2024-09-05 06:58:47,511 - INFO - ETL Step 1: Extracting data from ADLS.


2024-09-05 06:58:47,512 - INFO - Starting extract_files_from_adls function


2024-09-05 06:58:47,514 - INFO - Request URL: 'https://nycpayrollstorageaccount.blob.core.windows.net/nycpayrollcontainer?restype=REDACTED&comp=REDACTED&prefix=REDACTED'
Request method: 'GET'
Request headers:
    'x-ms-version': 'REDACTED'
    'Accept': 'application/xml'
    'User-Agent': 'azsdk-python-storage-blob/12.22.0 Python/3.12.4 (Windows-11-10.0.22631-SP0)'
    'x-ms-date': 'REDACTED'
    'x-ms-client-request-id': 'eaa473ce-6b4b-11ef-b976-f4a4751e46e5'
    'Authorization': 'REDACTED'
No body was attached to the request


2024-09-05 06:58:47,784 - INFO - Response status: 200
Response headers:
    'Transfer-Encoding': 'chunked'
    'Content-Type': 'application/xml'
    'Server': 'Windows-Azure-Blob/1.0 Microsoft-HTTPAPI/2.0'
    'x-ms-request-id': '5a2a41fe-901e-0064-5258-ff3907000000'
    'x-ms-client-request-id': 'eaa473ce-6b4b-11ef-b976-f4a4751e46e5'
    'x-ms-version': 'REDACTED'
    'Date': 'Thu, 05 Sep 2024 05:58:48 GMT'


2024-09-05 06:58:47,787 - INFO - Data extraction and movement completed.


2024-09-05 06:58:47,788 - INFO - ETL Step 1: Data extraction completed.


2024-09-05 06:58:47,789 - INFO - ETL Step 2: Transforming data.


2024-09-05 06:58:47,790 - INFO - Starting data transformation!!


2024-09-05 06:58:48,273 - INFO - dim_date data generated and saved!!


2024-09-05 06:58:48,324 - INFO - Transformed data saved to Dataset/Cleaned_payroll_Data/nycpayroll_2020.csv


2024-09-05 06:58:48,324 - INFO - ETL Step 2: Data transformation completed.


2024-09-05 06:58:48,324 - INFO - ETL Step 3: Loading data into Snowflake.


2024-09-05 06:58:48,807 - INFO - To route to workers diagnostics web server please install jupyter-server-proxy: python -m pip install jupyter-server-proxy


2024-09-05 06:58:48,838 - INFO - State start


2024-09-05 06:58:48,884 - INFO -   Scheduler at:     tcp://127.0.0.1:54417


2024-09-05 06:58:48,884 - INFO -   dashboard at:  http://127.0.0.1:8787/status


2024-09-05 06:58:48,885 - INFO - Registering Worker plugin shuffle


2024-09-05 06:58:48,924 - INFO -         Start Nanny at: 'tcp://127.0.0.1:54420'


2024-09-05 06:58:51,506 - INFO - Starting extract_files_from_adls function


2024-09-05 06:58:51,508 - INFO - Request URL: 'https://nycpayrollstorageaccount.blob.core.windows.net/nycpayrollcontainer?restype=REDACTED&comp=REDACTED&prefix=REDACTED'
Request method: 'GET'
Request headers:
    'x-ms-version': 'REDACTED'
    'Accept': 'application/xml'
    'User-Agent': 'azsdk-python-storage-blob/12.22.0 Python/3.12.4 (Windows-11-10.0.22631-SP0)'
    'x-ms-date': 'REDACTED'
    'x-ms-client-request-id': 'ed05c9b0-6b4b-11ef-bf2f-f4a4751e46e5'
    'Authorization': 'REDACTED'
No body was attached to the request


2024-09-05 06:58:52,640 - INFO - Response status: 200
Response headers:
    'Transfer-Encoding': 'chunked'
    'Content-Type': 'application/xml'
    'Server': 'Windows-Azure-Blob/1.0 Microsoft-HTTPAPI/2.0'
    'x-ms-request-id': '8cd6e28c-801e-0025-7958-ff61e3000000'
    'x-ms-client-request-id': 'ed05c9b0-6b4b-11ef-bf2f-f4a4751e46e5'
    'x-ms-version': 'REDACTED'
    'Date': 'Thu, 05 Sep 2024 05:58:53 GMT'


2024-09-05 06:58:52,642 - INFO - Starting data transformation!!


2024-09-05 06:58:53,388 - INFO - dim_date data generated and saved!!


2024-09-05 06:58:53,443 - INFO - Transformed data saved to Dataset/Cleaned_payroll_Data/nycpayroll_2020.csv


2024-09-05 06:58:53,543 - INFO -       Start worker at:      tcp://127.0.0.1:54427


2024-09-05 06:58:53,543 - INFO -          Listening to:      tcp://127.0.0.1:54427


2024-09-05 06:58:53,544 - INFO -           Worker name:                          0


2024-09-05 06:58:53,544 - INFO -          dashboard at:            127.0.0.1:54428


2024-09-05 06:58:53,545 - INFO - Waiting to connect to:      tcp://127.0.0.1:54417


2024-09-05 06:58:53,545 - INFO - -------------------------------------------------


2024-09-05 06:58:53,546 - INFO -               Threads:                          4


2024-09-05 06:58:53,546 - INFO -                Memory:                  19.84 GiB


2024-09-05 06:58:53,547 - INFO -       Local Directory: C:\Users\oluwa\AppData\Local\Temp\dask-scratch-space\worker-8yqxofuk


2024-09-05 06:58:53,547 - INFO - -------------------------------------------------


2024-09-05 06:58:53,552 - INFO - Register worker <WorkerState 'tcp://127.0.0.1:54427', name: 0, status: init, memory: 0, processing: 0>


2024-09-05 06:58:53,556 - INFO - Starting worker compute stream, tcp://127.0.0.1:54427


2024-09-05 06:58:53,557 - INFO - Starting Worker plugin shuffle


2024-09-05 06:58:53,557 - INFO - Starting established connection to tcp://127.0.0.1:54429


2024-09-05 06:58:53,558 - INFO -         Registered to:      tcp://127.0.0.1:54417


2024-09-05 06:58:53,561 - INFO - -------------------------------------------------


2024-09-05 06:58:53,562 - INFO - Starting established connection to tcp://127.0.0.1:54417


2024-09-05 06:58:53,624 - INFO - Receive client connection: Client-eb205f20-6b4b-11ef-8078-f4a4751e46e5


2024-09-05 06:58:53,625 - INFO - Starting established connection to tcp://127.0.0.1:54430


2024-09-05 06:58:53,628 - INFO - Dask client initialized with 1 worker.


2024-09-05 06:58:53,643 - INFO - Connected to Snowflake successfully.


2024-09-05 06:58:53,648 - INFO - Transformed NycPayroll CSV file loaded successfully.


2024-09-05 06:58:53,648 - INFO - Snowflake Connector for Python Version: 3.12.1, Python Version: 3.12.4, Platform: Windows-11-10.0.22631-SP0


2024-09-05 06:58:53,649 - INFO - Connecting to GLOBAL Snowflake domain


2024-09-05 06:58:53,649 - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.


2024-09-05 06:58:56,035 - INFO - Number of results in first chunk: 1


2024-09-05 06:58:56,354 - INFO - Number of results in first chunk: 1


2024-09-05 06:58:56,670 - INFO - Number of results in first chunk: 1


2024-09-05 06:58:56,670 - INFO - Table "Dim_Employee" created or already exists.


2024-09-05 06:58:57,083 - INFO - Number of results in first chunk: 1


2024-09-05 06:58:57,085 - INFO - Table "Dim_Agency" created or already exists.


2024-09-05 06:58:57,430 - INFO - Number of results in first chunk: 1


2024-09-05 06:58:57,431 - INFO - Table "Dim_PayBasis" created or already exists.


2024-09-05 06:58:57,750 - INFO - Number of results in first chunk: 1


2024-09-05 06:58:57,753 - INFO - Table "Dim_Date" created or already exists.


2024-09-05 06:58:58,188 - INFO - Number of results in first chunk: 1


2024-09-05 06:58:58,189 - INFO - Table "FactPayroll" created or already exists.


2024-09-05 06:58:58,647 - INFO - Number of results in first chunk: 1


2024-09-05 06:58:58,648 - INFO - Truncated "Dim_Employee" successfully.


2024-09-05 06:58:59,080 - INFO - Number of results in first chunk: 1


2024-09-05 06:58:59,081 - INFO - Truncated "Dim_Agency" successfully.


2024-09-05 06:58:59,455 - INFO - Number of results in first chunk: 1


2024-09-05 06:58:59,455 - INFO - Truncated "Dim_PayBasis" successfully.


2024-09-05 06:58:59,883 - INFO - Number of results in first chunk: 1


2024-09-05 06:58:59,885 - INFO - Truncated "Dim_Date" successfully.


2024-09-05 06:59:00,316 - INFO - Number of results in first chunk: 1


2024-09-05 06:59:00,317 - INFO - Truncated "FactPayroll" successfully.


2024-09-05 06:59:00,642 - INFO - Number of results in first chunk: 8


2024-09-05 06:59:00,939 - INFO - Number of results in first chunk: 8


2024-09-05 06:59:01,360 - INFO - Number of results in first chunk: 6


2024-09-05 06:59:01,734 - INFO - Number of results in first chunk: 0


2024-09-05 06:59:02,060 - INFO - Number of results in first chunk: 1


2024-09-05 06:59:02,420 - INFO - Number of results in first chunk: 0


2024-09-05 06:59:04,603 - INFO - Number of results in first chunk: 34


2024-09-05 06:59:04,932 - INFO - Number of results in first chunk: 0


2024-09-05 06:59:05,507 - INFO - Number of results in first chunk: 0


2024-09-05 06:59:05,834 - INFO - Number of results in first chunk: 1


2024-09-05 06:59:06,607 - INFO - Number of results in first chunk: 1


2024-09-05 06:59:06,982 - INFO - Number of results in first chunk: 1


2024-09-05 06:59:08,246 - INFO - Number of results in first chunk: 6


2024-09-05 06:59:08,248 - INFO - Dim_Employee data loaded successfully!!


2024-09-05 06:59:08,583 - INFO - Number of results in first chunk: 2


2024-09-05 06:59:08,927 - INFO - Number of results in first chunk: 2


2024-09-05 06:59:09,250 - INFO - Number of results in first chunk: 6


2024-09-05 06:59:09,591 - INFO - Number of results in first chunk: 0


2024-09-05 06:59:09,896 - INFO - Number of results in first chunk: 1


2024-09-05 06:59:10,740 - INFO - Number of results in first chunk: 0


2024-09-05 06:59:12,067 - INFO - Number of results in first chunk: 34


2024-09-05 06:59:12,400 - INFO - Number of results in first chunk: 0


2024-09-05 06:59:12,718 - INFO - Number of results in first chunk: 0


2024-09-05 06:59:13,050 - INFO - Number of results in first chunk: 1


2024-09-05 06:59:13,507 - INFO - Number of results in first chunk: 1


2024-09-05 06:59:13,911 - INFO - Number of results in first chunk: 1


2024-09-05 06:59:15,265 - INFO - Number of results in first chunk: 6


2024-09-05 06:59:15,266 - INFO - Dim_Agency data loaded successfully!!


2024-09-05 06:59:15,577 - INFO - Number of results in first chunk: 2


2024-09-05 06:59:15,921 - INFO - Number of results in first chunk: 2


2024-09-05 06:59:16,800 - INFO - Number of results in first chunk: 6


2024-09-05 06:59:17,118 - INFO - Number of results in first chunk: 0


2024-09-05 06:59:17,732 - INFO - Number of results in first chunk: 1


2024-09-05 06:59:18,150 - INFO - Number of results in first chunk: 0


2024-09-05 06:59:19,337 - INFO - Number of results in first chunk: 34


2024-09-05 06:59:19,686 - INFO - Number of results in first chunk: 0


2024-09-05 06:59:20,021 - INFO - Number of results in first chunk: 0


2024-09-05 06:59:20,329 - INFO - Number of results in first chunk: 1


2024-09-05 06:59:20,778 - INFO - Number of results in first chunk: 1


2024-09-05 06:59:21,149 - INFO - Number of results in first chunk: 1


2024-09-05 06:59:22,005 - INFO - Number of results in first chunk: 6


2024-09-05 06:59:22,006 - INFO - Dim_PayBasis data loaded successfully!!


2024-09-05 06:59:22,318 - INFO - Number of results in first chunk: 6


2024-09-05 06:59:22,667 - INFO - Number of results in first chunk: 6


2024-09-05 06:59:23,008 - INFO - Number of results in first chunk: 6


2024-09-05 06:59:23,370 - INFO - Number of results in first chunk: 0


2024-09-05 06:59:23,667 - INFO - Number of results in first chunk: 1


2024-09-05 06:59:23,975 - INFO - Number of results in first chunk: 0


2024-09-05 06:59:25,137 - INFO - Number of results in first chunk: 34


2024-09-05 06:59:25,430 - INFO - Number of results in first chunk: 0


2024-09-05 06:59:25,744 - INFO - Number of results in first chunk: 0


2024-09-05 06:59:26,059 - INFO - Number of results in first chunk: 1


2024-09-05 06:59:26,503 - INFO - Number of results in first chunk: 1


2024-09-05 06:59:26,878 - INFO - Number of results in first chunk: 1


2024-09-05 06:59:27,961 - INFO - Number of results in first chunk: 6


2024-09-05 06:59:27,962 - INFO - Dim_Date data loaded successfully.


2024-09-05 06:59:28,808 - INFO - Number of results in first chunk: 13


2024-09-05 06:59:29,127 - INFO - Number of results in first chunk: 13


2024-09-05 06:59:29,472 - INFO - Number of results in first chunk: 6


2024-09-05 06:59:29,770 - INFO - Number of results in first chunk: 0


2024-09-05 06:59:30,074 - INFO - Number of results in first chunk: 1


2024-09-05 06:59:30,386 - INFO - Number of results in first chunk: 0


2024-09-05 06:59:31,461 - INFO - Number of results in first chunk: 34


2024-09-05 06:59:32,347 - INFO - Number of results in first chunk: 0


2024-09-05 06:59:32,649 - INFO - Number of results in first chunk: 0


2024-09-05 06:59:32,961 - INFO - Number of results in first chunk: 1


2024-09-05 06:59:36,705 - INFO - Number of results in first chunk: 1


2024-09-05 06:59:37,102 - INFO - Number of results in first chunk: 1


2024-09-05 06:59:37,967 - INFO - Number of results in first chunk: 6


2024-09-05 06:59:37,968 - INFO - FactPayroll data loaded successfully!!


2024-09-05 06:59:37,968 - INFO - All data loaded successfully!!


2024-09-05 06:59:38,329 - INFO - Number of results in first chunk: 1


2024-09-05 06:59:38,338 - INFO - Remove client Client-eb205f20-6b4b-11ef-8078-f4a4751e46e5


2024-09-05 06:59:38,340 - INFO - Received 'close-stream' from tcp://127.0.0.1:54430; closing.


2024-09-05 06:59:38,344 - INFO - Remove client Client-eb205f20-6b4b-11ef-8078-f4a4751e46e5


2024-09-05 06:59:38,347 - INFO - Close client connection: Client-eb205f20-6b4b-11ef-8078-f4a4751e46e5


2024-09-05 06:59:38,350 - INFO - Retire worker addresses (0,)


2024-09-05 06:59:38,352 - INFO - Closing Nanny at 'tcp://127.0.0.1:54420'. Reason: nanny-close


2024-09-05 06:59:38,354 - INFO - Nanny asking worker to close. Reason: nanny-close


2024-09-05 06:59:38,355 - INFO - Stopping worker at tcp://127.0.0.1:54427. Reason: nanny-close


2024-09-05 06:59:38,357 - INFO - Removing Worker plugin shuffle


2024-09-05 06:59:38,362 - INFO - Received 'close-stream' from tcp://127.0.0.1:54429; closing.


2024-09-05 06:59:38,362 - INFO - Connection to tcp://127.0.0.1:54417 has been closed.


2024-09-05 06:59:38,364 - INFO - Remove worker <WorkerState 'tcp://127.0.0.1:54427', name: 0, status: closing, memory: 0, processing: 0> (stimulus_id='handle-worker-cleanup-1725515978.3646889')


2024-09-05 06:59:38,364 - INFO - Lost all workers


2024-09-05 06:59:38,648 - INFO - Closing scheduler. Reason: unknown


2024-09-05 06:59:38,648 - INFO - Scheduler closing all comms


2024-09-05 06:59:38,652 - INFO - Dask client closed.


2024-09-05 06:59:38,652 - INFO - ETL Step 3: Data loading completed.


2024-09-05 06:59:38,655 - INFO - Connected to Snowflake successfully.


2024-09-05 06:59:38,656 - INFO - Snowflake Connector for Python Version: 3.12.1, Python Version: 3.12.4, Platform: Windows-11-10.0.22631-SP0


2024-09-05 06:59:38,657 - INFO - Connecting to GLOBAL Snowflake domain


2024-09-05 06:59:38,659 - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.


2024-09-05 06:59:40,685 - INFO - Number of results in first chunk: 1


2024-09-05 06:59:40,982 - INFO - Number of results in first chunk: 1


2024-09-05 06:59:42,539 - INFO - Number of results in first chunk: 1


2024-09-05 06:59:42,540 - ERROR - ETL pipeline failed: (snowflake.connector.errors.ProgrammingError) 090232 (25000): 01b6d247-0000-6bee-0022-af03000343d6: Stored procedure execution error: Scoped transaction started in stored procedure is incomplete and it was rolled back.
[SQL: CALL "STG".PAYROLL_AGGREGATES();]
(Background on this error at: https://sqlalche.me/e/20/f405)


2024-09-05 06:59:42,580 - INFO - closed


2024-09-05 06:59:42,581 - INFO - No async queries seem to be running, deleting session


2024-09-05 06:59:42,875 - INFO - closed


2024-09-05 06:59:42,876 - INFO - No async queries seem to be running, deleting session


2024-09-05 07:32:55,203 - INFO - Transformed NycPayroll CSV file loaded successfully.


2024-09-05 08:03:44,715 - INFO - Starting extract_files_from_adls function


2024-09-05 08:03:44,717 - INFO - Request URL: 'https://nycpayrollstorageaccount.blob.core.windows.net/nycpayrollcontainer?restype=REDACTED&comp=REDACTED&prefix=REDACTED'
Request method: 'GET'
Request headers:
    'x-ms-version': 'REDACTED'
    'Accept': 'application/xml'
    'User-Agent': 'azsdk-python-storage-blob/12.22.0 Python/3.12.4 (Windows-11-10.0.22631-SP0)'
    'x-ms-date': 'REDACTED'
    'x-ms-client-request-id': 'fd8e53db-6b54-11ef-8f29-f4a4751e46e5'
    'Authorization': 'REDACTED'
No body was attached to the request


2024-09-05 08:03:46,106 - INFO - Response status: 200
Response headers:
    'Transfer-Encoding': 'chunked'
    'Content-Type': 'application/xml'
    'Server': 'Windows-Azure-Blob/1.0 Microsoft-HTTPAPI/2.0'
    'x-ms-request-id': 'f6034b4b-d01e-0038-0861-ff6c5f000000'
    'x-ms-client-request-id': 'fd8e53db-6b54-11ef-8f29-f4a4751e46e5'
    'x-ms-version': 'REDACTED'
    'Date': 'Thu, 05 Sep 2024 07:03:45 GMT'


2024-09-05 08:03:46,110 - INFO - Starting data transformation!!


2024-09-05 08:03:46,931 - INFO - dim_date data generated and saved!!


2024-09-05 08:03:46,992 - INFO - Transformed data saved to Dataset/Cleaned_payroll_Data/nycpayroll_2020.csv


2024-09-05 08:03:47,006 - INFO - Starting ETL pipeline.


2024-09-05 08:03:47,009 - INFO - ETL Pipeline started.


2024-09-05 08:03:47,009 - INFO - ETL Step 1: Extracting data from ADLS.


2024-09-05 08:03:47,010 - INFO - Starting extract_files_from_adls function


2024-09-05 08:03:47,012 - INFO - Request URL: 'https://nycpayrollstorageaccount.blob.core.windows.net/nycpayrollcontainer?restype=REDACTED&comp=REDACTED&prefix=REDACTED'
Request method: 'GET'
Request headers:
    'x-ms-version': 'REDACTED'
    'Accept': 'application/xml'
    'User-Agent': 'azsdk-python-storage-blob/12.22.0 Python/3.12.4 (Windows-11-10.0.22631-SP0)'
    'x-ms-date': 'REDACTED'
    'x-ms-client-request-id': 'feec8ae6-6b54-11ef-8d5c-f4a4751e46e5'
    'Authorization': 'REDACTED'
No body was attached to the request


2024-09-05 08:03:47,292 - INFO - Response status: 200
Response headers:
    'Transfer-Encoding': 'chunked'
    'Content-Type': 'application/xml'
    'Server': 'Windows-Azure-Blob/1.0 Microsoft-HTTPAPI/2.0'
    'x-ms-request-id': 'f6035232-d01e-0038-2f61-ff6c5f000000'
    'x-ms-client-request-id': 'feec8ae6-6b54-11ef-8d5c-f4a4751e46e5'
    'x-ms-version': 'REDACTED'
    'Date': 'Thu, 05 Sep 2024 07:03:47 GMT'


2024-09-05 08:03:47,298 - INFO - Data extraction and movement completed.


2024-09-05 08:03:47,300 - INFO - ETL Step 1: Data extraction completed.


2024-09-05 08:03:47,301 - INFO - ETL Step 2: Transforming data.


2024-09-05 08:03:47,302 - INFO - Starting data transformation!!


2024-09-05 08:03:47,685 - INFO - dim_date data generated and saved!!


2024-09-05 08:03:47,734 - INFO - Transformed data saved to Dataset/Cleaned_payroll_Data/nycpayroll_2020.csv


2024-09-05 08:03:47,735 - INFO - ETL Step 2: Data transformation completed.


2024-09-05 08:03:47,735 - INFO - ETL Step 3: Loading data into Snowflake.


2024-09-05 08:03:48,219 - INFO - To route to workers diagnostics web server please install jupyter-server-proxy: python -m pip install jupyter-server-proxy


2024-09-05 08:03:48,250 - INFO - State start


2024-09-05 08:03:48,290 - INFO -   Scheduler at:     tcp://127.0.0.1:60217


2024-09-05 08:03:48,292 - INFO -   dashboard at:  http://127.0.0.1:8787/status


2024-09-05 08:03:48,292 - INFO - Registering Worker plugin shuffle


2024-09-05 08:03:48,331 - INFO -         Start Nanny at: 'tcp://127.0.0.1:60220'


2024-09-05 08:03:51,000 - INFO - Starting extract_files_from_adls function


2024-09-05 08:03:51,003 - INFO - Request URL: 'https://nycpayrollstorageaccount.blob.core.windows.net/nycpayrollcontainer?restype=REDACTED&comp=REDACTED&prefix=REDACTED'
Request method: 'GET'
Request headers:
    'x-ms-version': 'REDACTED'
    'Accept': 'application/xml'
    'User-Agent': 'azsdk-python-storage-blob/12.22.0 Python/3.12.4 (Windows-11-10.0.22631-SP0)'
    'x-ms-date': 'REDACTED'
    'x-ms-client-request-id': '014d6d24-6b55-11ef-a399-f4a4751e46e5'
    'Authorization': 'REDACTED'
No body was attached to the request


2024-09-05 08:03:52,219 - INFO - Response status: 200
Response headers:
    'Transfer-Encoding': 'chunked'
    'Content-Type': 'application/xml'
    'Server': 'Windows-Azure-Blob/1.0 Microsoft-HTTPAPI/2.0'
    'x-ms-request-id': 'd58c5c39-201e-002c-0961-ff2430000000'
    'x-ms-client-request-id': '014d6d24-6b55-11ef-a399-f4a4751e46e5'
    'x-ms-version': 'REDACTED'
    'Date': 'Thu, 05 Sep 2024 07:03:52 GMT'


2024-09-05 08:03:52,227 - INFO - Starting data transformation!!


2024-09-05 08:03:52,993 - INFO - dim_date data generated and saved!!


2024-09-05 08:03:53,046 - INFO - Transformed data saved to Dataset/Cleaned_payroll_Data/nycpayroll_2020.csv


2024-09-05 08:03:53,162 - INFO -       Start worker at:      tcp://127.0.0.1:60227


2024-09-05 08:03:53,162 - INFO -          Listening to:      tcp://127.0.0.1:60227


2024-09-05 08:03:53,163 - INFO -           Worker name:                          0


2024-09-05 08:03:53,163 - INFO -          dashboard at:            127.0.0.1:60228


2024-09-05 08:03:53,164 - INFO - Waiting to connect to:      tcp://127.0.0.1:60217


2024-09-05 08:03:53,164 - INFO - -------------------------------------------------


2024-09-05 08:03:53,166 - INFO -               Threads:                          4


2024-09-05 08:03:53,166 - INFO -                Memory:                  19.84 GiB


2024-09-05 08:03:53,167 - INFO -       Local Directory: C:\Users\oluwa\AppData\Local\Temp\dask-scratch-space\worker-gytwvkc3


2024-09-05 08:03:53,167 - INFO - -------------------------------------------------


2024-09-05 08:03:53,172 - INFO - Register worker <WorkerState 'tcp://127.0.0.1:60227', name: 0, status: init, memory: 0, processing: 0>


2024-09-05 08:03:53,174 - INFO - Starting worker compute stream, tcp://127.0.0.1:60227


2024-09-05 08:03:53,175 - INFO - Starting established connection to tcp://127.0.0.1:60229


2024-09-05 08:03:53,177 - INFO -         Registered to:      tcp://127.0.0.1:60217


2024-09-05 08:03:53,177 - INFO - -------------------------------------------------


2024-09-05 08:03:53,179 - INFO - Starting established connection to tcp://127.0.0.1:60217


2024-09-05 08:03:53,217 - INFO - Receive client connection: Client-ff5b2d2f-6b54-11ef-aa24-f4a4751e46e5


2024-09-05 08:03:53,218 - INFO - Starting established connection to tcp://127.0.0.1:60230


2024-09-05 08:03:53,221 - INFO - Dask client initialized with 1 worker.


2024-09-05 08:03:53,241 - INFO - Connected to Snowflake successfully.


2024-09-05 08:03:53,244 - INFO - Transformed NycPayroll CSV file loaded successfully.


2024-09-05 08:03:53,245 - INFO - Snowflake Connector for Python Version: 3.12.1, Python Version: 3.12.4, Platform: Windows-11-10.0.22631-SP0


2024-09-05 08:03:53,246 - INFO - Connecting to GLOBAL Snowflake domain


2024-09-05 08:03:53,246 - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.


2024-09-05 08:03:55,432 - INFO - Number of results in first chunk: 1


2024-09-05 08:03:55,764 - INFO - Number of results in first chunk: 1


2024-09-05 08:03:56,091 - INFO - Number of results in first chunk: 1


2024-09-05 08:03:56,092 - INFO - Table "Dim_Employee" created or already exists.


2024-09-05 08:03:56,415 - INFO - Number of results in first chunk: 1


2024-09-05 08:03:56,418 - INFO - Table "Dim_Agency" created or already exists.


2024-09-05 08:03:56,747 - INFO - Number of results in first chunk: 1


2024-09-05 08:03:56,748 - INFO - Table "Dim_PayBasis" created or already exists.


2024-09-05 08:03:57,158 - INFO - Number of results in first chunk: 1


2024-09-05 08:03:57,160 - INFO - Table "Dim_Date" created or already exists.


2024-09-05 08:03:57,591 - INFO - Number of results in first chunk: 1


2024-09-05 08:03:57,593 - INFO - Table "FactPayroll" created or already exists.


2024-09-05 08:03:58,030 - INFO - Number of results in first chunk: 1


2024-09-05 08:03:58,031 - INFO - Truncated "Dim_Employee" successfully.


2024-09-05 08:03:58,691 - INFO - Number of results in first chunk: 1


2024-09-05 08:03:58,694 - INFO - Truncated "Dim_Agency" successfully.


2024-09-05 08:03:59,687 - INFO - Number of results in first chunk: 1


2024-09-05 08:03:59,688 - INFO - Truncated "Dim_PayBasis" successfully.


2024-09-05 08:04:00,137 - INFO - Number of results in first chunk: 1


2024-09-05 08:04:00,137 - INFO - Truncated "Dim_Date" successfully.


2024-09-05 08:04:00,697 - INFO - Number of results in first chunk: 1


2024-09-05 08:04:00,699 - INFO - Truncated "FactPayroll" successfully.


2024-09-05 08:04:01,145 - INFO - Number of results in first chunk: 8


2024-09-05 08:04:01,612 - INFO - Number of results in first chunk: 8


2024-09-05 08:04:02,908 - INFO - Number of results in first chunk: 6


2024-09-05 08:04:04,498 - INFO - Number of results in first chunk: 0


2024-09-05 08:04:04,826 - INFO - Number of results in first chunk: 1


2024-09-05 08:04:05,733 - INFO - Number of results in first chunk: 0


2024-09-05 08:04:07,639 - INFO - Number of results in first chunk: 34


2024-09-05 08:04:08,073 - INFO - Number of results in first chunk: 0


2024-09-05 08:04:08,442 - INFO - Number of results in first chunk: 0


2024-09-05 08:04:08,744 - INFO - Number of results in first chunk: 1


2024-09-05 08:04:09,375 - INFO - Number of results in first chunk: 1


2024-09-05 08:04:09,759 - INFO - Number of results in first chunk: 1


2024-09-05 08:04:11,604 - INFO - Number of results in first chunk: 6


2024-09-05 08:04:11,605 - INFO - Dim_Employee data loaded successfully!!


2024-09-05 08:04:12,487 - INFO - Number of results in first chunk: 2


2024-09-05 08:04:12,806 - INFO - Number of results in first chunk: 2


2024-09-05 08:04:13,306 - INFO - Number of results in first chunk: 6


2024-09-05 08:04:14,009 - INFO - Number of results in first chunk: 0


2024-09-05 08:04:15,426 - INFO - Number of results in first chunk: 1


2024-09-05 08:04:15,854 - INFO - Number of results in first chunk: 0


2024-09-05 08:04:17,677 - INFO - Number of results in first chunk: 34


2024-09-05 08:04:17,975 - INFO - Number of results in first chunk: 0


2024-09-05 08:04:18,322 - INFO - Number of results in first chunk: 0


2024-09-05 08:04:18,657 - INFO - Number of results in first chunk: 1


2024-09-05 08:04:19,147 - INFO - Number of results in first chunk: 1


2024-09-05 08:04:19,507 - INFO - Number of results in first chunk: 1


2024-09-05 08:04:20,750 - INFO - Number of results in first chunk: 6


2024-09-05 08:04:20,751 - INFO - Dim_Agency data loaded successfully!!


2024-09-05 08:04:21,070 - INFO - Number of results in first chunk: 2


2024-09-05 08:04:21,376 - INFO - Number of results in first chunk: 2


2024-09-05 08:04:21,734 - INFO - Number of results in first chunk: 6


2024-09-05 08:04:22,092 - INFO - Number of results in first chunk: 0


2024-09-05 08:04:22,684 - INFO - Number of results in first chunk: 1


2024-09-05 08:04:23,425 - INFO - Number of results in first chunk: 0


2024-09-05 08:04:25,430 - INFO - Number of results in first chunk: 34


2024-09-05 08:04:25,796 - INFO - Number of results in first chunk: 0


2024-09-05 08:04:26,144 - INFO - Number of results in first chunk: 0


2024-09-05 08:04:26,483 - INFO - Number of results in first chunk: 1


2024-09-05 08:04:27,307 - INFO - Number of results in first chunk: 1


2024-09-05 08:04:27,751 - INFO - Number of results in first chunk: 1


2024-09-05 08:04:29,679 - INFO - Number of results in first chunk: 6


2024-09-05 08:04:29,682 - INFO - Dim_PayBasis data loaded successfully!!


2024-09-05 08:04:30,208 - INFO - Number of results in first chunk: 6


2024-09-05 08:04:30,516 - INFO - Number of results in first chunk: 6


2024-09-05 08:04:30,845 - INFO - Number of results in first chunk: 6


2024-09-05 08:04:31,168 - INFO - Number of results in first chunk: 0


2024-09-05 08:04:31,507 - INFO - Number of results in first chunk: 1


2024-09-05 08:04:31,848 - INFO - Number of results in first chunk: 0


2024-09-05 08:04:33,035 - INFO - Number of results in first chunk: 34


2024-09-05 08:04:33,376 - INFO - Number of results in first chunk: 0


2024-09-05 08:04:34,379 - INFO - Number of results in first chunk: 0


2024-09-05 08:04:34,980 - INFO - Number of results in first chunk: 1


2024-09-05 08:04:35,504 - INFO - Number of results in first chunk: 1


2024-09-05 08:04:36,293 - INFO - Number of results in first chunk: 1


2024-09-05 08:04:37,648 - INFO - Number of results in first chunk: 6


2024-09-05 08:04:37,654 - INFO - Dim_Date data loaded successfully.


2024-09-05 08:04:38,039 - INFO - Number of results in first chunk: 13


2024-09-05 08:04:38,404 - INFO - Number of results in first chunk: 13


2024-09-05 08:04:38,759 - INFO - Number of results in first chunk: 6


2024-09-05 08:04:39,061 - INFO - Number of results in first chunk: 0


2024-09-05 08:04:39,379 - INFO - Number of results in first chunk: 1


2024-09-05 08:04:39,718 - INFO - Number of results in first chunk: 0


2024-09-05 08:04:40,763 - INFO - Number of results in first chunk: 34


2024-09-05 08:04:41,207 - INFO - Number of results in first chunk: 0


2024-09-05 08:04:42,085 - INFO - Number of results in first chunk: 0


2024-09-05 08:04:42,408 - INFO - Number of results in first chunk: 1


2024-09-05 08:04:42,920 - INFO - Number of results in first chunk: 1


2024-09-05 08:04:43,458 - INFO - Number of results in first chunk: 1


2024-09-05 08:04:44,384 - INFO - Number of results in first chunk: 6


2024-09-05 08:04:44,386 - INFO - FactPayroll data loaded successfully!!


2024-09-05 08:04:44,969 - INFO - Number of results in first chunk: 1


2024-09-05 08:04:44,970 - INFO - All data loaded successfully!!


2024-09-05 08:04:45,305 - INFO - Number of results in first chunk: 1


2024-09-05 08:04:45,307 - INFO - Remove client Client-ff5b2d2f-6b54-11ef-aa24-f4a4751e46e5


2024-09-05 08:04:45,308 - INFO - Received 'close-stream' from tcp://127.0.0.1:60230; closing.


2024-09-05 08:04:45,308 - INFO - Remove client Client-ff5b2d2f-6b54-11ef-aa24-f4a4751e46e5


2024-09-05 08:04:45,309 - INFO - Close client connection: Client-ff5b2d2f-6b54-11ef-aa24-f4a4751e46e5


2024-09-05 08:04:45,310 - INFO - Retire worker addresses (0,)


2024-09-05 08:04:45,311 - INFO - Closing Nanny at 'tcp://127.0.0.1:60220'. Reason: nanny-close


2024-09-05 08:04:45,313 - INFO - Nanny asking worker to close. Reason: nanny-close


2024-09-05 08:04:45,315 - INFO - Stopping worker at tcp://127.0.0.1:60227. Reason: nanny-close


2024-09-05 08:04:45,316 - INFO - Removing Worker plugin shuffle


2024-09-05 08:04:45,320 - INFO - Received 'close-stream' from tcp://127.0.0.1:60229; closing.


2024-09-05 08:04:45,320 - INFO - Connection to tcp://127.0.0.1:60217 has been closed.


2024-09-05 08:04:45,320 - INFO - Remove worker <WorkerState 'tcp://127.0.0.1:60227', name: 0, status: closing, memory: 0, processing: 0> (stimulus_id='handle-worker-cleanup-1725519885.321426')


2024-09-05 08:04:45,322 - INFO - Lost all workers


2024-09-05 08:04:45,657 - INFO - Closing scheduler. Reason: unknown


2024-09-05 08:04:45,658 - INFO - Scheduler closing all comms


2024-09-05 08:04:45,661 - INFO - Dask client closed.


2024-09-05 08:04:45,662 - INFO - ETL Step 3: Data loading completed.


2024-09-05 08:04:45,663 - INFO - Connected to Snowflake successfully.


2024-09-05 08:04:45,664 - INFO - Snowflake Connector for Python Version: 3.12.1, Python Version: 3.12.4, Platform: Windows-11-10.0.22631-SP0


2024-09-05 08:04:45,665 - INFO - Connecting to GLOBAL Snowflake domain


2024-09-05 08:04:45,668 - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.


2024-09-05 08:04:49,200 - INFO - Number of results in first chunk: 1


2024-09-05 08:04:49,740 - INFO - Number of results in first chunk: 1


2024-09-05 08:04:53,663 - INFO - Number of results in first chunk: 1


2024-09-05 08:04:53,666 - ERROR - ETL pipeline failed: (snowflake.connector.errors.ProgrammingError) 090232 (25000): 01b6d288-0000-6bf3-0022-af03000361f6: Stored procedure execution error: Scoped transaction started in stored procedure is incomplete and it was rolled back.
[SQL: CALL "STG".PAYROLL_AGGREGATES();]
(Background on this error at: https://sqlalche.me/e/20/f405)


2024-09-05 08:04:53,707 - INFO - closed


2024-09-05 08:04:53,707 - INFO - No async queries seem to be running, deleting session


2024-09-05 08:04:54,011 - INFO - closed


2024-09-05 08:04:54,013 - INFO - No async queries seem to be running, deleting session


